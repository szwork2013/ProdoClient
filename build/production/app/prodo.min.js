angular.module("prodo.CommonApp",[]),angular.module("prodo.UserApp",[]),angular.module("prodo.ProdoWallApp",[]),angular.module("prodo.OrgApp",[]),angular.module("prodo.ProductApp",[]),angular.module("prodo.ProdoCommentApp",[]),angular.module("prodo.WarrantyApp",[]),angular.module("prodo.DashboardApp",[]),angular.module("prodo.ContentApp",[]),angular.module("prodo.BlogApp",[]),angular.module("prodo.AdApp",[]),angular.module("prodo.AdminApp",[]),angular.module("prodo.SubscriptionApp",[]),angular.module("prodo.UploadApp",[]),angular.module("prodo.CampaignApp",[]),angular.module("prodo.ProdoHomeApp",[]),angular.module("prodo.ProdonusApp",["ui.router","ui.bootstrap","ngAnimate","$strap.directives","vcRecaptcha","ngResource","tags-input","ngCookies","angular-growl","prodo.CommonApp","prodo.UserApp","prodo.ProdoWallApp","prodo.OrgApp","prodo.ProductApp","prodo.ProdoCommentApp","prodo.WarrantyApp","prodo.DashboardApp","prodo.ContentApp","prodo.BlogApp","prodo.AdApp","prodo.AdminApp","prodo.SubscriptionApp","prodo.UploadApp","prodo.CampaignApp","prodo.ProdoHomeApp","configSocket"]).config(["$logProvider","growlProvider","$httpProvider",function(a,b){a.debugEnabled(!0),b.globalTimeToLive(5e3),b.onlyUniqueMessages(!0),b.messagesKey("errors"),b.messageTextKey("message"),b.messageSeverityKey("field")}]).run(["$rootScope","UserSessionService","OrgRegistrationService","$log","growl",function(a,b,c,d){b.checkUser(),a.usersession=b,a.organizationData=c,a.$log=d,a.$on("$stateChangeSuccess",function(b,c,d,e){a.previousState=e.name,a.currentState=c.name;var f=new RegExp("prodo.productwall"),g=f.test(a.currentState);"prodo.home.wall"==a.currentState?(a.home=1,a.wall=0):g?(a.wall=1,a.home=0):(a.wall=0,a.home=0)})}]).controller("ProdoMainController",["$scope","$rootScope","$state","$log","$location","growl","$timeout","UserSessionService","OrgRegistrationService","notify",function(a,b,c,d,e,f,g,h,i,j){c.transitionTo("prodo.landing.signup"),a.prodlesfollowed=[{}],a.showSignin=function(){c.transitionTo("prodo.landing.signin")},a.showSignup=function(){c.transitionTo("prodo.landing.signup")},b.goState=function(){c.transitionTo(b.previousState)},b.ProdoAppMessage=function(a,b){"success"===b?j({message:a,template:"common/notification/views/prodo-notify-success.html",position:"center"}):"error"===b&&j({message:a,template:"common/notification/views/prodo-notify-error.html",position:"center"})};var k=a.$on("session-changed-failure",function(a,d){h.authfailed(),c.transitionTo("prodo.landing.signup"),b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")}),l=a.$on("session",function(e,f){if(b.usersession.isLoggedIn){var g=moment.utc(moment(f.subscription.planexpirydate)),i=moment.utc(moment());if(b.daysRemaining=g.diff(i,"days"),"business"==f.prodousertype&&void 0==f.org)c.transitionTo("prodo.orgregistration.company");else if(("business"==f.prodousertype||"individual"==f.prodousertype)&&f.hasDonePayment){if(null==f.products_followed||void 0==f.products_followed)d.debug("There is some problem with the database. Please contact support.");else if(f.products_followed.length>0){var j=f.products_followed.length-1;b.orgid=f.products_followed[j].orgid,b.product_prodle=f.products_followed[j].prodle;for(var k=0;k<f.products_followed.length;k++){if(f.products_followed[k]&&f.products_followed[k].prodle)var l=f.products_followed[k].prodle;a.prodlesfollowed.push(l)}h.getProductFollowed(a.prodlesfollowed,f)}if(1==f.isOtpPassword)c.transitionTo("prodo.landing.resetpassword");else if(f.org&&"Manufacturer"==f.org.orgtype)b.orgid=f.org.orgid,d.debug("manufacturer_"+b.orgid),c.transitionTo("prodo.home.wall");else if(f.products_followed.length>0){var j=f.products_followed.length-1;b.orgid=f.products_followed[j].orgid,d.debug("others_"+b.orgid),c.transitionTo("prodo.home.wall")}}}});a.logout=function(){h.logoutUser()};var m=a.$on("logoutDone",function(){d.debug(b.usersession.isLoggedIn),c.transitionTo("prodo.landing.signup"),b.ProdoAppMessage("You are successfully signed out.","success")}),n=a.$on("logoutNotDone",function(a,c){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c,"error")});a.$on("$destroy",function(){k(),l(),cleanupEventGetProductFollowedDone(),m(),n()})}]),angular.module("prodo.UserApp").controller("UserRegistrationController",["$scope","$rootScope","$state","$http","$timeout","$sce","$log","growl","UserSessionService","UserSignupService","vcRecaptchaService","UserRecaptchaService",function(a,b,c,d,e,f,g,h,i,j,k,l){a.submitted=!1,a.user={username:"",email:"",password:"",terms:!0,type:"business"},a.activateaccount={email:""},a.clearformData=function(){a.signupForm.$setPristine(),a.user.username="",a.user.email="",a.user.password=""},$("#recaptcha_reload_button").on("click",function(){$(this).find(":selected").data("placeholder");$("#recaptcha_response_field").attr("placeholder","Enter what you see")}),$("#recaptcha_audio_button").on("click",function(){$(this).find(":selected").data("placeholder");$("#recaptcha_response_field").attr("placeholder","Enter what you hear")}),a.jsonUserData=function(){var b={user:{username:a.user.username,email:a.user.email,password:a.user.password,terms:a.user.terms,prodousertype:a.user.type}};return JSON.stringify(b)},a.handleSignupResponse=function(d){d.success?(c.transitionTo("prodo.user-content.emailverification"),a.clearformData()):"AU001"==d.error.code?(g.debug(d.error.code+" "+d.error.message),b.ProdoAppMessage(d.error.message,"error")):"ACT001"==d.error.code?(g.debug(d.error.code+" "+d.error.message),c.transitionTo("prodo.user-content.reactivate")):"AV001"==d.error.code?(g.debug(d.error.code+" "+d.error.message),b.ProdoAppMessage(d.error.message,"error")):"AT001"==d.error.code?(g.debug(d.error.code+" "+d.error.message),c.transitionTo("user-content.resetGenerateToken")):(g.debug(d.error.message),b.ProdoAppMessage("Prodonus Database Server error. Please wait for some time.","error")),a.hideSpinner()},a.signup=function(){if(a.signupForm.$valid){a.showSpinner(),a.signupForm.submitted=!1;{a.jsonUserData()}g.debug("User Data entered successfully"),l.validate(a)}else a.signupForm.submitted=!0};var m=a.$on("recaptchaNotDone",function(){a.hideSpinner(),b.ProdoAppMessage("Recaptcha failed, please try again","error")}),n=a.$on("recaptchaFailure",function(c,d){a.hideSpinner(),b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")}),o=a.$on("recaptchaDone",function(){i.signupUser(a.jsonUserData())}),p=a.$on("signupDone",function(b,c){g.debug(c),a.handleSignupResponse(c)}),q=a.$on("signupNotDone",function(c,d){a.hideSpinner(),g.debug(d),b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.jsonRegenerateTokenData=function(){var b={email:a.user.email};return JSON.stringify(b)},a.handleRegenerateTokenResponse=function(d){d.success?(c.transitionTo("prodo.user-content.regeneratetoken"),a.clearformData()):"AU004"==d.error.code?(g.debug(d.error.code+" "+d.error.message),b.ProdoAppMessage(d.error.message,"error")):(g.debug(d.error.message),b.ProdoAppMessage(d.error.message,"error"))},a.regeneratetoken=function(){a.showSpinner(),i.regenerateTokenUser(a.jsonRegenerateTokenData())};var r=a.$on("regenerateTokenDone",function(b,c){a.clearformData(),a.handleRegenerateTokenResponse(c),a.hideSpinner()}),s=a.$on("regenerateTokenNotDone",function(c,d){a.clearformData(),a.hideSpinner(),b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.jsonActivateAccountTokenData=function(){var b={email:a.activateaccount.email};return JSON.stringify(b)},a.handleActivateAccountTokenResponse=function(a){a.success?c.transitionTo("prodo.user-content.activaterequest"):"AU004"==a.error.code?(g.debug(a.error.code+" "+a.error.message),b.ProdoAppMessage(a.error.message,"error")):(g.debug(a.error.message),b.ProdoAppMessage(a.error.message,"error"))},a.activate_account_request=function(){a.activateaccountForm.$valid?i.activateaccount(a.jsonActivateAccountTokenData()):a.activateaccountForm.submitted=!0};var t=a.$on("activateAccountTokenDone",function(b,c){a.clearformData(),a.handleActivateAccountTokenResponse(c),a.hideSpinner()}),u=a.$on("activateAccountTokenNotDone",function(c,d){a.clearformData(),a.hideSpinner(),b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.$on("$destroy",function(){m(),n(),o(),p(),q(),r(),s(),u(),t()})}]),angular.module("prodo.UserApp").controller("UserAccountController",["$scope","$rootScope","$state","$http","$timeout","$log","growl","UserSessionService","OrgRegistrationService","userdata","checkIfSessionExist","$stateParams",function(a,b,c,d,e,f,g,h,i,j,k,l){a.user={},a.form={},a.products_followed=[],a.submitted=!1,a.$state=c,a.editEmail=!1,a.hasAddress=!1,a.hasPersonalDetail=!1,a.editAddress=!1,a.isInvites=!1,a.isUnfollowed=!1,a.editorEnabled=!1,a.countries=["Afghanistan","Albania","Algeria","American Samoa","Andorra","Angola","Anguilla","Antigua and Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia","Bosnia-Herzegovina","Botswana","Bouvet Island","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Cayman Islands","Central African Republic","Chad","Chile","China","Christmas Island","Cocos (Keeling) Islands","Colombia","Comoros","Congo, Democratic Republic of the (Zaire)","Congo, Republic of","Cook Islands","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Falkland Islands","Faroe Islands","Fiji","Finland","France","French Guiana","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guadeloupe (French)","Guam (USA)","Guatemala","Guinea","Guinea Bissau","Guyana","Haiti","Holy See","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Ivory Coast (Cote D`Ivoire)","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macau","Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Martinique (French)","Mauritania","Mauritius","Mayotte","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","Netherlands Antilles","New Caledonia (French)","New Zealand","Nicaragua","Niger","Nigeria","Niue","Norfolk Island","North Korea","Northern Mariana Islands","Norway","Oman","Pakistan","Palau","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Pitcairn Island","Poland","Polynesia (French)","Portugal","Puerto Rico","Qatar","Reunion","Romania","Russia","Rwanda","Saint Helena","Saint Kitts and Nevis","Saint Lucia","Saint Pierre and Miquelon","Saint Vincent and Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Georgia and South Sandwich Islands","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Svalbard and Jan Mayen Islands","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste (East Timor)","Togo","Tokelau","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Turks and Caicos Islands","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Virgin Islands","Wallis and Futuna Islands","Yemen","Zambia","Zimbabwe"],a.states={},a.states.india=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar ","Chhattisgarh ","Goa","Gujarat","Haryana","Himachal Pradesh","Jammu and Kashmir","Jharkhand","Kerala ","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Orissa ","Punjab","Rajasthan","Sikkim","Tamil Nadu","Tripura","Uttar Pradesh","Uttarakhand","West Bengal"],a.india={},a.india.major_cities=["Port Blair","Hyderabad","Itanagar","Dispur","Patna","Silvassa","Daman","Delhi","Gandhinagar","Chandigarh","Ranchi","Bengaluru","Thiruvananthapuram","Kavaratti","Bhopal","Imphal","Shillong","Aizwal","Kohima","Bhubaneshwar","Puducherry","Chandigarh","Jaipur","Agartala","Mumbai","Lucknow","Kolkata","Panaji","Pune"],a.selected_country="",a.return_states=function(){return"India"===a.user.address.country?a.states.india:""},a.return_cities=function(){return"India"===a.user.address.country?a.india.major_cities:""},a.$watch("$state.$current.locals.globals.checkIfSessionExist",function(a){a.error&&b.showModal()}),k.success&&j.success&&a.$watch("$state.$current.locals.globals.userdata",function(c){if(c.success){if(a.user=c.success.user,b.usersession.currentUser=c.success.user,null!=c.success.user.firstname&&(a.hasPersonalDetail=!0),null!=c.success.user.address.address1&&(a.hasAddress=!0),null!=c.success.user.dob){var d=new Date(c.success.user.dob),e=d.getFullYear(),g=d.getMonth()+1;10>g&&(g="0"+g);var i=d.getDate();a.user.dob=e+"-"+g+"-"+i}h.updateUserData(c.success.user)}else c.error&&"AL001"==c.error.code?b.showModal():f.debug(c.error.message)}),0!==h.productfollowlist.length?a.products_followed=h.productfollowlist:f.debug("no products followed");var m=a.$on("userUploadResponseSuccess",function(a,d){void 0!==d.error&&"AL001"===d.error.code?b.showModal():(f.debug("Listenig "),c.reload())});a.emailEditor=function(){a.editEmail?(a.form.usergeneralsettingform.submitted=!1,a.form.usergeneralsettingform.$setPristine(),a.editEmail=!1):a.editEmail=!0},a.jsonUpdateEmailData=function(){var b={user:{email:a.user.email,currentpassword:a.user.password}};return JSON.stringify(b)},a.handleUpdateUserEmailResponse=function(d){d.success?(a.emailEditor(),c.transitionTo(c.current,l,{reload:!0,inherit:!1,notify:!0}),b.ProdoAppMessage(d.success.message,"success")):"AL001"==d.error.code?(f.debug(d.error.code+" "+d.error.message),b.showModal()):(f.debug(d.error.message),b.ProdoAppMessage(d.error.message,"error"))},a.updateUserEmail=function(){a.form.usergeneralsettingform.$valid?h.updateEmail(a.jsonUpdateEmailData()):a.form.usergeneralsettingform.submitted=!0};var n=a.$on("updateUserEmailDone",function(b,c){a.handleUpdateUserEmailResponse(c)}),o=a.$on("updateUserEmailNotDone",function(a,c){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c,"error")});a.clear=function(){a.form.userpasswordsettingform.$setPristine(),a.form.userpasswordsettingform.submitted=!1,a.user.currentpassword="",a.user.newpassword="",a.user.confirmpassword=""},a.jsonUpdatePasswordData=function(){var b={user:{currentpassword:a.user.currentpassword,newpassword:a.user.newpassword,confirmnewpassword:a.user.confirmpassword}};return JSON.stringify(b)},a.handleUpdateUserPasswordResponse=function(d){d.success?(a.clear(),c.transitionTo(c.current,l,{reload:!0,inherit:!1,notify:!0}),b.ProdoAppMessage(d.success.message,"success")):"AL001"==d.error.code?(f.debug(d.error.code+" "+d.error.message),b.showModal()):(f.debug(d.error.message),b.ProdoAppMessage(d.error.message,"error"))},a.changePassword=function(){a.form.userpasswordsettingform.$valid?h.updatePassword(a.jsonUpdatePasswordData()):a.form.userpasswordsettingform.submitted=!0};var p=a.$on("updateUserPasswordDone",function(b,c){a.handleUpdateUserPasswordResponse(c)}),q=a.$on("updateUserPasswordNotDone",function(a,c){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c,"error")});a.disableEditor=function(){a.form.userpersonalsettingform.submitted=!1,a.form.userpersonalsettingform.$setPristine(),a.editorEnabled=!1},a.enableEditor=function(){a.editorEnabled=!0},a.jsonUserAccountData=function(){var b={user:{firstname:a.user.firstname,lastname:a.user.lastname,dob:a.user.dob,gender:a.user.gender,phone:a.user.phone,mobile:a.user.mobile}};return JSON.stringify(b)},a.handleUpdateUserResponse=function(a){a.success?(c.transitionTo(c.current,l,{reload:!0,inherit:!1,notify:!0}),b.ProdoAppMessage(a.success.message,"success")):"AL001"==a.error.code?(f.debug(a.error.code+" "+a.error.message),b.showModal()):(f.debug(a.error.message),b.ProdoAppMessage(a.error.message,"error"))},a.updateUserAccount=function(){a.form.userpersonalsettingform.$valid?(a.disableEditor(),h.saveUserSettings(a.jsonUserAccountData())):a.form.userpersonalsettingform.submitted=!0};var r=a.$on("updateUserDone",function(b,c){a.handleUpdateUserResponse(c)}),s=a.$on("updateUserNotDone",function(a,c){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c,"error")});a.addrEditor=function(){a.form.userlocationsettingform.submitted=!1,a.form.userlocationsettingform.$setPristine(),a.editAddress=a.editAddress?!1:!0},a.jsonUserAddressData=function(){var b={user:{address:{address1:a.user.address.address1,address2:a.user.address.address2,address3:a.user.address.address3,city:a.user.address.city,state:a.user.address.state,country:a.user.address.country,zipcode:a.user.address.zipcode}}};return JSON.stringify(b)},a.updateUserAddress=function(){a.form.userlocationsettingform.$valid?(a.addrEditor(),h.saveUserSettings(a.jsonUserAddressData())):a.form.userlocationsettingform.submitted=!0},a.userinvites=[{name:"",email:""}],a.addUserInvites=function(){a.form.userinvitesform.$valid?(a.invitesettingchange="",a.userinvites.push({name:"",email:""})):a.invitesettingchange="New fields will only visible once you enter data here."},a.clearInvites=function(){a.form.userinvitesform.submitted=!1,a.invitesettingchange="",a.form.userinvitesform.$setPristine(),a.userinvites=[{name:"",email:""}]},a.removeInvites=function(b){for(var c=a.userinvites,d=0,e=c.length;e>d;d++)b===c[d]?c.splice(d,1):c.splice(d,0)},a.jsonUserInvitesData=function(){var b={userinvites:a.userinvites};return JSON.stringify(b)},a.handleUserInviteResponse=function(c){c.success?(a.clearInvites(),b.ProdoAppMessage("Your invites has been successfully sent.","success")):"AL001"==c.error.code?(f.debug(c.error.code+" "+c.error.message),b.showModal()):(f.debug(c.error.message),b.ProdoAppMessage(c.error.message,"error"))},a.sendUserInvites=function(){a.form.userinvitesform.$valid?h.sendInvites(a.jsonUserInvitesData()):a.form.userinvitesform.submitted=!0};var t=a.$on("sendUserInvitesDone",function(b,c){a.handleUserInviteResponse(c)}),u=a.$on("sendUserInvitesNotDone",function(a,c){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c,"error")});a.handleUnfollowProductResponse=function(a,d){if(a.success){c.reload();for(var e=h.productfollowlist,g=0,i=e.length;i>g;g++)d===e[g]&&e.splice(g,1);b.ProdoAppMessage("You have left your product conversation for "+d.name,"success")}else"AL001"==a.error.code?(f.debug(a.error.code+" "+a.error.message),b.showModal()):(f.debug(a.error.message),b.ProdoAppMessage(a.error.message,"error"))},a.unfollow=function(a){h.unfollowProduct(a.prodle,a)};var v=a.$on("unfollowProductDone",function(b,c,d){a.handleUnfollowProductResponse(c,d)}),w=a.$on("unfollowProductNotDone",function(a,c){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c,"error")});a.handleDeleteUserResponse=function(a){a.success?(h.logoutUser(),b.ProdoAppMessage(a.success.message,"success")):"AL001"==a.error.code?(f.debug(a.error.code+" "+a.error.message),b.showModal()):(f.debug(a.error.message),b.ProdoAppMessage(a.error.message,"error"))};var x=a.$on("logoutDone",function(a,d){c.transitionTo("prodo.landing.signin"),b.ProdoAppMessage(d,"success")});a.deleteUserAccount=function(){h.removeUserSettings()};var y=a.$on("deleteUserDone",function(b,c){a.handleDeleteUserResponse(c)}),z=a.$on("deleteUserNotDone",function(a,c){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c,"error")});a.$on("$destroy",function(){n(),o(),p(),q(),r(),s(),y(),z(),x(),t(),u(),v(),w(),m()})}]),angular.module("prodo.UserApp").controller("UserSigninController",["$scope","$rootScope","$state","$timeout","$stateParams","$log","growl","UserSessionService","OrgRegistrationService",function(a,b,c,d,e,f,g,h){a.submitted=!1,a.user={email:"",password:"",newpassword:"",confirmpassword:"",currentpassword:""},a.clearformData=function(){a.user.email="",a.user.password="",a.user.newpassword="",a.user.confirmnewpassword="",a.user.currentpassword=""},a.jsonUserSigninData=function(){var b={email:a.user.email,password:a.user.password};return JSON.stringify(b)},a.handleSigninResponse=function(c){c.success?(h.authSuccess(c.success.user),a.signinForm.$setPristine(),a.clearformData()):void 0==c.error.user?(f.debug(c.error.code+" "+c.error.message),b.ProdoAppMessage(c.error.message,"error")):c.error.user&&("AW001"==c.error.code?(f.debug(c.error.code+" "+c.error.message),h.authSuccess(c.error.user),b.ProdoAppMessage(c.error.message,"error")):(f.debug(c.error.code+" "+c.error.message),h.authSuccess(c.error.user),b.ProdoAppMessage(c.error.message,"error"))),a.hideSpinner()},a.signin=function(){a.signinForm.$valid?(a.showSpinner(),a.signinForm.submitted=!1,f.debug("User Data entered successfully"),h.signinUser(a.jsonUserSigninData())):a.signinForm.submitted=!0};var i=a.$on("signinDone",function(b,c){a.handleSigninResponse(c)}),j=a.$on("signinNotDone",function(c,d){a.signinForm.$setPristine(),a.clearformData(),a.hideSpinner(),b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.jsonForgotPasswordData=function(){var b={user:{email:a.user.email}};return JSON.stringify(b)},a.handleForgotPasswordResponse=function(c){c.success?(b.ProdoAppMessage("Your temporary password settings has been sent. Please check your email, and follow instructions.","info"),a.clearformData()):"AV001"==c.error.code?(f.debug(c.error.code+" "+c.error.message),b.ProdoAppMessage(c.error.message,"error")):"AV004"==c.error.code?(f.debug(c.error.code+" "+c.error.message),b.ProdoAppMessage(c.error.message,"error")):"AT001"==c.error.code?(f.debug(c.error.code+" "+c.error.message),b.ProdoAppMessage(c.error.message,"error")):(f.debug(c.error.message),b.ProdoAppMessage(c.error.message,"error")),a.hideSpinner()},a.forgotpassword=function(){a.showSpinner(),h.forgotPasswordUser(a.jsonForgotPasswordData())};var k=a.$on("forgotPasswordDone",function(b,c){a.handleForgotPasswordResponse(c)}),l=a.$on("forgotPasswordNotDone",function(c,d){a.hideSpinner(),b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.jsonResetPasswordData=function(){var b={user:{currentpassword:a.user.currentpassword,newpassword:a.user.newpassword,confirmnewpassword:a.user.confirmnewpassword}};return JSON.stringify(b)},a.handleResetPasswordResponse=function(d){d.success?(b.usersession.currentUser.hasDonePayment&&b.usersession.currentUser.org&&"Manufacturer"==b.usersession.currentUser.org.orgtype?(b.orgid=b.usersession.currentUser.org.orgid,c.transitionTo("prodo.productwall.wall-org")):b.usersession.currentUser.hasDonePayment&&c.transitionTo("prodo.productwall.wall-org"),a.resetPasswordForm.$setPristine(),a.clearformData()):"AL001"==d.error.code?(f.debug(d.error.code+" "+d.error.message),b.showModal()):(f.debug(d.error.message),b.ProdoAppMessage(d.error.message,"error")),a.hideSpinner()},a.resetpassword=function(){a.resetPasswordForm.$valid?(a.showSpinner(),a.resetPasswordForm.submitted=!1,h.resetPasswordUser(a.jsonResetPasswordData())):a.resetPasswordForm.submitted=!0};var m=a.$on("resetPasswordDone",function(b,c){a.handleResetPasswordResponse(c)}),n=a.$on("resetPasswordNotDone",function(c,d){a.resetPasswordForm.$setPristine(),a.clearformData(),a.hideSpinner(),b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.$on("$destroy",function(){i(),j(),k(),l(),m(),n()})}]),angular.module("prodo.UserApp").factory("UserService",["$resource",function(a){var b={user_data:a("/api/user/:userid",{},{getUserSettings:{method:"GET"}}),Is_user_loggedin:a("/api/isloggedin",{},{checkUserSession:{method:"GET"}}),marketing:a("/api/marketing",{},{getMarketingData:{method:"GET"}})};return b}]).factory("UserSessionService",["$rootScope","$resource","$http","$state","$log",function(a,b,c,d,e){var f={Signup:b("/api/user/signup",{},{saveUser:{method:"POST"}}),Signin:b("/api/user/signin",{},{signinUser:{method:"POST"}}),ManageUser:b("/api/user/:userid",{},{getAllUsers:{method:"GET",isArray:!0},getUserSettings:{method:"GET",params:{userid:"@userid"},isArray:!1},updateUserSettings:{method:"PUT",params:{userid:"@userid"},isArray:!1},deleteUserSettings:{method:"DELETE",params:{userid:"@userid"}}}),User_Invites:b("/api/userinvites",{},{sendUserInvites:{method:"POST",isArray:!1}}),Update_Email:b("/api/changeemail/:userid",{},{updateEmailSettings:{method:"POST",params:{userid:"@userid"},isArray:!1}}),Change_Password:b("/api/changepassword/:userid",{},{updatePasswordSettings:{method:"POST",params:{userid:"@userid"},isArray:!1}}),ForgotPassword:b("/api/user/forgotpassword",{},{forgotPassword:{method:"POST"}}),ResetPassword:b("/api/user/resetpassword/:userid",{},{resetPassword:{method:"PUT",params:{userid:"@userid"},isArray:!1}}),RegenerateToken:b("/api/regenerateverificationtoken",{},{regenerateToken:{method:"POST"}}),IsUserLoggedin:b("/api/isloggedin",{},{checkUserSession:{method:"GET"}}),Logout:b("/api/logout",{},{logoutUser:{method:"GET"}}),Product_Followed:b("/api/myproductsfollowed?prodles=:data",{},{getProduct_Followed:{method:"GET",params:{data:"@data"}}}),Product_Recommend:b("/api/myrecommendproducts?prodles=:data",{},{getProduct_Recommend:{method:"GET",params:{data:"@data"}}}),Product_Follow:b("/api/user/follow/:data",{},{followProduct:{method:"GET",params:{data:"@data"}}}),Product_Unfollow:b("/api/user/unfollow/:data",{},{unfollowProduct:{method:"GET",params:{data:"@data"}}}),User_Profile:b("/api/profileinfo/:userid",{},{getUserProfile:{method:"GET",params:{userid:"@userid"}}}),Activate_Request:b("/api/activateaccountrequest",{},{sendAccountActivateRequest:{method:"POST"}})},g={};return g.isLoggedIn=!1,g.currentUser=null,g.productfollowlist=[],g.signupUser=function(b){f.Signup.saveUser(b,function(b){e.debug(b),a.$broadcast("signupDone",b)},function(b){e.debug(b),a.$broadcast("signupNotDone",b.status)})},g.activateaccount=function(b){f.Activate_Request.sendAccountActivateRequest(b,function(b){e.debug(b),a.$broadcast("activateAccountTokenDone",b)},function(b){e.debug(b),a.$broadcast("activateAccountTokenNotDone",b.status)})},g.signinUser=function(b){f.Signin.signinUser(b,function(b){e.debug(b),a.$broadcast("signinDone",b)},function(b){e.debug(b),a.$broadcast("signinNotDone",b.status)})},g.getUserProfileData=function(b,c){f.User_Profile.getUserProfile({userid:b},function(b){e.debug(b),a.$broadcast("getUserDataDone",b,c)}),function(b){e.debug(b),a.$broadcast("getUserDataNotDone",b)}},g.saveUserSettings=function(b){f.ManageUser.updateUserSettings({userid:g.currentUser.userid},b,function(b){e.debug(b),a.$broadcast("updateUserDone",b)},function(b){e.debug(b),a.$broadcast("updateUserNotDone",b.status)})},g.updateEmail=function(b){f.Update_Email.updateEmailSettings({userid:g.currentUser.userid},b,function(b){e.debug(b),a.$broadcast("updateUserEmailDone",b)},function(b){e.debug(b),a.$broadcast("updateUserEmailNotDone",b.status)})},g.updatePassword=function(b){f.Change_Password.updatePasswordSettings({userid:g.currentUser.userid},b,function(b){e.debug(b),a.$broadcast("updateUserPasswordDone",b)},function(b){e.debug(b),a.$broadcast("updateUserPasswordNotDone",b.status)})},g.getProductFollowed=function(b,c){f.Product_Followed.getProduct_Followed({data:b},function(b){e.debug(b),b.error?console.log("No products followed"):g.productfollowlist=b.success.products,a.$broadcast("getProductFollowedDone",b,c)},function(b){e.debug(b),a.$broadcast("getProductFollowedNotDone",b)})},g.getProductRecommend=function(b){f.Product_Recommend.getProduct_Recommend({data:b},function(b){e.debug(b),a.$broadcast("getProductRecommendDone",b)},function(b){e.debug(b),a.$broadcast("getProductRecommendNotDone",b)})},g.unfollowProduct=function(b,c){f.Product_Unfollow.unfollowProduct({data:b},function(b){e.debug(b),a.$broadcast("unfollowProductDone",b,c)},function(b){e.debug(b),a.$broadcast("unfollowProductNotDone",b)})},g.followProduct=function(b,c){f.Product_Follow.followProduct({data:b},function(b){e.debug(b),a.$broadcast("followProductDone",b,c)},function(b){e.debug(b),a.$broadcast("followProductNotDone",b)})},g.sendInvites=function(b){f.User_Invites.sendUserInvites(b,function(b){e.debug(b),a.$broadcast("sendUserInvitesDone",b)},function(b){e.debug(b),a.$broadcast("sendUserInvitesNotDone",b)})},g.removeUserSettings=function(){f.ManageUser.deleteUserSettings({userid:g.currentUser.userid},function(b){e.debug(b),a.$broadcast("deleteUserDone",b)},function(b){e.debug(b),a.$broadcast("daleteUserNotDone",b.status)})},g.getUserDetailSettings=function(){f.ManageUser.getUserSettings({userid:g.currentUser.userid},function(b){e.debug(b),a.$broadcast("getUserDone",b)},function(b){e.debug(b),a.$broadcast("getUserNotDone",b.status)})},g.updateUserData=function(a){g.currentUserData=a},g.forgotPasswordUser=function(b){f.ForgotPassword.forgotPassword(b,function(b){e.debug(b),a.$broadcast("forgotPasswordDone",b)},function(b){e.debug(b),a.$broadcast("forgotPasswordNotDone",b.status)})},g.resetPasswordUser=function(b){f.ResetPassword.resetPassword({userid:g.currentUser.userid},b,function(b){e.debug(b),a.$broadcast("resetPasswordDone",b)},function(b){e.debug(b),a.$broadcast("resetPasswordNotDone",b.status)})},g.regenerateTokenUser=function(b){f.RegenerateToken.regenerateToken(b,function(b){e.debug(b),a.$broadcast("regenerateTokenDone",b)},function(b){e.debug(b),a.$broadcast("regenerateTokenNotDone",b.status)})},g.init=function(){g.resetSession()},g.resetSession=function(){g.currentUser=null,g.isLoggedIn=!1},g.logoutUser=function(){f.Logout.logoutUser(function(b){void 0!==b.error&&"AL001"===b.error.code?(g.resetSession(),d.go("prodo.landing.signin")):(e.debug(b.success.message),g.resetSession(),a.$broadcast("logoutDone",b.success.message))},function(b){e.debug(b),a.$broadcast("logoutNotDone",b.status)})},g.authSuccess=function(b){g.currentUser=b,g.isLoggedIn=!0,a.$broadcast("session",b)},g.authfailed=function(){g.resetSession()},g.checkUser=function(){f.IsUserLoggedin.checkUserSession(function(a){e.debug(a),a.success?g.authSuccess(a.success.user):g.authfailed()},function(b){e.debug(b),a.$broadcast("session-changed-failure",b.status)})},g}]).factory("UserSignupService",["$resource",function(a){return a("/api/user/signup",{},{saveUser:{method:"POST"}})}]).factory("UserRecaptchaService",["$http","vcRecaptchaService","$log",function(a,b,c){var d={};
return d.validate=function(e){var f="POST",g="/api/recaptcha",h={recaptcha:{response:Recaptcha.get_response(),challenge:Recaptcha.get_challenge()}},i=JSON.stringify(h);a({method:f,url:g,data:i,headers:{"Content-Type":"application/json"}}).success(function(a){c.debug("success"),c.debug(a),d.handleRecaptchaResponse(e,a)}).error(function(a,d){c.debug(d),e.$broadcast("recaptchaFailure",d),b.reload()})},d.handleRecaptchaResponse=function(a,d){d.success?(c.debug(d.success),a.$emit("recaptchaDone","Success")):(c.debug(d.error.message),a.$emit("recaptchaNotDone","Failure"),b.reload())},d}]),angular.module("prodo.ProdoWallApp").controller("ProdoWallOrgController",["$rootScope","$scope","$state","$log","UserSessionService","orgdata","orgaddr","orgproduct","broadcastData","$stateParams","growl","checkIfSessionExist",function(a,b,c,d,e,f,g,h,i,j,k,l){a.orgdata={},d.debug("initialising org child.."),b.orgaddr=[],b.productlist=[],b.messages=[],b.keyclients=[],b.isFollowing=!1,b.$state=c,l.success&&f.success&&b.$watch("$state.$current.locals.globals.orgdata",function(c){a.orgdata=c.success.organization,c.success.organization.keyclients&&0!==c.success.organization.keyclients.length&&(b.keyclients=c.success.organization.keyclients),void 0==c.success.organization.org_logo&&(a.orgdata.org_logo={image:"../../../assets/images/if_no_logo_images_available.gif"}),0!==c.success.organization.org_images.length?(d.debug("Org images emitting "),b.$emit("emittingOrgImages",c.success.organization.org_images)):b.$emit("emittingNoOrgImages",c.success.organization.org_images),d.debug(a.orgdata)}),l.success&&i.success&&b.$watch("$state.$current.locals.globals.broadcastData",function(a){0!==a.success.broadcast.length&&(b.messages=a.success.broadcast,d.debug(b.messages))}),l.success&&g.success&&b.$watch("$state.$current.locals.globals.orgaddr",function(a){b.orgaddr=a.success.orgaddress}),l.success&&h.success&&b.$watch("$state.$current.locals.globals.orgproduct",function(c){if(c.error)d.debug("No product available");else if(b.productlist=c.success.product,b.product_prodles=[],a.product_prodle=b.productlist[0].prodle,a.orgid=b.productlist[0].orgid,e.productfollowlist.length>0)for(var f=0;f<e.productfollowlist.length;f++)if(e.productfollowlist[f]&&e.productfollowlist[f].prodle){var g=e.productfollowlist[f].prodle;b.product_prodles.indexOf(g)<0&&b.product_prodles.push(g)}});var m=b.$on("unfollowProductFromSidelist",function(){c.transitionTo(c.current,j,{reload:!0,inherit:!1,notify:!0})});b.handlefollowproductResponse=function(b,f){b.success?(e.productfollowlist.push(f),c.transitionTo(c.current,j,{reload:!0,inherit:!1,notify:!0}),a.ProdoAppMessage("You can start your product conversation for "+f.name,"success")):void 0!==b.error&&"AL001"===b.error.code?a.showModal():(d.debug(b.error.message),a.ProdoAppMessage(b.error.message,"error"))},b.follow=function(a){e.followProduct(a.prodle,a)};var n=b.$on("followProductDone",function(a,c,d){b.isFollowing=!0,b.handlefollowproductResponse(c,d)}),o=b.$on("followProductNotDone",function(){b.isFollowing=!0,a.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it","error")});b.$on("$destroy",function(){n(),o(),m()})}]),angular.module("prodo.ProdoHomeApp").controller("ProdoHomeController",["$rootScope","$scope","$state","$log","UserSessionService","$stateParams","growl","allOrgData","allCampaignData","prodoSearchService","checkIfSessionExist","trendingProductService",function(a,b,c,d,e,f,g,h,i,j,k,l){d.debug(h),d.debug(i),b.campaigns=[],b.allorganalytics=[],b.searchorganalytics=[],b.searchForOrg=!1,b.latestsignups=[],b.orgsponsers=[],b.isCollapsed=!0,b.regularExpressionForProdonus=/^prodonus/i,b.trendingProducts={},b.$state=c,l.getTrendingProducts(),b.org={orgName:"",nameOfProduct:"",feature:"",category:"",model_number:""},b.trendingProductEmit=function(b,d){a.product_prodle=b,a.orgid=d,c.transitionTo("prodo.productwall.wall-product")};var m=b.$on("gotTrendingProducts",function(a,c){void 0!==c.success&&(b.trendingProducts=c.success.ProductTrends)}),n=b.$on("notGotTrendingProducts",function(){a.ProdoAppMessage("There is some issue with the server! Please try after some time","error")});b.$watch("$state.$current.locals.globals.checkIfSessionExist",function(b){null!==b&&void 0!==b&&b.error&&a.showModal()}),h.success&&(0!==h.success.organalyticsall.length&&(b.allorganalytics=h.success.organalyticsall),0!==h.success.organalyticslatest.length&&(b.latestsignups=h.success.organalyticslatest),0!==h.success.organalyticssponser.length&&(b.orgsponsers=h.success.organalyticssponser)),i.success&&0!==i.success.campaigns.length&&(b.campaigns=i.success.campaigns),b.transitionToOrgWall=function(b){a.orgid=b,c.transitionTo("prodo.productwall.wall-org")},b.transitionToCampaignWall=function(b,d,e){a.orgid=b,a.product_prodle=e,a.campaign_idwall=d,c.transitionTo("prodo.productwall.wall-campaign")},b.search={productsearchdata:{}},b.back=function(){b.searchForOrg=!1},b.homeSearchInit=function(){if(void 0!==b.org.orgName&&""!==b.org.orgName||void 0!==b.org.nameOfProduct&&""!==b.org.nameOfProduct||void 0!==b.org.category&&""!==b.org.category||void 0!==b.org.feature&&""!==b.org.feature||void 0!==b.org.model_number&&""!==b.org.model_number){if(""!==b.org.nameOfProduct){var c=b.org.nameOfProduct.replace(/\s/g,"");b.search.productsearchdata.Product_Name=c,c=""}else b.search.productsearchdata.Product_Name="",b.countForEmptyTextbox++;if(""!==b.org.model_number){var c=b.org.model_number.replace(/\s/g,"");b.search.productsearchdata.Model_Number=c,c=""}else b.search.productsearchdata.Model_Number="",b.countForEmptyTextbox++;if(""!==b.org.feature){var c=b.org.feature.replace(/\s/g,"");b.search.productsearchdata.Feature=c,c=""}else b.search.productsearchdata.Feature="",b.countForEmptyTextbox++;if(""!==b.org.category){var c=b.org.category.replace(/\s/g,"");b.search.productsearchdata.Category=c,c=""}else b.search.productsearchdata.Category="",b.countForEmptyTextbox++;if(""!==b.org.orgName){var c=b.org.orgName.replace(/\s/g,"");b.search.productsearchdata.Organization_Name=c,c=""}else b.search.productsearchdata.Organization_Name="",b.countForEmptyTextbox++;b.search.productsearchdata.searchtype="home",j.searchProduct(b.search)}else a.ProdoAppMessage("Please enter atleast one search criteria to proceed with search","error")},b.clearTextboxContent=function(){b.org={orgName:"",nameOfProduct:"",feature:"",category:"",model_number:""}};var o=b.$on("getSearchProductDone",function(c,d){void 0!==d.error&&"AL001"===d.error.code?a.showModal():d.error?a.ProdoAppMessage(d.error.message,"error"):(void 0!==d.success.organalytics&&(d.success.organalytics.length>0?(b.searchorganalytics=d.success.organalytics,b.searchForOrg=!0):0===d.success.organalytics.length&&a.ProdoAppMessage("No organizations found for specified search criteria","success")),void 0===d.success.organalytics&&a.ProdoAppMessage("No organizations found for specified search criteria","success"))}),p=b.$on("getSearchProductNotDone",function(){a.ProdoAppMessage("There is some issue with the server! Please try after some time","error")});b.$on("$destroy",function(){m(),n(),o(),p()})}]),angular.module("prodo.ProdoHomeApp").factory("HomeService",["$resource",function(a){var b={all_campaign_data:a("/api/activecampaign",{},{getAllCampaigns:{method:"GET"}})};return b}]),angular.module("prodo.ProdonusApp").controller("ProdoMarketingController",["$rootScope","$scope","$state","$log","$stateParams","growl","marketingData",function(a,b,c,d,e,f,g){console.log(g),b.slides=[],b.slides=g.success?g.success.marketingdata:[{artwork:{images:"../../../assets/images/if_no_logo_images_available.gif"}}]}]),angular.module("prodo.OrgApp").controller("OrgAccountController",["$scope","$rootScope","$state","$http","$timeout","$log","$modal","growl","UserSessionService","OrgRegistrationService","OrgService","currentorgdata","currentorgaddr","currentorgproduct","currentorggroup","ENV","industrycategorydata",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){a.submitted=!1,a.form={},a.productlist=[],a.islocation=!1,a.user={password:""},a.$state=c,a.orginvitesbody={orginvites_body:""},a.contacts=[{customerhelpline:""},{customerhelpline:""},{customerhelpline:""}],a.orginvites={to:"",subject:"",body:""},a.custinvitesbody={customerinvites_body:""},a.orginvitesbody.orginvites_body="Dear 'name',\n\nWe have got great news. \nToday we are excited to tell you how you can come closer to your customers, get to know their needs,understand their issues, complaints better, and also engage them to create innovative ideas, in addition to managing their warranties.\nWe offer a warranty and social platform for products, for all product manufacturers and their customers sharing their insights on products. \nProdonus is a social network and warranty platform for products, enabling conversations, building relationships and gathering real-time market intelligence from customers. \nWebring business closer to customers to engage them more directly. \nIt helps toshare your concerns, complaints, compliments, innovative ideas, business perspectives and product recommendations among the manufacturing business andproduct consumers.\nWe look forward to meeting you to discuss your requirements to signup on our new platform.\n\nAll thebest,\n'orgname'",a.customerinvites={to:"",subject:"",body:""},a.custinvitesbody.customerinvites_body=" Hi <customername>,\n\nWe have subscribed to Prodonus(https://www.prodonus.com) that offers a warranty and social network platform for products, enabling conversations with product manufacturers or service providers. \nIt helps to share our concerns, complaints, compliments, innovative ideas, business perspectives and product recommendations with the manufacturing business.\nAs a consumer one can follow what's happening on our products.\nProdonus helps you share your perspective on the products using words, video links and picture/images with manufacturer's and other consumers. \nConversations are purposeful and intended to catch our attention. Share your views and make it known to the other users and us immediately. \nIn addition, you can store your product warranty data and get instant access to it and also, be notified of changing status immediately, especially expiration status.\nEager to start? \nSignup with prodonus.com and start following our products, and there’s no limit to the number of products you can follow.\nSincerely,from username from orgname",a.group={newgroupname:"",grouppname:"",invites:"",newinvites:""},o.success?a.groups=o.success.usergrp:b.ProdoAppMessage("There is some issue with the server! Please try after some time"),m.success?a.orgaddr=m.success.orgaddress:b.ProdoAppMessage("There is some issue with the server! Please try after some time"),l.success?(a.orgImages=l.success.organization.org_images,a.orgKeyClients=l.success.organization.keyclients):b.ProdoAppMessage("There is some issue with the server! Please try after some time"),a.industries=[],q.success&&(a.industries=q.success.industry_category),a.returnOrganizationCategory=function(){return a.industries},a.org=[{description:""}];a.validateError=!1,a.regexForText=/^[a-zA-Z\s]*$/,a.regexForNumbers=/[0-9]/,a.regexForEmail=/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/,a.regexForPhno=/^\(?[+]([0-9]{2,5})\)?[-]?([0-9]{10,15})$/,a.regexForMultipleEmail=/(([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)(\s*,\s*|\s*$)+)/,a.regularExpressionForManufactuter=/^manufacturer/i,a.regularExpressionForCompany=/^company/i,a.fromOrgDetails="From: business@prodonus.com",a.fromOrgCustDetails="From: business@prodonus.com",a.editorEnabled=!1,a.orgaddresstype="",a.showGrowlMessage=0,a.countries=["Afghanistan","Albania","Algeria","American Samoa","Andorra","Angola","Anguilla","Antigua and Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia","Bosnia-Herzegovina","Botswana","Bouvet Island","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Cayman Islands","Central African Republic","Chad","Chile","China","Christmas Island","Cocos (Keeling) Islands","Colombia","Comoros","Congo, Democratic Republic of the (Zaire)","Congo, Republic of","Cook Islands","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Falkland Islands","Faroe Islands","Fiji","Finland","France","French Guiana","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guadeloupe (French)","Guam (USA)","Guatemala","Guinea","Guinea Bissau","Guyana","Haiti","Holy See","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Ivory Coast (Cote D`Ivoire)","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macau","Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Martinique (French)","Mauritania","Mauritius","Mayotte","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","Netherlands Antilles","New Caledonia (French)","New Zealand","Nicaragua","Niger","Nigeria","Niue","Norfolk Island","North Korea","Northern Mariana Islands","Norway","Oman","Pakistan","Palau","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Pitcairn Island","Poland","Polynesia (French)","Portugal","Puerto Rico","Qatar","Reunion","Romania","Russia","Rwanda","Saint Helena","Saint Kitts and Nevis","Saint Lucia","Saint Pierre and Miquelon","Saint Vincent and Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Georgia and South Sandwich Islands","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Svalbard and Jan Mayen Islands","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste (East Timor)","Togo","Tokelau","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Turks and Caicos Islands","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Virgin Islands","Wallis and Futuna Islands","Yemen","Zambia","Zimbabwe"],a.states={},a.states.india=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar ","Chhattisgarh ","Goa","Gujarat","Haryana","Himachal Pradesh","Jammu and Kashmir","Jharkhand","Kerala ","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Orissa ","Punjab","Rajasthan","Sikkim","Tamil Nadu","Tripura","Uttar Pradesh","Uttarakhand","West Bengal"],a.india={},a.india.major_cities=["Port Blair","Hyderabad","Itanagar","Dispur","Patna","Silvassa","Daman","Delhi","Gandhinagar","Chandigarh","Ranchi","Bengaluru","Thiruvananthapuram","Kavaratti","Bhopal","Imphal","Shillong","Aizwal","Kohima","Bhubaneshwar","Puducherry","Chandigarh","Jaipur","Agartala","Mumbai","Lucknow","Kolkata","Panaji","Pune"],a.selected_country="",a.return_states=function(){return"India"===a.org.country?a.states.india:""},a.return_cities=function(){return"India"===a.org.country?a.india.major_cities:""},a.deleteOrgArtworImages=function(){a.imageids=[];for(var b=0;b<a.orgImages.length;b++)document.getElementById(b).checked===!0&&a.imageids.push(a.orgImages[b].imageid);0!==a.imageids.length&&j.singleOrgImageDelete(a.imageids)},a.handleDeleteOrgRequestResponse=function(c){a.deleteOrgRequestResponse=!0,c.success?b.ProdoAppMessage(c.success.message,"success"):(f.debug(c.error.message),b.ProdoAppMessage(c.error.message,"error"))},a.deleteOrgAccountRequest=function(){j.removeOrgSettings()};var r=a.$on("deleteOrgRequestSent",function(c,d){void 0!==d.error&&"AL001"===d.error.code?b.showModal():a.handleDeleteOrgRequestResponse(d)}),s=a.$on("deleteOrgRequestNotSent",function(c,d){a.deleteOrgRequestResponse=!0,b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.handleUpdateOrgAccountResponse=function(d){a.changedOrgDetails=!0,d.success?(a.editorEnabled=!1,c.reload(),b.ProdoAppMessage(d.success.message,"success")):"AU004"==d.error.code?b.ProdoAppMessage(d.error.message,"error"):b.ProdoAppMessage(d.error.message,"error")},a.invalidOrgName="",a.invalidDesc="",a.invalidPassword="",a.errorCategory="",a.updateOrgAccount=function(){a.invalidOrgName="",a.invalidDesc="",a.invalidPassword="",a.errorCategory="",a.form.orggeneralsettingform.$valid&&a.org.industry_category.length>0?(a.form.orggeneralsettingform.submitted=!0,j.saveOrgSettings(a.jsonOrgAccountData())):(a.form.orggeneralsettingform.orgname.$valid===!1&&(a.invalidOrgName="Please enter valid Org name"),a.form.orggeneralsettingform.description.$valid===!1&&(a.invalidDesc="Please enter valid description\n [ Number of characters should be more than 0 and less than 500 ]"),a.form.orggeneralsettingform.password.$valid===!1&&(a.invalidPassword="Please enter valid password"),0===a.org.industry_category.length&&(a.errorCategory="Please enter valid industry category"))},a.jsonOrgAccountData=function(){var b={organization:{name:a.org.name,description:a.org.description,industry_category:a.org.industry_category,password:a.user.password}};return JSON.stringify(b)};var t=a.$on("updateOrgDone",function(c,d){void 0!==d.error&&"AL001"===d.error.code?b.showModal():a.handleUpdateOrgAccountResponse(d)}),u=a.$on("updateOrgNotDone",function(c,d){a.changedOrgDetails=!0,b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.jsonOrgAddressData=function(){var b={location:{address:{address1:a.org.address1,address2:a.org.address2,address3:a.org.address3,country:a.org.country,city:a.org.city,state:a.org.state,zipcode:a.org.zipcode},contacts:a.contacts,locationtype:a.orgaddresstype}};return JSON.stringify(b)},a.addressErrorMessage="",a.invalidCountryError="",a.invalidStateError="",a.invalidCityError="",a.invalidZipcodeError="",a.invalidContact1="",a.invalidContact2="",a.invalidContact3="",a.handleAddOrgAddressResponse=function(c){a.addedOrgLocation=!1,c.success?(a.reset(),b.ProdoAppMessage(c.success.message,"success")):"AU004"==c.error.code?(f.debug(c.error.code+" "+c.error.message),b.ProdoAppMessage(c.error.message,"error")):(f.debug(c.error.message),b.ProdoAppMessage(c.error.message,"error"))},a.addOrgAddress=function(){a.addressErrorMessage="",a.invalidCountryError="",a.invalidStateError="",a.invalidCityError="",a.invalidZipcodeError="",a.emptyOrgtypeSelection="",a.invalidContact1="",a.invalidContact2="",a.invalidContact3="",a.orgaddresstype=document.getElementById("orgAddressType").value,!a.form.orgaddlocationform.$valid||"Company Address"!==a.orgaddresstype&&"Service Centers"!==a.orgaddresstype?((""===a.org.address1||a.form.orgaddlocationform.address1.$valid===!1)&&(a.addressErrorMessage="Please enter valid address "),(a.form.orgaddlocationform.country.$valid===!1||""===a.org.country)&&(a.invalidCountryError="Please enter correct country"),(a.form.orgaddlocationform.state.$valid===!1||""===a.org.country)&&(a.invalidStateError="Please enter valid state"),(a.form.orgaddlocationform.city.$valid===!1||""===a.org.city)&&(a.invalidCityError="Please enter valid city"),(a.form.orgaddlocationform.zipcode.$valid===!1||""===a.org.zipcode)&&(a.invalidZipcodeError="Please enter valid Zipcode"),(a.form.orgaddlocationform.contact1.$valid===!1||a.form.orgaddlocationform.contact1.$dirty===!1)&&(a.invalidContact1="Please enter valid phone number"),a.form.orgaddlocationform.contact2.$valid===!1&&(a.invalidContact2="Please enter valid phone number"),a.form.orgaddlocationform.contact3.$valid===!1&&(a.invalidContact3="Please enter valid phone number"),(a.form.orgaddlocationform.loctype.$valid===!1||a.form.orgaddlocationform.loctype.$dirty===!1)&&(a.emptyOrgtypeSelection="Please select option from above field"),a.form.orgaddlocationform.submitted=!0):(a.form.orgaddlocationform.submitted=!0,j.saveOrgAddress(a.jsonOrgAddressData()))},a.jsonOrgAddressUpdate=function(b,c){a.contacts[0].customerhelpline=b.contacts[0].customerhelpline,a.contacts[1].customerhelpline=b.contacts[1].customerhelpline,a.contacts[2].customerhelpline=b.contacts[2].customerhelpline;var d={location:{address:{address1:b.address.address1,address2:b.address.address2,address3:b.address.address3,country:b.address.country,city:b.address.city,state:b.address.state,zipcode:b.address.zipcode},contacts:a.contacts,locationtype:c}};return JSON.stringify(d)};var v=a.$on("addOrgAddressDone",function(d,e){void 0!==e.error&&"AL001"===e.error.code?b.showModal():(a.handleAddOrgAddressResponse(e),c.reload())}),w=a.$on("addOrgAddressNotDone",function(c,d){a.addedOrgLocation=!1,b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.handleUpdateOrgAddressResponse=function(d){a.changedOrgLocation=!1,d.success?(b.ProdoAppMessage(d.success.message,"success"),a.reset(),c.reload()):"AU004"==d.error.code?(f.debug(d.error.code+" "+d.error.message),b.ProdoAppMessage(d.error.message,"error")):(f.debug(d.error.message),b.ProdoAppMessage(d.error.message,"error"))},a.regexForZipcode=/^[0-9]{5,7}$/,a.updateAddress=function(b,c){a.errorOfValidation="Please enter valid ",a.errorsForEdit="",(void 0===b.address.address1||""===b.address.address1)&&(a.errorsForEdit=a.errorsForEdit+"'address1' "),(void 0===b.address.city||a.regexForText.test(b.address.city)!==!0)&&(a.errorsForEdit=a.errorsForEdit+"'city' "),(void 0===b.address.state||a.regexForText.test(b.address.state)!==!0)&&(a.errorsForEdit=a.errorsForEdit+"'state' "),(void 0===b.address.country||a.regexForText.test(b.address.country)!==!0)&&(a.errorsForEdit=a.errorsForEdit+"'country' "),(void 0===b.address.zipcode||a.regexForZipcode.test(b.address.zipcode)!==!0)&&(a.errorsForEdit=a.errorsForEdit+"'zipcode' "),(void 0===b.contacts[0].customerhelpline||""===b.contacts[0].customerhelpline||a.regexForPhno.test(b.contacts[0].customerhelpline)!==!0)&&(a.errorsForEdit=a.errorsForEdit+"'contact 1' "),void 0!==b.contacts[1].customerhelpline&&""!==b.contacts[1].customerhelpline&&a.regexForPhno.test(b.contacts[1].customerhelpline)!==!0&&(a.errorsForEdit=a.errorsForEdit+"'contact 2' "),void 0!==b.contacts[2].customerhelpline&&""!==b.contacts[2].customerhelpline&&a.regexForPhno.test(b.contacts[2].customerhelpline)!==!0&&(a.errorsForEdit=a.errorsForEdit+"'contact 3' "),""!==a.errorsForEdit?a.errorOfValidation=a.errorOfValidation+a.errorsForEdit:(b.editing=!1,j.updateOrgAddress(a.jsonOrgAddressUpdate(b,c),b.locid))};var x=a.$on("updateOrgAddressDone",function(c,d){void 0!==d.error&&"AL001"===d.error.code?b.showModal():a.handleUpdateOrgAddressResponse(d)}),y=a.$on("updateOrgAddressNotDone",function(c,d){a.changedOrgLocation=!0,b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.handleDeleteOrgAddressResponse=function(d){a.changedOrgLocation=!0,d.success?(c.reload(),b.ProdoAppMessage(d.success.message,"success")):(f.debug(d.error.message),b.ProdoAppMessage(d.error.message,"error"))},a.deleteOrgAddress=function(b){a.changedOrgLocation=!0,j.removeOrgAddress(b.locid)};var z=a.$on("deleteOrgAddressDone",function(c,d){void 0!==d.error&&"AL001"===d.error.code?b.showModal():a.handleDeleteOrgAddressResponse(d)}),A=a.$on("deleteOrgAddressNotDone",function(){a.changedOrgLocation=!0,b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it.message,error")});a.handleDeleteOrgGroupMemberResponse=function(c){a.manageOrgGroup=!0,c.success?(a.orginvites={to:"",subject:""},b.ProdoAppMessage(c.success.message,"success")):"AU004"==c.error.code?(f.debug(c.error.code+" "+c.error.message),b.ProdoAppMessage(c.error.message,"error")):(f.debug(c.error.message),b.ProdoAppMessage(c.error.message,"error"))},a.deleteGroupMember=function(c,d,e,f){if("admin"===c.grpname){var g=a.groups[e].grpmembers.length;1===g?b.ProdoAppMessage("You cannot delete all members of admin group","error"):b.usersession.currentUser.email===f?b.ProdoAppMessage("You cannot delete your own account","error"):j.deleteMember(c.grpid,d)}else j.deleteMember(c.grpid,d)};var B=a.$on("deleteOrgGroupMemberDone",function(c,d){void 0!==d.error&&"AL001"===d.error.code?b.showModal():a.handleDeleteOrgGroupMemberResponse(d)}),C=a.$on("deleteOrgGroupMemberNotDone",function(c,d){a.manageOrgGroup=!0,b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.resetInvites=function(){a.orginvites={name:"",orgname:"",email:""},a.customerinvites={name:"",email:""}},a.jsonOrgInvitesData=function(){var b={otherorginvites:a.orginvites};return JSON.stringify(b)},a.handleOrgInviteResponse=function(c){a.addOrgInvites=!0,c.success?b.ProdoAppMessage(c.success.message,"success"):"AU004"==c.error.code?(f.debug(c.error.code+" "+c.error.message),b.ProdoAppMessage(c.error.message,"error")):(f.debug(c.error.message),b.ProdoAppMessage(c.error.message,"error"))},a.orgInvitesToError="",a.orgInvitesSubjectError="",a.orgInvitesBodyError="",a.sendOrgInvites=function(){var b=0;a.orgInvitesToError="",a.orgInvitesSubjectError="",a.orgInvitesBodyError="",(void 0===a.orginvites.to||""===a.orginvites.to||a.regexForEmail.test(a.orginvites.to)===!1)&&(a.orgInvitesToError="Please enter valid email address",b=1),(void 0===a.orginvites.subject||""===a.orginvites.subject)&&(a.orgInvitesSubjectError="Please enter valid subject",b=1),(void 0===a.orginvitesbody.orginvites_body||""===a.orginvitesbody.orginvites_body)&&(a.orgInvitesBodyError="Please enter valid content in body section",b=1),0===b&&(a.orginvites.body=a.orginvitesbody.orginvites_body.replace(/\n/g,"<br>"),j.sendInvites(a.jsonOrgInvitesData()))};var D=a.$on("sendOrgInvitesDone",function(c,d){void 0!==d.error&&"AL001"===d.error.code?b.showModal():a.handleOrgInviteResponse(d)}),E=a.$on("sendOrgInvitesNotDone",function(c,d){a.addOrgInvites=!0,b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.handleOrgGroupInviteResponse=function(d){a.manageOrgGroup=!0,d.success?(c.reload(),a.showExistingInvites=!1,a.showNewInvites=!1,a.group={newgroupname:"",grouppname:"",invites:"",newinvites:""},b.ProdoAppMessage(d.success.message,"success")):"AU004"==d.error.code?(f.debug(d.error.code+" "+d.error.message),b.ProdoAppMessage(d.error.message,"error")):(f.debug(d.error.message),b.ProdoAppMessage(d.error.message,"error"))},a.jsonOrgNewGroupInvitesData=function(){var b={usergrp:{grpname:a.group.newgroupname,invites:a.group.newinvites}};return JSON.stringify(b)},a.jsonOrgExistingGroupInvitesData=function(){var b={usergrp:{grpname:a.group.groupname,invites:a.group.invites}};return JSON.stringify(b)},a.addExistingInvites=function(){a.addInvitesList="existing",a.showExistingInvites=!0},a.errorForInvites="Please check emails ",a.newInvitesValidate="",a.errorForExistinginvites="Please check emails ",a.prevInvitesValidate="",a.errorForEmptyGroupName="",a.errorForEmptyExistingGroupname="",a.clearErrorMessages=function(){a.errorForInvites="",a.errorForEmptyGroupName="",a.errorForExistinginvites="",a.errorForEmptyExistingGroupname=""},a.addGroupInvite=function(){a.errorForEmptyGroupName="",a.errorForInvites="Please check emails ",a.newInvitesValidate="";var b=0,c=a.group.newinvites;if(void 0!==c&&""!==c)for(var d=c.split(","),e=0;e<d.length;e++)""!==d[e]&&a.regexForEmail.test(d[e])===!1&&(a.newInvitesValidate=a.newInvitesValidate+"'"+d[e]+"' ");if(""!==a.newInvitesValidate&&(a.errorForInvites=a.errorForInvites+a.newInvitesValidate,b=1),(void 0===a.group.newgroupname||""===a.group.newgroupname)&&(a.errorForEmptyGroupName="Please enter valid group name",b=1),""!==a.group.newgroupname)for(var f=0;f<a.groups.length;f++)a.group.newgroupname===a.groups[f].grpname&&(a.errorForEmptyGroupName='Group name already exist! Please use "Existing groups" feature',b=1);(""===a.group.newinvites||void 0===a.group.newinvites)&&(a.errorForInvites="Email List cant be empty",b=1),0===b&&(j.groupInvites(a.jsonOrgNewGroupInvitesData()),a.clearErrorMessages())},a.addExistingGroupInvite=function(){a.prevInvitesValidate="",a.errorForExistinginvites="Please check emails ",a.errorForEmptyExistingGroupname="";var b=0,c=a.group.invites;if(void 0!==c&&""!==c)for(var d=c.split(","),e=0;e<d.length;e++)""!==d[e]&&a.regexForEmail.test(d[e])===!1&&(a.prevInvitesValidate=a.prevInvitesValidate+"'"+d[e]+"' ");""!==a.prevInvitesValidate&&(a.errorForExistinginvites=a.errorForExistinginvites+a.prevInvitesValidate,b=1),void 0===a.group.groupname&&(a.errorForEmptyExistingGroupname="Please select valid groupname from the list",b=1),(""===a.group.invites||void 0===a.group.invites)&&(a.errorForExistinginvites="Email list cant be empty",b=1),0===b&&(j.groupInvites(a.jsonOrgExistingGroupInvitesData()),a.clearErrorMessages())};var F=a.$on("sendOrgGroupInvitesDone",function(c,d){void 0!==d.error&&"AL001"===d.error.code?b.showModal():a.handleOrgGroupInviteResponse(d)}),G=a.$on("sendOrgGroupInvitesNotDone",function(){a.manageOrgGroup=!0,b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+message,"error")});a.handleOrgCustomerInviteResponse=function(a){a.success?b.ProdoAppMessage(a.success.message,"success"):"AU004"==a.error.code?(f.debug(a.error.code+" "+a.error.message),b.ProdoAppMessage(a.error.message,"error")):(f.debug(a.error.message),b.ProdoAppMessage(a.error.message,"error"))},a.jsonOrgCustomerInvitesData=function(){var b={orgcustomerinvites:a.customerinvites};return JSON.stringify(b)},a.orgCustToError="",a.orgCustSubjectError="",a.orgCustContentError="";var H=0;a.orgCustomerInvites=function(){a.orgCustToError="",a.orgCustSubjectError="",a.orgCustContentError="";var b=0;(void 0===a.customerinvites.to||""===a.customerinvites.to||a.regexForEmail.test(a.customerinvites.to)===!1)&&(a.orgCustToError="Please enter valid email address",b=1),(void 0===a.customerinvites.subject||""===a.customerinvites.subject)&&(a.orgCustSubjectError="Please enter valid subject",b=1),(void 0===a.custinvitesbody.customerinvites_body||""===a.custinvitesbody.customerinvites_body)&&(a.orgCustContentError="Please enter valid content in body section",b=1),0===b&&(a.customerinvites.body=a.custinvitesbody.customerinvites_body.replace(/\n/g,"<br>"),j.sendCustomerInvites(a.jsonOrgCustomerInvitesData()))};{var I=a.$on("sendOrgCustomerInvitesDone",function(c,d){void 0!==d.error&&"AL001"===d.error.code?b.showModal():a.handleOrgCustomerInviteResponse(d)}),J=a.$on("sendOrgCustomerInvitesNotDone",function(){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it.","error")}),K=a.$on("orgImageDeleted",function(a,d){void 0!==d.error&&"AL001"===d.error.code&&b.showModal(),d.success?(b.ProdoAppMessage(d.success.message,"success"),c.reload()):"AU004"==d.error.code?b.ProdoAppMessage(d.error.message,"error"):b.ProdoAppMessage(d.error.message,"error")});a.$on("orgImageDeleteNotDone",function(){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it.","error")
})}a.$watch("$state.$current.locals.globals.currentorggroup",function(b){a.groups=b.success.usergrp}),a.$watch("$state.$current.locals.globals.currentorgdata",function(b){a.orgImages=b.success.organization.org_images,a.org=b.success.organization,a.orgKeyClients=b.success.organization.keyclients}),a.$watch("$state.$current.locals.globals.currentorgaddr",function(b){a.orgaddr=b.success.orgaddress}),n.error||(a.productlist=n.success.product),a.removeKeyClientsPermenantly=function(){a.clientids=[];for(var b=0;b<a.orgKeyClients.length;b++)document.getElementById("keyClient"+b).checked===!0&&a.clientids.push(a.orgKeyClients[b].clientid);0!==a.clientids.length&&j.keyClientDelete(a.clientids)};{var L=a.$on("orgUploadLogoResponseSuccess",function(){c.reload()}),M=a.$on("orgUploadResponseSuccess",function(){c.reload()}),N=a.$on("clientsDeletesSuccessfully",function(a,d){void 0!==d.error&&"AL001"===d.error.code&&b.showModal(),d.success?(b.ProdoAppMessage(d.success.message,"success"),c.reload()):"AU004"==d.error.code?b.ProdoAppMessage(d.error.message,"error"):b.ProdoAppMessage(d.error.message,"error")}),O=a.$on("clientsNotDeletedSuccessfully",function(){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+data,"error")});a.$on("orgKeyClientResponseSuccess",function(){b.currentclient.name="",c.reload()})}a.enableEditing=function(a){a.editing=!0},a.disableEditing=function(b){b.editing=!b.editing,a.errorOfValidation="Please enter valid ",c.reload()},a.addLocation=function(){a.reset(),a.islocation=!0},a.showKeyClient=0,a.showOrgArtworkImages=0,a.invokeKeyClients=function(){a.showKeyClient=1,a.showOrgArtworkImages=0},a.invokeOrgArtwork=function(){a.showKeyClient=0,a.showOrgArtworkImages=1},a.reset=function(){a.addressErrorMessage="",a.invalidCountryError="",a.invalidStateError="",a.invalidCityError="",a.invalidZipcodeError="",a.emptyOrgtypeSelection="",a.invalidContact1="",a.invalidContact2="",a.invalidContact3="",a.user.password="",a.invalidPassword="",a.invalidDesc="",a.invalidOrgName="",a.islocation=!1,a.org.orgaddresstype="",a.org.address1="",a.org.address2="",a.org.address3="",a.org.country="",a.org.city="",a.org.state="",a.org.zipcode="",a.contacts=[{customerhelpline:""},{customerhelpline:""},{customerhelpline:""}]},a.addInvitesList="",a.addCustomerInvites=function(){var b=a.customerinvites.length;""!==a.customerinvites[b-1].name&&""!==a.customerinvites[b-1].email&&(a.customerinvites.push({name:"",email:""}),H=0)},a.addNewInvites=function(){a.addInvitesList="new",a.showNewInvites=!0},a.disableEditor=function(){a.editorEnabled=!1,a.user={password:""},c.reload()},a.enableEditor=function(){a.reset(),a.editorEnabled=!0},a.joinbrfororginvites=function(){a.orginvitesbody.orginvites_body=a.orginvitesbody.orginvites_body+"\n"},a.joinbrCstfororginvites=function(){a.custinvitesbody.customerinvites_body=a.custinvitesbody.customerinvites_body+"\n"},a.$on("$destroy",function(){t(),u(),v(),w(),x(),y(),r(),s(),z(),A(),B(),C(),D(),E(),I(),J(),F(),G(),L(),K(),M(),N(),O()})}]),angular.module("prodo.OrgApp").controller("ManageOrgBroadcastController",["$scope","$rootScope","$stateParams","$state","$http","$timeout","$log","growl","UserSessionService","OrgRegistrationService","OrgService","getBroadcastData",function(a,b,c,d,e,f,g,h,i,j,k,l){a.submitted=!1,a.form={},a.broadcasts=[],a.broadcast={message:"",duration:"",type:""},a.options=[{name:"Normal",value:"Normal"},{name:"Urgent",value:"Urgent"}],a.broadcast.type=a.options[0],a.clear=function(){a.form.orgMessageBroadcastform.$setPristine(),a.broadcast={message:"",duration:"",type:a.options[0]}},a.$state=d,l.success&&a.$watch("$state.$current.locals.globals.getBroadcastData",function(b){0!==b.success.broadcast.length&&(a.broadcasts=b.success.broadcast)}),a.jsonOrgBroadcastData=function(){var b={broadcast:{message:a.broadcast.message,expireindays:a.broadcast.duration,broadcasttype:a.broadcast.type.name}};return JSON.stringify(b)},a.handleOrgBroadcastResponse=function(e){e.success?(g.debug("OrgBroadcast_"+e),a.clear(),d.transitionTo(d.current,c,{reload:!0,inherit:!1,notify:!0}),b.ProdoAppMessage(e.success.message,"success")):void 0!==e.error&&"AL001"===e.error.code?b.showModal():(g.debug(e.error.message),b.ProdoAppMessage(e.error.message,"error")),a.hideSpinner()},a.broadcastMessage=function(){a.form.orgMessageBroadcastform.$valid?(a.showSpinner(),a.form.orgMessageBroadcastform.submitted=!1,j.OrgMessagebroadcast(a.jsonOrgBroadcastData())):a.form.orgMessageBroadcastform.submitted=!0};{var m=a.$on("OrgBroadcastDone",function(b,c){a.handleOrgBroadcastResponse(c)});a.$on("OrgBroadcastNotDone",function(){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it","error")})}a.handleDeleteOrgBroadcastResponse=function(a){a.success?(g.debug("DeleteOrgBroadcast_"+a),b.ProdoAppMessage(a.success.message,"success"),d.transitionTo(d.current,c,{reload:!0,inherit:!1,notify:!0})):void 0!==a.error&&"AL001"===a.error.code?b.showModal():(g.debug(a.error.message),b.ProdoAppMessage(a.error.message,"error"))},a.deleteBroadcast=function(a){j.DeleteMessagebroadcast(a)};{var n=a.$on("DeleteOrgBroadcastDone",function(b,c){a.handleDeleteOrgBroadcastResponse(c)});a.$on("DeleteOrgBroadcastNotDone",function(){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it","error")})}a.$on("$destroy",function(){m(),m(),n(),n()})}]),angular.module("prodo.OrgApp").controller("OrgRegistrationController",["$scope","$rootScope","OrgModel","$state","$stateParams","$log","OrgRegistrationService","UserSessionService","industrycategorydataarray",function(a,b,c,d,e,f,g,h,i){a.errmessage="",a.mobileRegex="/^(?[+]([0-9]{2,5}))?[-]?([0-9]{10,15})$/",a.org=c,a.regexForEmail=/^[a-z][a-z0-9_\.\-]*@[a-z0-9\.\-]+\.[a-z]{2,4}$/i,a.$state=d,a.org={industries:[]},i.error?a.org.industries=["software"]:i.success&&(a.org.industries=0!==i.success.industry_category.length?i.success.industry_category:["software"]),a.$watch("$state.$current.locals.globals.industrycategorydataarray",function(b){b.error?a.org.industries=["software"]:b.success&&(a.org.industries=0!==b.success.industry_category.length?b.success.industry_category:["software"])}),a.industrycategories=function(){return a.org.industries},a.back=function(){$("#reg-companyDetails").css("color","#C9C9C9")},a.goToAddresss=function(){$("#reg-address").css("color","#C9C9C9")},a.goBackToInvites=function(){$("#reg-groupUsers").css("color","#C9C9C9")},a.countries=["Afghanistan","Albania","Algeria","American Samoa","Andorra","Angola","Anguilla","Antigua and Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia","Bosnia-Herzegovina","Botswana","Bouvet Island","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Cayman Islands","Central African Republic","Chad","Chile","China","Christmas Island","Cocos (Keeling) Islands","Colombia","Comoros","Congo, Democratic Republic of the (Zaire)","Congo, Republic of","Cook Islands","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Falkland Islands","Faroe Islands","Fiji","Finland","France","French Guiana","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guadeloupe (French)","Guam (USA)","Guatemala","Guinea","Guinea Bissau","Guyana","Haiti","Holy See","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Ivory Coast (Cote D`Ivoire)","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macau","Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Martinique (French)","Mauritania","Mauritius","Mayotte","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","Netherlands Antilles","New Caledonia (French)","New Zealand","Nicaragua","Niger","Nigeria","Niue","Norfolk Island","North Korea","Northern Mariana Islands","Norway","Oman","Pakistan","Palau","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Pitcairn Island","Poland","Polynesia (French)","Portugal","Puerto Rico","Qatar","Reunion","Romania","Russia","Rwanda","Saint Helena","Saint Kitts and Nevis","Saint Lucia","Saint Pierre and Miquelon","Saint Vincent and Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Georgia and South Sandwich Islands","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Svalbard and Jan Mayen Islands","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste (East Timor)","Togo","Tokelau","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Turks and Caicos Islands","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Virgin Islands","Wallis and Futuna Islands","Yemen","Zambia","Zimbabwe"],a.states={},a.states.india=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar ","Chhattisgarh ","Goa","Gujarat","Haryana","Himachal Pradesh","Jammu and Kashmir","Jharkhand","Kerala ","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Orissa ","Punjab","Rajasthan","Sikkim","Tamil Nadu","Tripura","Uttar Pradesh","Uttarakhand","West Bengal"],a.india={},a.india.major_cities=["Port Blair","Hyderabad","Itanagar","Dispur","Patna","Silvassa","Daman","Delhi","Gandhinagar","Chandigarh","Ranchi","Bengaluru","Thiruvananthapuram","Kavaratti","Bhopal","Imphal","Shillong","Aizwal","Kohima","Bhubaneshwar","Puducherry","Chandigarh","Jaipur","Agartala","Mumbai","Lucknow","Kolkata","Panaji","Pune"],a.selected_country="",a.errorOrgName="",a.errOrgDesc="",a.submitted=!1,a.optionErrorMessage="",a.errMessageNote="",a.errorMessageForInvalidcategory="",a.goToAddress=function(){a.errorOrgName="",a.errOrgDesc="",a.optionErrorMessage="",a.errMessageNote="",a.errorMessageForInvalidcategory="",a.OrgCompanyForm.$valid?void 0===a.org.industry||0===a.org.industry.length?a.errorMessageForInvalidcategory="Please enter valid industry category.":(a.errmessage="",$("#reg-companyDetails").css("color","#2EB373"),d.transitionTo("prodo.orgregistration.address")):(a.submitted=!0,(a.OrgCompanyForm.companyname.$valid===!1||""===a.org.name)&&(a.errorOrgName="Please enter valid company name"),(a.OrgCompanyForm.description.$valid===!1||""===a.org.description)&&(a.errOrgDesc="Please enter valid description",a.errMessageNote=" [ Number of characters should be more than 0 and less than 500 ]"),a.OrgCompanyForm.orgtype.$valid===!1&&(a.optionErrorMessage="Please select option from above list"),(void 0===a.org.industry||0===a.org.industry.length)&&(a.errorMessageForInvalidcategory="Please enter valid industry category."))},a.addressErrorMessage="",a.invalidCountryError="",a.invalidStateError="",a.invalidCityError="",a.invalidZipcodeError="",a.invalidContact1="",a.invalidContact2="",a.invalidContact3="",a.goToGroupuser=function(){a.addressErrorMessage="",a.invalidCountryError="",a.invalidStateError="",a.invalidCityError="",a.invalidZipcodeError="",a.invalidContact1="",a.invalidContact2="",a.invalidContact3="",a.OrgAddressForm.$valid?(a.errmessage="",$("#reg-address").css("color","#2EB373"),d.transitionTo("prodo.orgregistration.groupuser")):((""===a.org.address1||a.OrgAddressForm.address1.$valid===!1)&&(a.addressErrorMessage="Please enter valid address "),(a.OrgAddressForm.country.$valid===!1||""===a.org.country)&&(a.invalidCountryError="Please enter valid country"),(a.OrgAddressForm.state.$valid===!1||""===a.org.country)&&(a.invalidStateError="Please enter valid state"),(a.OrgAddressForm.city.$valid===!1||""===a.org.city)&&(a.invalidCityError="Please enter valid city"),(a.OrgAddressForm.zipcode.$valid===!1||""===a.org.zipcode)&&(a.invalidZipcodeError="Please enter valid Zipcode"),a.OrgAddressForm.contact1.$valid===!1&&(a.invalidContact1="Please enter valid phone number"),a.OrgAddressForm.contact2.$valid===!1&&(a.invalidContact2="Please enter valid phone number"),a.OrgAddressForm.contact3.$valid===!1&&(a.invalidContact3="Please enter valid phone number"),a.submitted=!0)},a.emailErrorMessage="",a.nameErrorMessage="",a.goToState=function(){a.emailErrorMessage="",a.nameErrorMessage="";var b=1;if(""!==a.org.grpname||""!==a.org.invites){""!==a.org.invites&&""===a.org.grpname&&(a.nameErrorMessage="Groupname cant be empty",b=0),a.newInvitesValidate="";var c=a.org.invites;if(void 0!==c&&""!==c)for(var e=c.split(","),f=0;f<e.length;f++)""!==e[f]&&a.regexForEmail.test(e[f])===!1&&(a.newInvitesValidate=a.newInvitesValidate+"'"+e[f]+"' ");""!==a.org.grpname&&""===a.org.invites&&(a.emailErrorMessage="Please enter emails separated by comma (,) in above field ",b=0),""!==a.newInvitesValidate&&(a.emailErrorMessage="Please verify email ids from above field for its format",b=0)}(""===a.org.grpname&&""===a.org.invites||1===b)&&(a.errmessage="",$("#reg-groupUsers").css("color","#2EB373"),d.transitionTo("prodo.orgregistration.terms"))},a.goToSummary=function(){a.org.terms&&($("#reg-terms").css("color","#2EB373"),d.transitionTo("prodo.orgregistration.finish"))},a.return_states=function(){return"India"===a.org.country?a.states.india:""},a.return_cities=function(){return"India"===a.org.country?a.india.major_cities:""},a.clearOrgData=function(){a.org.name="",a.org.description="",a.org.orgtype="",a.org.industry=[],a.org.contractid="",a.org.address1="",a.org.address2="",a.org.address3="",a.org.country="",a.org.city="",a.org.state="",a.org.zipcode="",a.org.contact.customerhelpline1="",a.org.contact.customerhelpline2="",a.org.contact.customerhelpline3="",a.org.contact.customerhelpline4="",a.org.grpname="",a.org.invites=""},a.handleOrgResponse=function(c){c.success?(f.debug(c.success),b.usersession.checkUser()):(void 0!==c.error&&"AL001"===c.error.code?(f.debug(c.error.code+""+c.error.message),b.showModal()):(f.debug(c.error),b.ProdoAppMessage(c.error.message,"error")),a.hideSpinner())};var j=b.$on("session",function(c,e){if(f.debug(e),b.usersession.isLoggedIn&&"business"==e.prodousertype&&e.hasDonePayment){if(null==e.products_followed&&void 0==e.products_followed)f.debug("There is some problem with the database. Please contact support.");else if(e.products_followed.length>0){var g=e.products_followed.length-1;console.log(g),b.orgid=e.products_followed[g].orgid,b.product_prodle=e.products_followed[g].prodle,console.log("in org registration controller");for(var i=0;i<e.products_followed.length;i++){if(e.products_followed[i]&&e.products_followed[i].prodle)var j=e.products_followed[i].prodle;a.prodlesfollowed.push(j)}h.getProductFollowed(a.prodlesfollowed)}b.orgid=e.org.orgid,d.transitionTo("prodo.productwall.wall-org")}a.hideSpinner()});a.org.orgaddresstype="Company Address",a.jsonOrgData=function(){var b={organization:{name:a.org.name,description:a.org.description,orgtype:a.org.orgtype,industry_category:a.org.industry,contractid:a.org.contractid,location:[{locationtype:a.org.orgaddresstype,address:{address1:a.org.address1,address2:a.org.address2,address3:a.org.address3,country:a.org.country,city:a.org.city,state:a.org.state,zipcode:a.org.zipcode},contacts:[{customerhelpline:a.org.contact.customerhelpline1},{customerhelpline:a.org.contact.customerhelpline2},{customerhelpline:a.org.contact.customerhelpline3}]}],usergrp:[{grpname:a.org.grpname,invites:a.org.invites}],terms:a.org.terms}};return JSON.stringify(b)},a.resetCheckBox=function(){$("#reg-companyDetails").css("color","#C9C9C9"),$("#reg-address").css("color","#C9C9C9"),$("#reg-groupUsers").css("color","#C9C9C9"),$("#reg-terms").css("color","#C9C9C9")},a.registerOrg=function(){$("#reg-finish").css("color","#2EB373"),a.showSpinner(),g.RegisterOrg(a.jsonOrgData())};var k=a.$on("orgRegistrationDone",function(b,c){a.handleOrgResponse(c)}),l=a.$on("orgRegistrationNotDone",function(a,c){b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c,"error")});a.$on("$destroy",function(){j(),k(),l()})}]),angular.module("prodo.OrgApp").factory("OrgModel",function(){return{name:"",orgtype:"",description:"",industry:[],contractid:"",orginvites:[],subscription:[],grpname:"",invites:"",grpmembers:[],orgaddresstype:"",address1:"",address2:"",address3:"",country:"",city:"",state:"",zipcode:"",timezone:"",region:"",geo:{latitude:2,longitude:1},contacts:[{customerhelpline:""},{customerhelpline:""},{customerhelpline:""}],terms:""}}).factory("OrgService",["$resource",function(a){var b={org_data:a("/api/organization/:orgid",{},{getOrgSettings:{method:"GET"}}),all_org_data:a("/api/organalytics",{},{getAllOrgAnalytics:{method:"GET"}}),ManageOrgLocation:a("/api/orgaddress/:orgid/:orgaddressid",{},{getAllOrgAddress:{method:"GET"}}),GetOrgProducts:a("/api/product/:orgid",{},{getAllOrgProducts:{method:"GET"}}),GetOrgGroupMembers:a("/api/orggroupmembers/:orgid",{},{getGroupDetails:{method:"GET"}}),GetOrg_Broadcast_Messages:a("/api/organization/broadcast/:orgid",{},{getOrgBroadcastMessage:{method:"GET"}}),GetOrg_Industry_Category:a("/api/orgindustrycategory",{},{getAllIndustryCategory:{method:"GET"}})};return b}]).factory("OrgRegistrationService",["$rootScope","$resource","$log","$state",function(a,b,c){var d={OrgRegistration:b("/api/organization/:orgid",{},{getAllOrgs:{method:"GET",isArray:!0},getOrgSettings:{method:"GET",params:{orgid:"@orgid"}},saveOrg:{method:"POST"},updateOrgSettings:{method:"PUT",params:{orgid:"@orgid"},isArray:!1}}),OrgDeleteRequest:b("/api/orgdeleterequest/:orgid",{},{sendDeleteRequest:{method:"POST",params:{orgid:"@orgid"}}}),ManageOrgLocation:b("/api/orgaddress/:orgid/:orgaddressid",{},{getAllOrgAddress:{method:"GET",params:{orgid:"@orgid"}},addOrgAddress:{method:"POST",params:{orgid:"@orgid"}},updateOrgAddress:{method:"PUT",params:{orgid:"@orgid",orgaddressid:"@orgaddressid"},isArray:!1},deleteOrgAddressById:{method:"DELETE",params:{orgid:"@orgid",orgaddressid:"@orgaddressid"}}}),sendOrg_Broadcast_Messages:b("/api/organization/broadcast/:orgid",{},{sendOrgBroadcastMessage:{method:"POST",params:{orgid:"@orgid"}}}),deleteOrg_Broadcast_Messages:b("/api/organization/broadcast/:orgid/:broadcastid",{},{deleteOrgBroadcastMessage:{method:"Delete",params:{orgid:"@orgid",broadcastid:"@broadcastid"}}}),OtherOrgInvites:b("/api/otherorginvite/:orgid",{},{sendOtherOrgInvites:{method:"POST",params:{orgid:"@orgid"}}}),OrgCustomerInvites:b("/api/orgcustomerinvite/:orgid",{},{sendOrgCustomerInvites:{method:"POST",params:{orgid:"@orgid"}}}),OrgGroupInvites:b("/api/orginvite/:orgid",{},{sendGroupInvites:{method:"POST",params:{orgid:"@orgid"}}}),GetOrgGroupMembers:b("/api/orggroupmembers/:orgid",{},{getGroupDetails:{method:"GET",params:{orgid:"@orgid"}}}),RemoveOrgGroupMember:b("/api/orggroupmember/:orgid/:grpid/:userid",{},{deleteGrpMember:{method:"DELETE",params:{orgid:"@orgid",grpid:"@grpid",userid:"@userid"}}}),GetOrgProducts:b("/api/product/:orgid",{},{getAllOrgProducts:{method:"GET",params:{orgid:"@orgid"}}}),SingleOrgImageDelete:b("/api/image/org/:orgid?orgimageids=:data",{},{deleteOrgImage:{method:"DELETE",params:{orgid:"@orgid",data:"@data"}}}),KeyClientsDelete:b("/api/keyclient/org/:orgid?orgkeyclientids=:data",{},{clientDeleteRequest:{method:"DELETE",params:{orgid:"@orgid",data:"@data"}}})},e={};return e.deleteMember=function(b,e){d.RemoveOrgGroupMember.deleteGrpMember({orgid:a.usersession.currentUser.org.orgid,grpid:b,userid:e},function(b){c.debug(b),a.$broadcast("deleteOrgGroupMemberDone",b)},function(b){c.debug(b),a.$broadcast("deleteOrgGroupMemberNotDone",b.status)})},e.RegisterOrg=function(b){d.OrgRegistration.saveOrg(b,function(b){c.debug(b),a.$broadcast("orgRegistrationDone",b)},function(b){c.debug(b),a.$broadcast("orgRegistrationNotDone",b.status)})},e.saveOrgSettings=function(b){d.OrgRegistration.updateOrgSettings({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("updateOrgDone",b)},function(b){c.debug(b),a.$broadcast("updateOrgNotDone",b.status)})},e.DeleteMessagebroadcast=function(b){d.deleteOrg_Broadcast_Messages.deleteOrgBroadcastMessage({orgid:a.usersession.currentUser.org.orgid,broadcastid:b},function(b){c.debug(b),a.$broadcast("DeleteOrgBroadcastDone",b)},function(b){c.debug(b),a.$broadcast("DeleteOrgBroadcastNotDone",b.status)})},e.OrgMessagebroadcast=function(b){d.sendOrg_Broadcast_Messages.sendOrgBroadcastMessage({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("OrgBroadcastDone",b)},function(b){c.debug(b),a.$broadcast("OrgBroadcastNotDone",b.status)})},e.saveOrgAddress=function(b){d.ManageOrgLocation.addOrgAddress({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("addOrgAddressDone",b)},function(b){c.debug(b),a.$broadcast("addOrgAddressNotDone",b.status)})},e.updateOrgAddress=function(b,e){d.ManageOrgLocation.updateOrgAddress({orgid:a.usersession.currentUser.org.orgid,orgaddressid:e},b,function(b){c.debug(b),a.$broadcast("updateOrgAddressDone",b)},function(b){c.debug(b),a.$broadcast("updateOrgAddressNotDone",b.status)})},e.removeOrgAddress=function(b){d.ManageOrgLocation.deleteOrgAddressById({orgid:a.usersession.currentUser.org.orgid,orgaddressid:b},function(b){c.debug(b),a.$broadcast("deleteOrgAddressDone",b)},function(b){c.debug(b),a.$broadcast("deleteOrgAddressNotDone",b.status)})},e.removeOrgSettings=function(){d.OrgDeleteRequest.sendDeleteRequest({orgid:a.usersession.currentUser.org.orgid},function(b){c.debug(b),a.$broadcast("deleteOrgRequestSent",b)},function(b){c.debug(b),a.$broadcast("deleteOrgRequestNotSent",b.status)})},e.singleOrgImageDelete=function(b){d.SingleOrgImageDelete.deleteOrgImage({orgid:a.usersession.currentUser.org.orgid,data:b},function(b){c.debug(b),a.$broadcast("orgImageDeleted",b)},function(b){c.debug(b),a.$broadcast("orgImageDeleteNotDone",b)})},e.keyClientDelete=function(b){d.KeyClientsDelete.clientDeleteRequest({orgid:a.usersession.currentUser.org.orgid,data:b},function(b){c.debug(b),a.$broadcast("clientsDeletesSuccessfully",b)},function(b){c.debug(b),a.$broadcast("clientsNotDeletedSuccessfully",b)})},e.updateOrgData=function(a){e.currentOrgData=a},e.updateOrgAdd=function(b){e.currentOrgAdd=b,a.$broadcast("getOrgAddData",b)},e.sendInvites=function(b){d.OtherOrgInvites.sendOtherOrgInvites({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("sendOrgInvitesDone",b)},function(b){c.debug(b),a.$broadcast("sendOrgInvitesNotDone",b.status)})},e.sendCustomerInvites=function(b){d.OrgCustomerInvites.sendOrgCustomerInvites({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("sendOrgCustomerInvitesDone",b)},function(b){c.debug(b),a.$broadcast("sendOrgCustomerInvitesNotDone",b.status)})},e.groupInvites=function(b){d.OrgGroupInvites.sendGroupInvites({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("sendOrgGroupInvitesDone",b)},function(b){c.debug(b),a.$broadcast("sendOrgGroupInvitesNotDone",b.status)})},e}]),angular.module("prodo.ProdoWallApp").controller("ProdoDashboardController",["$scope","$rootScope","$state","prodoDashboardService","pieChartProdle","trendingChartContent",function(a,b,c,d,e){a.data=[],a.showPieChart=0,a.showBarChart=0,a.showTrendingChart=0,a.commentTrending=[],a.commentObjectStructure={x:"",y:""},a.commentContent={key:"Comments",color:"#ccf",values:[]},a.talkinsContent={key:"Talkins",color:"#333",values:[]},a.showSampleDataFordualstack=1,a.commentData=[],a.talkinData=[],a.allTrendingContent=[],a.sampleData=[],a.sampleData=[{key:"Comments",bar:!0,color:"#ccf",values:[[13357584e5,514733],[13331664e5,514733],[13304916e5,690033],[1327986e6,690033],[13253076e5,690033],[13226292e5,475e3],[13200336e5,475e3],[13173552e5,475e3],[13147632e5,1244525],[13120848e5,1194025],[13094064e5,1194025],[13068144e5,1194025],[1304136e6,1194025],[1301544e6,1194025],[12988692e5,1154695],[129645e7,1154695],[12937716e5,1331875],[12910932e5,1331875],[12884976e5,1331875],[12858192e5,1331875],[12832272e5,1309915],[12805488e5,1309915],[12778704e5,1309915],[12752784e5,1543784],[12726e8,1543784],[1270008e6,1543784],[12673332e5,1591444],[1264914e6,1591444],[12622356e5,1591444],[12595572e5,1519010],[12569616e5,1519010],[12542832e5,1519010],[12516912e5,1743470],[12490128e5,1743470],[12463344e5,1743470],[12437424e5,1756311],[1241064e6,1756311],[1238472e6,1756311],[12357972e5,1924387],[1233378e6,1924387],[12306996e5,1924387],[12280212e5,2599196],[12254256e5,2599196],[12227472e5,2599196],[12201552e5,2732646],[12174768e5,2732646],[12147984e5,2732646],[12122064e5,2287726],[1209528e6,2287726],[1206936e6,2287726],[12042612e5,2206761],[12017556e5,2206761],[11990772e5,2206761],[11963988e5,2906501],[11938032e5,2906501],[11911248e5,2906501],[11885328e5,2522993],[11858544e5,2522993],[1183176e6,2522993],[1180584e6,2648493]]},{key:"Talkins",color:"#333",values:[[11360052e5,71.89],[11386836e5,75.51],[11411028e5,68.49],[11437812e5,62.72],[11463696e5,70.39],[1149048e6,59.77],[115164e7,57.27],[11543184e5,67.96],[11569968e5,67.85],[11595888e5,76.98],[11622708e5,81.08],[11648628e5,91.66],[11675412e5,84.84],[11702196e5,85.73],[11726388e5,84.61],[11753136e5,92.91],[11779056e5,99.8],[1180584e6,121.191],[1183176e6,122.04],[11858544e5,131.76],[11885328e5,138.48],[11911248e5,153.47],[11938032e5,189.95],[11963988e5,182.22],[11990772e5,198.08],[12017556e5,135.36],[12042612e5,125.02],[1206936e6,143.5],[1209528e6,173.95],[12122064e5,188.75],[12147984e5,167.44],[12174768e5,158.95],[12201552e5,169.53],[12227472e5,113.66],[12254256e5,107.59],[12280212e5,92.67],[12306996e5,85.35],[1233378e6,90.13],[12357972e5,89.31],[1238472e6,105.12],[1241064e6,125.83],[12437424e5,135.81],[12463344e5,142.43],[12490128e5,163.39],[12516912e5,168.21],[12542832e5,185.35],[12569616e5,188.5],[12595572e5,199.91],[12622356e5,210.732],[1264914e6,192.063],[12673332e5,204.62],[1270008e6,235],[12726e8,261.09],[12752784e5,256.88],[12778704e5,251.53],[12805488e5,257.25],[12832272e5,243.1],[12858192e5,283.75],[12884976e5,300.98],[12910932e5,311.15]]}],a.barChart=function(){return[{key:"Product Ratings",values:[]}]},a.trending=[],void 0!==e&&(void 0!==e.error&&"AL001"===e.error.code?b.showModal():e.error||(a.data=e.success.piechart_analytics,a.showPieChart=1,a.dataForBarChart=e.success.barchart_analytics,a.barChart=function(){return[{key:"Product Ratings",values:a.dataForBarChart}]},a.showBarChart=1)),void 0===e&&b.ProdoAppMessage("There is some issue with the server! Please try again after some time","error")}]),angular.module("prodo.ProdoWallApp").factory("prodoDashboardService",["$rootScope","$resource","$log","$state",function(a,b){var c={Product:b("/api/featureanalytics/:prodle",{},{prodlePieChart:{method:"GET",params:{prodle:"@prodle"}}}),Trending:b("/api/trendingchart/:prodle",{},{getTrendingChart:{method:"GET",params:{prodle:"@prodle"}}})};return c}]),angular.module("prodo.CampaignApp").factory("CampaignService",["$rootScope","$resource","$log",function(a,b,c){var d={Product:b("/api/productcampaign/:orgid/:prodle",{},{addCampaignContent:{method:"POST",params:{orgid:"@orgid",prodle:"@prodle"}}})},e={Product:b("/api/productcampaign/:campaign_id",{},{deleteCampaign:{method:"DELETE",params:{campaign_id:"@campaign_id"}}})},f={Product:b("/api/productcampaign/:orgid/:campaign_id",{},{modifySelectedCampaign:{method:"PUT",params:{orgid:"@orgid",campaign_id:"@campaign_id"}}})},g={Product:b("/api/productcampaign/image/:orgid/:campaign_id?camimageids=:data",{},{deleteCampaignImage:{method:"DELETE",params:{orgid:"@orgid",campaign_id:"@campaign_id",data:"@data"}}})},h={Product:b("/api/campaignpublish/:orgid/:campaign_id",{},{publishCampaignContent:{method:"POST",params:{orgid:"@orgid",campaign_id:"@campaign_id"}}})},i={};return i.createCampaign=function(b,e){d.Product.addCampaignContent({orgid:a.usersession.currentUser.org.orgid,prodle:e},{campaigndata:b},function(b){c.debug(b),a.$broadcast("campaignAddedSuccessfully",b)}),function(b){c.debug(b),a.$broadcast("campaignNotAddedSuccessfully",b)}},i.updateCampaign=function(b,d){f.Product.modifySelectedCampaign({orgid:a.usersession.currentUser.org.orgid,campaign_id:d},b,function(b){c.debug(b),a.$broadcast("campaignUpdatedSuccessfully",b)}),function(b){c.debug(b),a.$broadcast("campaignNotUpdatedSuccessfully",b)}},i.deleteTheCampaign=function(b){e.Product.deleteCampaign({campaign_id:b},function(b){c.debug(b),a.$broadcast("campaignDeletedSuccessfullt",b)}),function(b){c.debug(b),a.$broadcast("campaignNotDeleteSuccessfully",b)}},i.deleteCampaignArtwork=function(b,d){g.Product.deleteCampaignImage({orgid:a.usersession.currentUser.org.orgid,campaign_id:b,data:d},function(b){c.debug(b),a.$broadcast("campaignImagesDeletedSuccessfully",b)}),function(b){c.debug(b),a.$broadcast("campaignImagesNotDeletedSuccessfully",b)}},i.publishCampaignNow=function(b){h.Product.publishCampaignContent({orgid:a.usersession.currentUser.org.orgid,campaign_id:b},function(b){c.debug(b),a.$broadcast("campaignPublishedSuccessfully",b)}),function(b){c.debug(b),a.$broadcast("campaignNotPublishedSuccessfully",b)}},i}]).factory("getAllCampaigns",["$rootScope","$resource","$log",function(a,b){var c={Product:b("/api/orgcampaign/:orgid",{},{getCampaignDetails:{method:"GET",params:{orgid:"@orgid"}}})};return c}]).factory("CampaignWallService",["$resource",function(a){var b={get_All_ProductCampaigns:a("/api/productcampaign/:prodle",{},{getAllProductCampaigns:{method:"GET"}}),get_ProductCampaign:a("/api/productcampaign/:prodle/:campaign_id",{},{getProductCampaign:{method:"GET"}}),follow:a("/api/campaign/follow/:campaign_id",{},{followCampaign:{method:"POST",params:{campaign_id:"@campaign_id"}}})};return b}]).factory("CampaignCommentService",["$resource",function(a){return a("/api/campaigncomment/:commentid",{},{deleteComment:{method:"DELETE",params:{commentid:"id"}}})}]).factory("CampaignCommentLoadMoreService",["$resource",function(a){return a("/api/campaign/nextcomments/:commentid",{},{loadMoreComments:{method:"GET",params:{commentid:"id"}}})}]),angular.module("prodo.CampaignApp").controller("ManageCampaignController",["$scope","$rootScope","$state","$http","$timeout","$stateParams","$log","growl","checkIfSessionExist","currentorgproducts","CampaignService","getAllCampaigns","campaigndata","fileReader","ENV","isLoggedin",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(a.productlist={},a.form={},a.targettedAudience=[],a.regexForText=/^[a-zA-Z\s]*$/,a.regexForNumbers=/[0-9]/,a.regexForEmail=/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/,a.regexForPhno=/^\(?[+]([0-9]{2,5})\)?[-]?([0-9]{10,15})$/,a.errorForWrongCampaignname="",a.errorForCampaignStart="",a.errorForInvalidEnddate="",a.invalidDesc="",a.showCampaign=1,a.$state=c,a.addNewCampaign=0,a.campaign={productName:"",Name:"",Description:"",startDate:"",endDate:"",category:[],campaignBannerText:"",campaignTags:[],prodle:""},a.errorForInvalidProduct="",a.campaignDetailsObject=[],a.campaignName="",a.startDate="",a.category=[],a.radiovalue=0,a.endDate="",a.productlist=[],a.prodleContent="wrong",a.addJSON={campaigndata:{name:"",productname:"",category:[],description:"",startdate:"",enddate:""}},a.enableEditing=0,a.currentCampaign={},a.today=moment().format("YYYY-MM-DD"),a.errorForEmptyCampaigntags="",a.currentPage=0,a.pageSize=3,a.numberOfPages=function(){return Math.ceil(a.campaignDetailsObject.length/a.pageSize)
},a.errorForEmptyCategoryModify="",a.fileLength,a.uploadSrc,a.counter=0,a.file,a.file_data={filetype:"",filename:"",filebuffer:""},a.action={},a.isValidImage=!1,a.invoiceimage,a.newCampaignAdd=0,a.open=function(b,c){b.preventDefault(),b.stopPropagation(),a[c]=!0},a.restrictEndDate=a.today,a.noCampaignExists=1,a.campaignExpired=0,a.errorForEmptyCategory="",a.showBanner=4,a.prodlesOfOrg=[],a.errorForImproperBanner="",j.error);else for(var q=0;q<j.success.product.length;q++)a.productlist.push(j.success.product[q].name),a.prodlesOfOrg.push(j.success.product[q].prodle);var r=a.$on("campaignPublishedSuccessfully",function(a,d){void 0!==d.error&&"AL001"===d.error.code&&b.showModal(),d.success?(b.ProdoAppMessage(d.success.message,"success"),c.reload()):"AU004"==d.error.code?b.ProdoAppMessage(d.error.message,"error"):b.ProdoAppMessage(d.error.message,"error")}),s=a.$on("campaignNotPublishedSuccessfully",function(){b.ProdoAppMessage("Some issues with server","error")});a.$watch("$state.$current.locals.globals.campaigndata",function(c){if(c.success){if(a.campaignDetailsObject=c.success.Product_Campaigns,void 0!==a.currentCampaignContentId&&""!==a.currentCampaignContentId)for(var d=0;d<a.campaignDetailsObject.length;d++)a.campaignDetailsObject[d].campaign_id===a.currentCampaignContentId&&(a.currentCampaign=a.campaignDetailsObject[d]);else a.currentCampaign=a.campaignDetailsObject[0];var e=moment.utc(moment(a.currentCampaign.enddate)),f=moment.utc(moment());e.diff(f,"days")<0&&(a.campaignExpired=1)}else void 0!==c.error&&"AL001"===c.error.code?b.showModal():c.error&&(a.noCampaignExists=0);b.campaign_id=a.currentCampaign.campaign_id,b.campaign_prodle=a.currentCampaign.prodle}),a.currentCampaignContentId="",a.jsonOrgCampaignData=function(){1===a.showBanner&&(a.campaign.campaignBannerText=void 0);var b={name:a.campaign.Name,productname:a.campaign.productName,enddate:a.campaign.endDate,startdate:a.campaign.startDate,description:a.campaign.Description,category:a.campaign.category,bannertext:a.campaign.campaignBannerText,campaign_tags:a.campaign.campaignTags};return b},a.saveCampaign=function(){a.errorForWrongCampaignname="",a.errorForCampaignStart="",a.errorForInvalidEnddate="",a.invalidDesc="",a.errorForInvalidProduct="",a.allValid=0,a.errorForInvalidProduct="",a.errorForEmptyCategory="",a.errorForEmptyCampaigntags="",a.errorForImproperBanner="",a.getProdle(),(void 0===a.campaign.Name||a.regexForText.test(a.campaign.Name)===!1||""===a.campaign.Name)&&(a.errorForWrongCampaignname="Please enter valid campaign name!",a.allValid=1),a.form.campaign.startDate.$dirty===!1&&(a.errorForCampaignStart="Please select valid start date!",a.allValid=1),a.form.campaign.endDates.$dirty===!1&&(a.errorForInvalidEnddate="Please select valid end date!",a.allValid=1),(void 0===a.campaign.Description||""===a.campaign.Description)&&(a.invalidDesc="Please enter valid description",a.allValid=1),(void 0===a.campaign.productName||""===a.campaign.productName)&&(a.errorForInvalidProduct="Please select valid product name !",a.allValid=1),(void 0===a.campaign.category||0===a.campaign.category.length)&&(a.errorForEmptyCategory="Please enter atleast one targeted audience category",a.allValid=1),(void 0===a.campaign.campaignTags||0===a.campaign.campaignTags.length)&&(a.errorForEmptyCampaigntags="Please enter valid campaign tags",a.allValid=1),1!==a.showBanner&&2!==a.showBanner&&(a.errorForImproperBanner="Please select atleast one option from above selection",a.allValid=1),2!==a.showBanner||void 0!==a.campaign.campaignBannerText&&""!==a.campaign.campaignBannerText||(a.errorForImproperBanner="Please enter valid banner text",a.allValid=1),a.assignProdleForCampaign(a.campaign.productName),0===a.allValid&&(1==a.isValidImage&&1===a.showBanner?a.socket.emit("addProductCampaign",b.usersession.currentUser.userid,b.usersession.currentUser.org.orgid,a.prodleContent,a.jsonOrgCampaignData(),a.file_data):2===a.showBanner?k.createCampaign(a.jsonOrgCampaignData(),a.campaign.prodle):a.isValidImage===!1&&1===a.showBanner&&b.ProdoAppMessage("Please select banner image to upload","error"))},a.restrictEndDates=function(){a.restrictEndDate=a.campaign.startDate},a.jsonOrgCampaignDataModify=function(){(void 0===a.currentCampaign.bannertext||""===a.currentCampaign.bannertext)&&(a.currentCampaign.bannertext="");var b={campaigndata:{name:a.currentCampaign.name,productname:a.currentCampaign.productname,enddate:a.currentCampaign.enddate,startdate:a.currentCampaign.startdate,description:a.currentCampaign.description,category:a.currentCampaign.category,bannertext:a.currentCampaign.bannertext}};return JSON.stringify(b)},a.errorForEmptyCategoryCampaignTags="",a.errorForEmptyBannerText="",a.updateCampaign=function(){a.errorForWrongCampaignname="",a.errorForCampaignStart="",a.errorForInvalidEnddate="",a.invalidDesc="",a.errorForInvalidProduct="",a.allValidContent=0,a.errorForInvalidProduct="",a.errorForEmptyCategoryModify="",a.errorForEmptyBannerText="",a.errorForEmptyCategoryCampaignTags="",a.getProdle(),(void 0===a.currentCampaign.productname||""===a.currentCampaign.productname)&&(a.errorForInvalidProduct="Please select valid product name !",a.allValidContent=1),(void 0===a.currentCampaign.description||""===a.currentCampaign.description)&&(a.invalidDesc="Please enter valid description",a.allValidContent=1),(void 0===a.currentCampaign.name||""===a.currentCampaign.name)&&(a.errorForWrongCampaignname="Please enter valid campaign name!",a.allValidContent=1),(void 0===a.currentCampaign.category||0===a.currentCampaign.category.length)&&(a.errorForEmptyCategoryModify="Please enter atleast one targeted audience category",a.allValidContent=1),0===a.currentCampaign.campaign_tags.length&&(a.errorForEmptyCategoryCampaignTags="Please enter valid campaign tags",a.allValidContent=1),0===a.allValidContent&&k.updateCampaign(a.jsonOrgCampaignDataModify(),a.currentCampaign.campaign_id)},a.deleteTheCampaign=function(a){k.deleteTheCampaign(a)};var t=a.$on("campaignUpdatedSuccessfully",function(d,e){void 0!==e.error&&"AL001"===e.error.code&&b.showModal(),e.success?(b.ProdoAppMessage(e.success.message,"success"),a.enableEditing=0):"AU004"==e.error.code?(b.ProdoAppMessage(e.error.message,"error"),c.reload()):(b.ProdoAppMessage(e.error.message,"error"),c.reload())}),u=a.$on("campaignNotUpdatedSuccessfully",function(){b.ProdoAppMessage("Some issues with server","error")}),v=a.$on("campaignDeletedSuccessfullt",function(a,d){void 0!==d.error&&"AL001"===d.error.code&&b.showModal(),d.success?(b.ProdoAppMessage(d.success.message,"success"),c.transitionTo(c.current,f,{reload:!0,inherit:!1,notify:!0})):"AU004"==d.error.code?b.ProdoAppMessage(d.error.message,"error"):b.ProdoAppMessage(d.error.message,"error")}),w=a.$on("campaignNotDeleteSuccessfully",function(){b.ProdoAppMessage("Some issues with server","error")});a.showDetails=function(c){for(var d=0;d<a.campaignDetailsObject.length;d++)c===a.campaignDetailsObject[d].name&&(a.currentCampaign=a.campaignDetailsObject[d],a.currentCampaignContentId=a.currentCampaign.campaign_id);b.campaign_id=a.currentCampaign.campaign_id,b.campaign_prodle=a.currentCampaign.prodle,a.enableEditing=0,a.addNewCampaign=0,a.campaignExpired=0;var e=moment.utc(moment(a.currentCampaign.enddate)),f=moment.utc(moment());e.diff(f,"days")<0&&(a.campaignExpired=1)},a.add=function(){a.addNewCampaign=1,a.campaign={productName:"",Name:"",Description:"",startDate:"",endDate:"",category:[],campaignBannerText:"",campaignTags:[],prodle:""}},a.cancel=function(){a.addNewCampaign=0,a.addNewCampaign=0,c.transitionTo(c.current,f,{reload:!0,inherit:!1,notify:!0}),a.campaign={productName:"",Name:"",Description:"",startDate:"",endDate:"",category:[],campaignBannerText:"",campaignTags:[],prodle:""}},a.getProdle=function(){if(j.success)for(var b=0;b<j.success.product.length;b++)a.campaign.productName===j.success.product[b].name&&(a.prodleContent=j.success.product[b].prodle)},a.disableEditingCampaign=function(){a.enableEditing=0,a.addNewCampaign=0,c.transitionTo(c.current,f,{reload:!0,inherit:!1,notify:!0})},a.enableEditingCampaign=function(){a.enableEditing=1};var x=a.$on("campaignAddedSuccessfully",function(d,e){void 0!==e.error&&"AL001"===e.error.code&&b.showModal(),e.success?(b.ProdoAppMessage(e.success.message,"success"),a.enableEditing=0,c.transitionTo(c.current,f,{reload:!0,inherit:!1,notify:!0})):"AU004"==e.error.code?b.ProdoAppMessage(e.error.message,"error"):"AP001"===e.error.code?(b.ProdoAppMessage(e.error.message,"error"),a.campaign.productName=""):b.ProdoAppMessage(e.error.message,"error")}),y=a.$on("campaignNotAddedSuccessfully",function(){b.ProdoAppMessage("Some issues with server","error")}),z=a.$on("campaignUploadResponseSuccess",function(){c.reload()});a.deleteCampaignImages=function(){a.imageids=[];for(var b=0;b<a.currentCampaign.artwork.length;b++)document.getElementById(b).checked===!0&&a.imageids.push(a.currentCampaign.artwork[b].imageid);0!==a.imageids.length&&k.deleteCampaignArtwork(a.currentCampaign.campaign_id,a.imageids)};var A=a.$on("campaignImagesDeletedSuccessfully",function(d,e){void 0!==e.error&&"AL001"===e.error.code&&b.showModal(),e.success?(b.ProdoAppMessage(e.success.message,"success"),c.reload(),a.enableEditing=1):"AU004"==e.error.code?b.ProdoAppMessage(e.error.message,"error"):b.ProdoAppMessage(e.error.message,"error")}),B=a.$on("campaignImagesNotDeletedSuccessfully",function(){b.ProdoAppMessage("Some issues with server","error")}),C=a.$on("campaignBannerUploadResponseSuccess",function(){c.reload()});a.publishCampaign=function(){k.publishCampaignNow(a.currentCampaign.campaign_id)},a.socket=io.connect(o.apiEndpoint+o.port+"/api/prodoupload",{query:"session_id="+b.usersession.currentUser.sessionid}),a.handleUploadError=function(a){$("#bar").hide(),"AL001"==a.code?b.showModal():(g.debug(a),b.showModal())},a.getFile=function(c){p.checkUserSession(function(d){void 0==d.success?d.error&&a.handleUploadError(d.error):n.readAsBinaryString(c,a).then(function(d){a.imageBfr=d,a.file=c,a.file_data={filetype:a.file.type,filename:a.file.name,filebuffer:a.imageBfr},"image/jpg"==a.file.type||"image/png"==a.file.type||"image/gif"==a.file.type||"image/jpeg"==a.file.type?a.file.size/1024<2048?a.isValidImage=!0:(b.ProdoAppMessage("Image size must ne less than 2MB","error"),$("#addCampaignForm")[0].reset()):b.ProdoAppMessage("Please upload image only","error")})})},a.socket.removeAllListeners("addProductCampaignResponse"),a.socket.on("addProductCampaignResponse",function(b,c){a.addProductCampaignResponseHandler(b,c)}),a.addProductCampaignResponseHandler=function(d,e){d?"AP003"==d.error.code?(g.debug(d.error.code+" "+d.error.message),b.ProdoAppMessage(d.error.message,"error")):"AV001"==d.error.code?(a.ProdoAppMessage(d.error.message,"error"),g.debug("response from server")):(b.ProdoAppMessage(d.error.message,"error"),"AP001"===d.error.code?a.campaign.productName="":a.campaign={productName:"",Name:"",Description:"",startDate:"",endDate:"",category:[],campaignBannerText:"",campaignTags:[],prodle:""}):(a.imageSrc=JSON.stringify(e.success.invoiceimage),b.$broadcast("campaignUploadResponseSuccess","success"),b.ProdoAppMessage("Campaign added successfully","success"),c.enableEditing=0,c.transitionTo(c.current,f,{reload:!0,inherit:!1,notify:!0}),a.counter++,a.counter<a.fileLength||(a.counter=0))},a.assignProdleForCampaign=function(b){for(var c=0;c<j.success.product.length;c++){if(b===j.success.product[c].name){a.campaign.prodle=j.success.product[c].prodle;break}a.campaign.prodle="NONE"}},a.showBannerImageUpload=function(){a.showBanner=1,a.errorForImproperBanner=""},a.showBannerText=function(){a.showBanner=2,a.errorForImproperBanner=""},a.showCampaignExpired=0,a.showExpiredCampaigns=function(){a.showCampaignExpired=1};a.$on("campaignUploadResponseSuccess",function(){});a.$on("$destroy",function(){x(),y(),t(),u(),x(),y(),v(),w(),z(),A(),B(),r(),s(),C()})}]),angular.module("prodo.CampaignApp").filter("startFrom",function(){return function(a,b){return void 0!==a||void 0!==b?(b=+b,a.slice(b)):void 0}}),angular.module("prodo.CampaignApp").controller("ProdoWallCampaignController",["$scope","$rootScope","$state","$http","$timeout","$log","checkIfSessionExist","campaignWalldata","CampaignWallService","ProductFeatureService","UserSessionService",function(a,b,c,d,e,f,g,h,j,k,l){f.debug(h.success),a.searchCommentBy,a.searchBySelected={type:"general"},a.searchfields={},a.searchfields=[{name:"general",value:"commenttext"}],a.commenttagSelected={tag:"general"},a.productComments={comments:[{}]},a.tabForComment={tabComment:"true",tabSearch:"false"},a.isCollapsed=!0,a.type="campaign",b.campaignidWall,a.newProductComment=[],b.productCommentResponsearray=[],a.mytags,a.myFeaturetags,a.count=0,a.commenttextField={userComment:""},a.pretags=[],a.featuretags=[],a.productcommentResponseListener,a.tagPairs=[],a.campaign={},a.ErrMsging=0,a.pimgs=[],b.comment_image_l=[],b.file_data="",b.count=0,a.features=[],a.featuretags=[],(""!==b.campaign_idwall||void 0!==b.campaign_idwall)&&a.$watch("$state.$current.locals.globals.campaignWalldata",function(b){b.error?a.handleGetCampaignResolveError(b):a.handleGetCampaignResolveSuccess(b)}),b.campaign_idwall&&b.$watch("campaign_idwall",function(c){a.getCampaign(c),b.campaign_idwall=""}),a.preGetProductPrepaireData=function(){$("#load-more").css("display","none"),a.searchfields.general="",a.commenttextField.userComment="",a.tabForComment.tabComment=!0,a.tabForComment.tabSearch=!1},a.handleGetCampaignResolveError=function(b){$("#prodo-ProductDetails").css("display","none"),a.ErrMsging=1,document.getElementById("ErrMsging").innerHTML=b.error.message},a.handleGetCampaignResolveSuccess=function(c){if(a.preGetProductPrepaireData(),c.success){if($("#prodo-ProductDetails").css("display","block"),a.getProductFeatures(b.product_prodle,b.orgid),a.allCampaignData=c.success.Product_Campaigns,a.campaign=a.allCampaignData[0],b.campaignidWall=a.campaign.campaign_id,a.campaign.campaign_tags)for(i=0;i<a.campaign.campaign_tags.length;i++)a.features.push(a.campaign.campaign_tags[i]),a.featuretags.push(a.campaign.campaign_tags[i].featurename);f.debug("assigned campaignid"+b.campaignidWall),a.campaign.campaign_comments&&(a.productComments=a.campaign.campaign_comments),0!==a.campaign.artwork.length?(a.pimgs=a.campaign.artwork,f.debug("Product images emitting when not null "),a.$emit("emittingCampaignImages",a.pimgs)):(a.$emit("emittingNoCampaignImages",a.pimgs),f.debug("Product images emitting when null ")),void 0!==a.campaign.campaign_comments&&$("#prodo-comment-media-list").css("display","block"),$("#loadMoreCommentMsg").css("display","none"),a.campaign.campaign_comments&&(a.campaign.campaign_comments.length>4?$("#load-more").css("display","inline"):$("#load-more").css("display","none")),a.isCollapsed=!0}},a.features=[],a.PFeatures=[],a.handleGetProductFeaturesError=function(a){"AL001"==a.code&&b.showModal()},a.handleGetProductFeaturesSuccess=function(b){for(a.features=[],a.featuretags=[],i=0;i<b.success.productfeature.length;i++)a.features.push(b.success.productfeature[i]),a.PFeatures.push(b.success.productfeature[i]),a.featuretags.push(b.success.productfeature[i].featurename)},a.getProductFeatures=function(c,d){""!==c&&k.getFeature({orgid:d,prodle:c},function(b){void 0==b.success?a.handleGetProductFeaturesError(b.error):a.handleGetProductFeaturesSuccess(b)},function(a){b.ProdoAppMessage("Server Error:"+a.status,"error")})},a.getUserDetails=function(){a.userIDFromSession=b.usersession.currentUser.userid,a.usernameFromSession=b.usersession.currentUser.username,a.ProductsFollowedFromSession=l.productfollowlist,b.usersession.currentUser.org?(a.grpnameFromSession=b.usersession.currentUser.org.grpname,a.orgidFromSession=b.usersession.currentUser.org.orgid,a.orgnameFromSession=b.usersession.currentUser.org.orgname):(a.grpnameFromSession="",a.orgnameFromSession="",a.orgidFromSession="")},a.getUserDetails(),a.getCampaign=function(c){a.preGetProductPrepaireData(),j.get_ProductCampaign.getProductCampaign({prodle:b.product_prodle,campaign_id:c},function(b){void 0==b.success?a.handleGetCampaignError(b.error):a.handleGetCampaignSuccess(b)},function(b){f.debug(b),$("#prodo-ProductDetails").css("display","none"),a.ErrMsging=1,document.getElementById("ErrMsging").innerHTML="Server Error:"+b.status})},a.handleGetCampaignError=function(c){"AL001"==c.code?b.showModal():(f.debug("Get Campaign- "+c.message),$("#prodo-ProductDetails").css("display","none"),a.ErrMsging=1,document.getElementById("ErrMsging").innerHTML=c.message)},a.handleGetCampaignSuccess=function(c){c.success.Product_Campaign&&(a.preGetProductPrepaireData(),a.campaign=c.success.Product_Campaign,console.log(a.campaign),b.campaignidWall=a.campaign.campaign_id,f.debug(a.campaign),$("#prodo-ProductDetails").css("display","block"),a.getProductFeatures(b.product_prodle,b.orgid),a.campaign.campaign_comments&&(a.productComments=a.campaign.campaign_comments),0!==a.campaign.artwork.length?(a.pimgs=a.campaign.artwork,f.debug("Product images emitting when not null "),a.$emit("emittingCampaignImages",a.pimgs)):(a.$emit("emittingNoCampaignImages",a.pimgs),f.debug("Product images emitting when null ")),void 0!==a.campaign.campaign_comments&&$("#prodo-comment-media-list").css("display","block"),$("#loadMoreCommentMsg").css("display","none"),a.campaign.campaign_comments&&(a.campaign.campaign_comments.length>4?$("#load-more").css("display","inline"):$("#load-more").css("display","none")),a.isCollapsed=!0)},a.CheckIfAlreadyFollowingCampaign=function(){var a;if(b.usersession.currentUser){if(b.usersession.currentUser.campaign_followed){for(i=0;i<b.usersession.currentUser.campaign_followed.length;i++)b.usersession.currentUser.campaign_followed[i].campaign_id==b.campaignidWall&&(a=!0);return 1==a?{display:"none"}:{display:"inline"}}return{display:"inline"}}return{display:"inline"}},a.followCurrentCampaign=function(c){f.debug(c),j.follow.followCampaign({campaign_id:c},function(b){void 0==b.success?a.handleFollowCampaignError(b.error):a.handleFollowCampaignSuccess(b)},function(a){f.debug(a),b.ProdoAppMessage("Server Error:"+a.status,"error")})},a.handleFollowCampaignError=function(a){f.debug(a),"AL001"==a.code?b.showModal():b.ProdoAppMessage(a.message,"error")},a.handleFollowCampaignSuccess=function(c){f.debug(c),c.success&&(b.ProdoAppMessage("You are following this campaign","success"),b.usersession.currentUser.campaign_followed.push({orgid:a.campaign.orgid,prodle:a.campaign.prodle,campaign_id:b.campaignidWall}),$("#prodo-followBtncampaign").css("display","none"))}}]),angular.module("prodo.CampaignApp").controller("CampaignCommentController",["$scope","$log","$rootScope","ProductService","UserSessionService","$http","CommentLoadMoreService","ENV","TagReffDictionaryService","ProductFeatureService","isLoggedin","CampaignWallService","CampaignCommentService","CampaignCommentLoadMoreService",function(a,b,c,d,e,f,g,h,j,k,l,m,n,o){function p(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function q(){return p()+"-"+p()+"-"+Date.now().toString()}a.deleteProductComment=function(c){c.user.userid==a.userIDFromSession&&(n.deleteComment({commentid:c.commentid},function(b){if(b.success){var d=a.productComments.indexOf(c);-1!=d&&a.productComments.splice(d,1),a.handleDeleteProductCommentSuccess(b)}else b.error&&a.handleDeleteProductCommentError(b.error)},function(a){b.debug(JSON.stringify(a))}),b.debug(c.commentid))},a.loadMoreComments=function(){$("#img-spinner").show();var c=a.getLastCommentId();(""!==c||" "!==c||void 0!==c||null!==c)&&o.loadMoreComments({commentid:c},function(b){a.handleLoadMoreCommentResponse(b),$("#img-spinner").hide()},function(a){b.debug(a),$("#loadMoreCommentMsg").css("display","block"),$("#loadMoreCommentMsg").html(a)})},$(document).ready(function(){var a,c;$("#prodo-comment-Textbox").on("blur mouseleave",function(){$(this).height(30),a=$("#prodo-comment-Textbox").height(),c=$("#prodo-comment-Textbox").width()}),$("#prodo-comment-Textbox").on("focus change keyup paste keypress click",function(){$(this).height(85),a=$("#prodo-comment-Textbox").height(),c=$("#prodo-comment-Textbox").width()}),$("#holder").hover(function(){a=$("#prodo-comment-Textbox").height(),c=$("#prodo-comment-Textbox").width(),document.getElementById("holder").style.height=a,document.getElementById("holder").style.width=c,c="",a=""},function(){b.debug("hovering out",$(this).attr("id")),a=$("#prodo-comment-Textbox").height(),c=$("#prodo-comment-Textbox").width(),document.getElementById("holder").style.height=a,document.getElementById("holder").style.width=c,c="",a=""}),c="",a=""}),a.count,localStorage.sid=c.usersession.currentUser.sessionid,(""!==localStorage.sid||" "!==localStorage.sid||void 0!==localStorage.sid||null!==localStorage.sid)&&(b.debug("Socket = "+h.apiEndpoint),a.socket=io.connect(h.apiEndpoint+h.port+"/api/prodoapp",{query:"session_id="+localStorage.sid})),a.commenttextField.userComment="",a.getTagsFromCommentText=function(){a.mytags=a.pretags;var c=a.commenttextField.userComment,d=[];if(a.commenttextField.userComment)for(var e=c.split(" "),f=0;f<e.length;f++)for(var g=0;g<a.mytags.length;g++)e[f].toLowerCase()==a.mytags[g].toLowerCase()&&d.push(e[f]);a.mytags=d,a.myFeaturetags=a.featuretags;var d=[];if(a.commenttextField.userComment)for(var e=c.split(" "),f=0;f<e.length;f++)for(var g=0;g<a.myFeaturetags.length;g++)e[f].toLowerCase()==a.myFeaturetags[g].toLowerCase()&&d.push(e[f]);a.myFeaturetags=d,b.debug(a.mytags),b.debug(a.myFeaturetags)},a.$watch("commenttextField.userComment",function(){a.getTagsFromCommentText(),0==a.mytags.length?$("#prodo-productTags").css("display","none"):$("#prodo-productTags").css("display","inline")}),a.$watch("mytags",function(){a.mytags}),a.makeTagsPair=function(b,c){for(var d=0;d<c.length;d++)a.tagPairs.push(void 0==b[d]?{featurename:a.features[0].featurename,tag:c[d]}:{featurename:b[d],tag:c[d]})},a.handleAddProductComment=function(a){"AL001"==a.code?c.showModal():(b.debug(a),c.showModal())},a.addProductComment=function(){l.checkUserSession(function(d){if(void 0==d.success)d.error&&a.handleAddProductComment(d.error);else if(a.commentError=!1,""==a.commenttextField.userComment||void 0==a.commenttextField.userComment||null==a.commenttextField.userComment)c.ProdoAppMessage("You can not add blank comment","error");else{b.debug("tags "+a.mytags),b.debug("features "+a.myFeaturetags),a.makeTagsPair(a.myFeaturetags,a.mytags),b.debug("Pair : "+JSON.stringify(a.tagPairs)),b.debug(c.file_data),b.debug(c.comment_image_l);var e=q();""==c.file_data||" "==c.file_data||void 0==c.file_data||null==c.file_data?(a.newProductComment={campaign_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:e,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:a.commenttextField.userComment,analytics:a.tagPairs}},a.newProductComment_image={campaign_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:e,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:a.commenttextField.userComment,analytics:a.tagPairs}}):(a.newProductComment={campaign_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:e,type:a.type,datecreated:Date.now(),commenttext:a.commenttextField.userComment,tags:a.mytags,comment_image:c.file_data,analytics:a.tagPairs}},a.newProductComment_image={campaign_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:e,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:a.commenttextField.userComment,comment_image:c.comment_image_l,analytics:a.tagPairs}},c.file_data="");var f;if(c.usersession.currentUser&&c.usersession.currentUser.campaign_followed)for(i=0;i<c.usersession.currentUser.campaign_followed.length;i++)c.usersession.currentUser.campaign_followed[i].campaign_id==c.campaignidWall&&(f=!0);if(1==f){var g,h=new Date(a.campaign.enddate),j=new Date;console.log(h),console.log(j),g=j>h?!0:!1,0==g?(console.log(g),b.debug(a.newProductComment.campaign_comment),a.socket.emit("addCampaignComment",c.product_prodle,c.campaignidWall,a.newProductComment.campaign_comment),void 0==a.productComments?(a.productComments=[],a.productComments.unshift(a.newProductComment_image.campaign_comment)):a.productComments.unshift(a.newProductComment_image.campaign_comment),a.commenttextField.userComment="",a.tagPairs=[],c.count=0,document.getElementById("prodo-comment-commentContainer").style.marginTop="0px",document.getElementById("crossButton").style.display="none",$("#prodo-uploadedCommentImage").css("display","none"),a.mytags=""):c.ProdoAppMessage("This campaign has been stopped. You can not comment now","error")}else c.ProdoAppMessage("Please follow this campaign to start commenting...","error")}})},a.addProductCommentretry=function(d){l.checkUserSession(function(e){if(void 0==e.success)e.error&&a.handleAddProductComment(e.error);else{var f=q();""==c.file_data||" "==c.file_data||void 0==c.file_data||null==c.file_data?(a.newProductComment={campaign_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:f,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:d.commenttext,analytics:a.tagPairs}},a.newProductComment_image={campaign_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:f,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:d.commenttext,analytics:a.tagPairs}}):(a.newProductComment={campaign_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:f,type:a.type,datecreated:Date.now(),commenttext:d.commenttext,tags:a.mytags,comment_image:c.file_data,analytics:a.tagPairs}},a.newProductComment_image={campaign_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:f,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:d.commenttext,comment_image:c.comment_image_l,analytics:a.tagPairs}},c.file_data=""),b.debug(a.newProductComment),a.socket.emit("addCampaignComment",c.product_prodle,c.campaignidWall,a.newProductComment.campaign_comment),void 0==a.productComments?(a.productComments=[],a.productComments.unshift(a.newProductComment_image.campaign_comment)):(a.productComments.shift(),a.productComments.unshift(a.newProductComment_image.campaign_comment)),a.commenttextField.userComment="",a.tagPairs=[],c.count=0,document.getElementById("prodo-comment-commentContainer").style.marginTop="0px",document.getElementById("crossButton").style.display="none",$("#prodo-uploadedCommentImage").css("display","none"),a.mytags=""}})},a.getLatestComments=function(){if(0!==c.productCommentResponsearray.length){b.debug(c.productCommentResponsearray),a.reversecomments_l=a.productCommentResponsearray.reverse(),b.debug(a.reversecomments_l),a.productComments=a.reversecomments_l.concat(a.productComments),b.debug(a.productComments);var d=document.getElementById("responseComment");d.style.display="none",d.innerHTML="",a.productCommentResponsearray.length=0,a.reversecomments_l.length=0,a.count=0}},a.commentError="",a.socket.removeAllListeners("addCampaignCommentResponse"),a.socket.on("addCampaignCommentResponse",function(d,e){d?(a.commentError=d.error.message,b.debug(d.error.message),c.ProdoAppMessage(d.error.message,"error"),a.showErrorIfCommentNotAdded(),a.showRetryIconIfCommentNotAdded()):e&&(a.ifErrorAddingComment=!1,a.commentError=!1,b.debug("addCampaignCommentResponse success"+JSON.stringify(e.success.campaign_comment)))}),a.campaigncommentResponseListener="campaigncommentResponse"+c.campaignidWall,b.debug("campaign id   "+c.campaignidWall),a.socket.removeAllListeners(a.campaigncommentResponseListener),a.socket.on(a.campaigncommentResponseListener,function(d,e){if(d)b.debug(d.error.message),c.ProdoAppMessage(d.error.message,"error");else if(e){b.debug("campaigncommentResponse  Response success"+JSON.stringify(e.success.campaign_comment)),a.newProductComment={campaign_comment:{user:{userid:e.success.campaign_comment.user.userid,username:e.success.campaign_comment.user.username,orgname:e.success.campaign_comment.user.orgname,grpname:e.success.campaign_comment.user.grpname,profilepic:e.success.campaign_comment.user.profilepic},commentid:e.success.campaign_comment.commentid,type:e.success.campaign_comment.type,datecreated:e.success.campaign_comment.datecreated,commenttext:e.success.campaign_comment.commenttext,analytics:a.tagPairs}},c.productCommentResponsearray.push(a.newProductComment.campaign_comment),b.debug(c.productCommentResponsearray),a.count=c.productCommentResponsearray.length,b.debug(a.count);var f=document.getElementById("responseComment");f.style.display="inline",f.innerHTML=a.count+" new comments"}})}]),angular.module("prodo.BlogApp").controller("ProdoWallBlogController",["$scope","$rootScope","$state","$http","$timeout","$stateParams","$log","growl","checkIfSessionExist",function(a,b,c,d,e,f,g){g.debug("initialising wall blog controller...")}]),angular.module("prodo.BlogApp").controller("ManageBlogController",["$scope","$rootScope","$state","$http","$timeout","$stateParams","$log","growl","checkIfSessionExist","fileReader","ENV","isLoggedin",function(a,b,c,d,e,f,g,h,i,j,k,l){g.debug("initialising manage blog controller..."),a.addNewBlog=!1,a.blogs=[],a.addBlog=function(){a.addNewBlog=!0},a.socket=io.connect(k.apiEndpoint+k.port+"/api/prodoupload",{query:"session_id="+b.usersession.currentUser.sessionid}),a.handleUploadError=function(a){$("#bar").hide(),"AL001"==a.code?b.showModal():(g.debug(a),b.showModal())},a.getFile=function(c){l.checkUserSession(function(d){void 0==d.success?d.error&&a.handleUploadError(d.error):j.readAsBinaryString(c,a).then(function(d){a.imageBfr=d,a.file=c,a.file_data={filetype:a.file.type,filename:a.file.name,filebuffer:a.imageBfr},"image/jpg"==a.file.type||"image/png"==a.file.type||"image/gif"==a.file.type||"image/jpeg"==a.file.type?a.file.size/1024<2048?a.isValidImage=!0:(b.ProdoAppMessage("Image size must ne less than 2MB","error"),$("#addCampaignForm")[0].reset()):b.ProdoAppMessage("Please upload image only","error")})})},a.socket.removeAllListeners("addProductCampaignResponse"),a.socket.on("addProductCampaignResponse",function(b,c){a.addProductCampaignResponseHandler(b,c)}),a.addProductCampaignResponseHandler=function(d,e){d?"AP003"==d.error.code?(g.debug(d.error.code+" "+d.error.message),b.ProdoAppMessage(d.error.message,"error")):"AV001"==d.error.code?(a.ProdoAppMessage(d.error.message,"error"),g.debug("response from server")):(b.ProdoAppMessage(d.error.message,"error"),"AP001"===d.error.code?a.campaign.productName="":a.campaign={productName:"",Name:"",Description:"",startDate:"",endDate:"",category:[],campaignBannerText:"",campaignTags:[],prodle:""}):(a.imageSrc=JSON.stringify(e.success.invoiceimage),b.$broadcast("campaignUploadResponseSuccess","success"),b.ProdoAppMessage("Campaign added successfully","success"),c.enableEditing=0,c.transitionTo(c.current,f,{reload:!0,inherit:!1,notify:!0}),a.counter++,a.counter<a.fileLength||(a.counter=0))}}]),angular.module("prodo.BlogApp").filter("startFrom",function(){return function(a,b){return void 0!==a||void 0!==b?(b=+b,a.slice(b)):void 0}}),angular.module("prodo.CommonApp").directive("prodonusPasswordCheck",["$parse",function(a){return{require:"ngModel",link:function(b,c,d,e){b.$watch(function(){return a(d.prodonusPasswordCheck)(b)===e.$modelValue
},function(a){e.$setValidity("mismatch",a)})}}}]).directive("prodonusPasswordValidate",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(b){return a.pwdValidLength=b&&b.length>=6?"valid":void 0,a.pwdHasAlphabet=b&&/[A-z]/.test(b)?"valid":void 0,a.pwdHasNumber=b&&/\d/.test(b)?"valid":void 0,a.pwdHasSymbol=b&&/(?=(?:.*[!@#$%^&*-]){1})/.test(b)?"valid":void 0,a.pwdValidLength&&a.pwdHasAlphabet&&a.pwdHasNumber&&a.pwdHasSymbol?(d.$setValidity("pwd",!0),b):void d.$setValidity("pwd",!1)})}}}).directive("prodonusMultiEmailValidate",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(b){return a.emailHas=b&&/(([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)(\s*,\s*|\s*$)+)/.test(b)?"valid":void 0,a.emailHas?(d.$setValidity("email",!0),b):void d.$setValidity("email",!1)})}}}).directive("prodoSpinner",["$timeout",function(){return{restrict:"EA",replace:!0,template:'<span ng-show="spinner.isShown"><i style="color:yellow;" class="fa fa-spinner fa-spin"></i></span>',controller:["$scope","$rootScope",function(a){a.spinner={isShown:!1},a.showSpinner=function(){a.spinner.isShown=!0},a.hideSpinner=function(){a.spinner.isShown=!1}}]}}]).directive("prodoSigninModal",["$timeout","UserSessionService",function(a,b){return{restrict:"EA",replace:!0,templateUrl:"user/views/user.continue.login.modal.tpl.html",controller:["$scope","$rootScope",function(a,c){c.showModal=function(){$("#mySessionModal").modal({keyboard:!1,backdrop:"static",show:!0})},a.sessionout=function(){b.logoutUser(),$("#mySessionModal").modal("hide")}}]}}]).directive("prodovideo",function(){return{restrict:"EA",replace:!0,transclude:!0,scope:{video:"@"},template:'<div class="prodovideo"><iframe ng-src="{{ video }}"></iframe></div>',link:function(a,b,c){var d=c.height/c.width*100;b[0].style.paddingTop=d+"%"}}}).directive("prodoSlider",function(){var a={restrict:"A",link:function(){$("#layerslider").layerSlider({skin:"fullwidth",autoStart:!0,responsive:!0,responsiveUnder:0,sublayerContainer:0,keybNav:!0,touchNav:!0,imgPreload:!0,navPrevNext:!0,navStartStop:!0,navButtons:!0,thumbnailNavigation:"hover",tnWidth:100,tnHeight:60,tnContainerWidth:"60%",tnActiveOpacity:35,tnInactiveOpacity:100,hoverPrevNext:!0,hoverBottomNav:!0,pauseOnHover:!0,autoPlayVideos:!0,autoPauseSlideshow:"auto",showBarTimer:!1,showCircleTimer:!1})}};return a}).directive("marketingSlider",function(){var a={restrict:"A",link:function(a,b){$(b).layerSlider({autoStart:!0,skin:"noskin",showCircleTimer:!1})}};return a}).directive("prodoBroadcastCarousel",function(){var a={restrict:"A",link:function(){$("#myCarousel").carousel({interval:1e4})}};return a}).directive("prodoNav",function(){var a={restrict:"A",link:function(){$("document").ready(function(){$("ul.nav.nav-pills li a").click(function(){$(this).parent().addClass("active").siblings().removeClass("active")})})}};return a}).directive("showtab",function(){return{link:function(a,b){b.click(function(a){a.preventDefault(),$(b).tab("show")})}}}).directive("prodoUnique",["$http",function(a){var b={restrict:"A",require:"ngModel",link:function(b,c,d,e){$("#prodo-form-input-username-signup").on("keyup",function(){var b=$(this).val().trim(),c={username:b};b.length>2&&b.length<15&&a({method:"GET",url:"/api/userunique/"+b,data:c}).success(function(a){a.success?(console.log(a.success.message),e.$setValidity("nametaken",!0)):"AV001"==a.error.code?(console.log(a.error.code+a.error.message),e.$setValidity("namelength",!1)):"ED001"==a.error.code?(console.log(a.error.code+a.error.message),e.$setValidity("nametaken",!1)):"ED003"==a.error.code&&(console.log(a.error.code+a.error.message),e.$setValidity("nametaken",!1))}).error(function(a){console.log(a)})})}};return b}]).directive("prodoBarchart",function(){var a={restrict:"EA",link:function(a){nv.addGraph(function(){var b=nv.models.discreteBarChart().x(function(a){return a.tagname}).y(function(a){return a.tagcount}).staggerLabels(!0).tooltips(!0).showValues(!0);return d3.select("#chart").datum(a.barChart()).transition().duration(50).call(b),nv.utils.windowResize(b.update),b})}};return a}).directive("prodoPiechart",function(){var a={restrict:"EA",link:function(a){nv.addGraph(function(){var b=500,c=500,d=nv.models.pieChart().x(function(a){return a.emotionname}).y(function(a){return a.tagcount}).color(function(a){return a.data.color}).width(b).height(c);return d3.select("#test1").datum(a.data).transition().duration(1200).attr("width",b).attr("height",c).call(d),d.dispatch.on("stateChange",function(a){nv.log("New State:",JSON.stringify(a))}),d})}};return a}).directive("prodoProductChart",function(){var a={restrict:"EA",link:function(){var a=d3.select("#a").append("div").attr("class","abc").style("opacity",0),b=d3.select("#a").style("background-image","url(http://s1.ibtimes.com/sites/www.ibtimes.com/files/styles/v2_article_large/public/2013/09/18/apple-iphone-5s-release.jpg) ").style("background-repeat","no-repeat").style("background-size","78%"),c=b.append("svg"),d=c.append("circle").attr("cx",389).attr("cy",54).attr("r",5).style("fill","blue").style("position","relative");d.on("mouseenter",function(){d.attr("r",10).style("fill","none").style("stroke","red").style("stroke-opacity",1e-6).style("stroke-width",3).transition().duration(500).attr("r",5).style("fill","blue").style("stroke-opacity",2),a.text("Front Camera").style("opacity",2).style("left","400px").style("bottom","265px")}).on("mouseout",function(){d.attr("r",5).style("stroke","none"),a.style("opacity",0).style("left","0px").style("bottom","0px")}),screenCircle=c.append("circle").attr("cx",192).attr("cy",90).attr("r",5).style("fill","blue").style("position","relative").on("mouseover",function(){screenCircle.attr("r",10).style("fill","none").style("stroke","red").style("stroke-opacity",1e-6).style("stroke-width",3).transition().duration(500).attr("r",5).style("fill","blue").style("stroke-opacity",2),a.text("Screen").style("opacity",2).style("left","200px").style("bottom","220px")}).on("mouseout",function(){screenCircle.attr("r",5).style("stroke","none"),a.style("opacity",0).style("left","0px").style("bottom","0px")}),speakersCircle=c.append("circle").attr("cx",120).attr("cy",300).attr("r",4).style("fill","blue").style("position","relative").on("mouseover",function(){speakersCircle.attr("r",10).style("fill","none").style("stroke","red").style("stroke-opacity",1e-6).style("stroke-width",3).transition().duration(500).attr("r",4).style("fill","blue").style("stroke-opacity",2),a.text("Speakers").style("opacity",2).style("left","122px").style("bottom","38px")}).on("mouseout",function(){speakersCircle.attr("r",4).style("stroke","none").style("left","0px").style("bottom","0px"),a.style("opacity",0)})}};return a}).directive("prodoTrendingchart",function(){var a={restrict:"EA",link:function(a){nv.addGraph(function(){var b=nv.models.linePlusBarChart().margin({top:30,right:60,bottom:50,left:70}).x(function(a,b){return b}).y(function(a){return a[1]});return b.xAxis.tickFormat(function(b){var c=a.sampleData[0].values[b]&&a.sampleData[0].values[b][0]||0;return d3.time.format("%x")(new Date(c))}),b.y1Axis.tickFormat(d3.format(",f")),b.y2Axis.tickFormat(function(a){return""+d3.format(",f")(a)}),b.bars.forceY([0]),d3.select("#allTrendingChart").datum(a.sampleData).transition().duration(0).call(b),nv.utils.windowResize(b.update),b})}};return a}).directive("prodoIndia",function(){var a={restrict:"EA",link:function(){function a(){c.scale(6700),c.translate([-1240,720])}var b,c=d3.geo.mercator(),d=d3.geo.path().projection(c),e=d3.select("#map").append("svg:svg").attr("class","maps").attr("width",600).attr("height",800).call(a),f=e.append("svg:g").attr("id","india"),g=d3.select("#map").append("div").attr("class","abctooltip").style("opacity",0);d3.json("../../dashboard/json/IndiaData.json",function(a){f.selectAll("path").data(a.features).enter().append("path").attr("d",d)}),d3.json("../../dashboard/json/Counties.json",function(a){b=a.reduce(function(a,b){return a[b.id]=b,a},{}),f.selectAll("path").style("fill",function(a){return a.amount<2?"rgb(247,251,255)":a.amount>1&&a.amount<3?"rgb(8,48,107)":a.amount>2&&a.amount<4?"rgb(8,81,156)":a.amount>3&&a.amount<5?"rgb(8,81,156)":"rgb(8,48,107)"}).attr("d",d).on("mouseover",function(a){d3.select("#subtitle").text(a.id);g.text("State: "+a.id+"  Number of Customers: "+1e5*a.amount).style("opacity",4).style("left",d3.event.pageX+5+"px").style("top",d3.event.pageY+5+"px");d3.select("#subblurb").text(a.comment);console.log("The amount is "+a.amount)}).on("mouseout",function(){g.style("opacity",0)}).on("click",function(){})})}};return a}).directive("generalSearch",["$http","$rootScope",function(a,b){var c={restrict:"A",require:"ngModel",link:function(c){$("#searchText").on("keyup",function(d){c.errors="",c.enhancement={};var e=$(this).val().trim(),f={name:e,orgid:b.orgid};""!==e&&d.shiftKey===!1&&a({method:"POST",url:"/api/allproduct/",data:f}).success(function(a){a.error?c.errors="AD001"===a.error.code?"No products found for \n '"+b.orgdata.name+"'":"No products found for \n '"+b.orgdata.name+"'":a.success&&(0===a.name.doc.length&&(""===e?c.errors="":(c.errors="No products found for \n '"+b.orgdata.name+"'",window.setTimeout(function(){c.toggleTitleForDiv()},1e3))),c.enhancement={},c.productNames=[],c.enhancement=a.name.doc,c.productNames=a.success.doc)}).error(function(){b.ProdoAppMessage("server error","error")})})}};return c}]),angular.module("prodo.AdminApp").factory("tagAddService",["$rootScope","$resource","$state","$log",function(a,b,c,d){var e={Product:b("/api/tagreffdictionary/addtag",{},{addTags:{method:"POST"}})},f={};return f.addTagFunction=function(b){e.Product.addTags(b,function(b){d.debug(b),a.$broadcast("tagAddedSuccessfully",b)}),function(b){d.debug(b),a.$broadcast("tagsNotAddedSuccessfully",b)}},f}]).factory("domainTagList",["$resource",function(a){var b={Tags:a("/api/tagreffdictionary/alldomaintags",{},{getTag:{method:"GET"}})};return b}]),angular.module("prodo.AdminApp").controller("prodoAdminTagInputController",["$scope","$log","$rootScope","UserSessionService","$state","tagAddService","domainTagList","tagdata",function(a,b,c,d,e,f,g,h){a.category_selection,a.option1,a.option2,a.objectComponents={},a.tagInfo={},a.tagid,a.tagname,a.result,a.level,a.emotion,a.urls,a.emotionvalueinsert,a.trimmedURL,a.categoryDomain="",a.allCategories=[],a.allTagsContain=[],void 0!==h.success&&(a.allTagsContain=h.success.domain_tags.tags);var i=a.$on("gotAllDomainTags",function(a,b){void 0!==b.error&&"AL001"===b.error.code&&e.go("prodo.landing.signin"),b.success?c.ProdoAppMessage(b.success.message,"success"):"AU004"==b.error.code?c.ProdoAppMessage(b.error.message,"error"):c.ProdoAppMessage(b.error.message,"error")}),j=a.$on("notGotAllDomainTags",function(){c.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+data,"error")});a.addToCategory=function(){a.allCategories.push(a.categoryDomain)},a.setEmotion=function(){"Love"===a.category_selection?(a.option1="Serenity [10]",a.option2="Joy [20]",a.option3="Ecstasy [30]"):"Optimism"===a.category_selection?(a.option1="Interest [10]",a.option2="Anticipation [20]",a.option3="Vigilance [30]"):"Aggressiveness"===a.category_selection?(a.option1="Annoyance [10]",a.option2="Anger [20]",a.option3="Rage [30]"):"Contempt"===a.category_selection?(a.option1="Boredom [10]",a.option2="Disgust [20]",a.option3="Loathing [30]"):"Remorse"===a.category_selection?(a.option1="Pensiveness [10]",a.option2="Sadness [20]",a.option3="Grief [30]"):"Disapproval"===a.category_selection?(a.option1="Distraction [10]",a.option2="Surprise [20]",a.option3="Amazement [30]"):"Awe"===a.category_selection?(a.option1="Apprehension [10]",a.option2="Fear [20]",a.option3="Terror [30]"):"Submission"===a.category_selection&&(a.option1="Acceptance [10]",a.option2="Trust [20]",a.option3="Adoration [30]")};var k=a.$on("tagAddedSuccessfully",function(b,d){void 0!==d.error&&"AL001"===d.error.code&&c.showModal(),d.success?(c.ProdoAppMessage(d.success.message,"success"),a.tagname="",a.allCategories=[],a.category_selection="",a.emotionvalueinsert="",a.level="",a.result="",a.emotionvalueinsert=""):"AU004"==d.error.code?c.ProdoAppMessage(d.error.message,"error"):c.ProdoAppMessage(d.error.message,"error")}),l=a.$on("tagsNotAddedSuccessfully",function(){c.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+data,"error")});a.submitTag=function(){a.objectComponents.tagname=a.tagname,a.objectComponents.emotions={},a.objectComponents.emotions.category=a.category_selection,a.objectComponents.emotions.emotion=a.emotion,a.objectComponents.emotions.level=a.level,a.objectComponents.emotions.result=a.result,a.objectComponents.domain_tag=a.allCategories;var b=document.getElementById("4").value;if(b){var c=b.lastIndexOf(b.indexOf("\\")>=0?"\\":"/"),d=b.substring(c);(0===d.indexOf("\\")||0===d.indexOf("/"))&&(d=d.substring(1)),a.trimmedURL=d}a.objectComponents.emotions.emotion_url=a.trimmedURL,a.tagInfo.tagreffdicdata={},a.tagInfo.tagreffdicdata=a.objectComponents,f.addTagFunction(a.tagInfo),a.allCategories=[]},a.$on("$destroy",function(){k(),l(),i(),j()})}]),angular.module("prodo.AdminApp").controller("LandingPageController",["$scope","$log","$rootScope","UserSessionService","$state","fileReader","ENV","isLoggedin",function(a,b,c,d,e,f,g,h){a.marketing={name:"",description:""},a.jsonContent=function(){var b={name:a.marketing.name,description:a.marketing.description};return b},a.submitLangingpageContent=function(){a.socket.emit("addMarketingData",c.usersession.currentUser.userid,a.jsonContent(),a.file_data)},a.socket=io.connect(g.apiEndpoint+g.port+"/api/prodoupload",{query:"session_id="+c.usersession.currentUser.sessionid}),a.handleUploadError=function(a){$("#bar").hide(),"AL001"==a.code?c.showModal():(b.debug(a),c.showModal())},a.getFile=function(b){h.checkUserSession(function(d){void 0==d.success?d.error&&a.handleUploadError(d.error):f.readAsBinaryString(b,a).then(function(d){a.imageBfr=d,a.file=b,a.file_data={filetype:a.file.type,filename:a.file.name,filebuffer:a.imageBfr},"image/jpg"==a.file.type||"image/png"==a.file.type||"image/gif"==a.file.type||"image/jpeg"==a.file.type?a.file.size/1024<2048?a.isValidImage=!0:(c.ProdoAppMessage("Image size must ne less than 2MB","error"),$("#marketingData")[0].reset()):(c.ProdoAppMessage("Please upload image only","error"),$("#marketingData")[0].reset())})})},a.socket.removeAllListeners("addMarketingDataResponse"),a.socket.on("addMarketingDataResponse",function(b,c){a.addMarketingContentResponseHandler(b,c)}),a.addMarketingContentResponseHandler=function(d,f){$("#marketingData")[0].reset(),d?"AP003"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage(d.error.message,"error")):"AV001"==d.error.code?(a.ProdoAppMessage(d.error.message,"error"),b.debug("response from server")):(b.debug(d.error.message),c.ProdoAppMessage(d.error.message,"error"),a.campaign={productName:"",Name:"",Description:"",startDate:"",endDate:"",category:[]}):(a.imageSrc=JSON.stringify(f.success.invoiceimage),c.ProdoAppMessage("Marketing data added successfully","success"),e.enableEditing=0,a.counter++,a.counter<a.fileLength||(a.counter=0))},a.$on("$destroy",function(){})}]),angular.module("prodo.ProdonusApp").value("cgNotifyTemplateName","angular-notify.html"),angular.module("prodo.ProdonusApp").factory("notify",["$timeout","cgNotifyTemplateName","$http","$compile","$templateCache","$rootScope",function(a,b,c,d,e,f){var g=2,h=35,i=[],j=function(j){"object"!=typeof j&&(j={message:j}),j.template=j.template?j.template:b,c.get(j.template,{cache:e}).success(function(b){var c=f.$new();if(c.message=j.message,"object"==typeof j.scope)for(var e in j.scope)c[e]=j.scope[e];var k=d(b)(c);k.bind("webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",function(a){"opacity"===a.originalEvent.propertyName&&(k.remove(),k.splice(i.indexOf(k),1))}),$("body").append(k),i.push(k),"center"===j.position&&a(function(){k.css("margin-left","-"+k.outerWidth()/2+"px")}),a(function(){for(var a=0,b=i.length-1;b>=0;b--){var c=i[b],d=g+a*h;c.css("top",d+"px"),"1"===c.css("opacity")&&c.css("opacity",0),a++}})}).error(function(a){throw new Error("Template specified for cgNotify ("+j.template+") could not be loaded. "+a)})};return j.config=function(a){g=a.top?a.top:g,h=a.verticalSpacing?a.verticalSpacing:h},j}]),angular.module("prodo.ProdonusApp").run(["$templateCache",function(a){a.put("angular-notify.html",'<div class="cg-notify-message">	{{message}}</div>')}]),angular.module("prodo.ProductApp").controller("DragImageController",["$scope","$rootScope","$log",function(a,b,c){function d(a){i.filereader===!0&&j[a.type]===!0&&1===b.count?(f=new FileReader,f.onload=function(a){$("#prodo-uploadedCommentImage").css("display","inline"),document.getElementById("crossButton").style.display="inline",$("#prodo-uploadedCommentImage").attr("src",a.target.result),b.comment_image_l=[{image:a.target.result}]},f.readAsDataURL(a)):h.innerHTML+=" Uploaded "+a.name+" "+(a.size?(a.size/1024|0)+"K":""),g=new FileReader,g.onload=function(c){var d=c.target.result;b.file_data={filetype:a.type,filename:a.name,filebuffer:d}},g.readAsBinaryString(a)}function e(a){for(var b=i.formdata?new FormData:null,e=0;e<a.length;e++)i.formdata&&b.append("file",a[e]),d(a[e]),c.debug(a[e].name)}var f,g;b.count=0;{var h=document.getElementById("holder"),i={filereader:"undefined"!=typeof FileReader,dnd:"draggable"in document.createElement("span"),formdata:!!window.FormData},j=({filereader:document.getElementById("filereader"),formdata:document.getElementById("formdata"),progress:document.getElementById("progress")},{"image/png":!0,"image/jpeg":!0,"image/gif":!0});document.getElementById("upload")}i.dnd&&(h.ondragover=function(){return this.className="hover",!1},h.ondragend=function(){return this.className="",!1},h.ondragleave=function(){return this.className="",!1},h.ondrop=function(c){a.validImageContent=0,b.count++,this.className="",c.preventDefault(),c.dataTransfer.files[0].size/1024>500&&(b.ProdoAppMessage("Please drag image of size upto 500KB","error"),b.count=0,c.dataTransfer.files=[],a.validImageContent=1),"image/png"!==c.dataTransfer.files[0].type&&"image/jpeg"!==c.dataTransfer.files[0].type&&"image/jpg"!==c.dataTransfer.files[0].type&&"image/gif"!==c.dataTransfer.files[0].type&&(b.ProdoAppMessage("Please verify extension of image dragged","error"),b.count=0,c.dataTransfer.files=[],a.validImageContent=1),b.count>1?(b.ProdoAppMessage("You can only drag one image for a comment","error"),a.validImageContent=1):1==b.count&&0===a.validImageContent&&e(c.dataTransfer.files),console.log("Here its finally set")}),a.clearReader=function(){c.debug("Clear called"),document.getElementById("prodo-comment-commentContainer").style.marginTop="0px",document.getElementById("crossButton").style.display="none",document.getElementById("prodo-uploadedCommentImage").style.display="none",f.abort(),g.abort(),f=new FileReader,g=new FileReader,b.file_data="",b.count=0;document.getElementById("prodo-uploadedCommentImage")}}]),angular.module("prodo.ProductApp").controller("ProductController",["$scope","$log","$rootScope","ProductService","UserSessionService","$http","CommentLoadMoreService","ENV","TagReffDictionaryService","ProductFeatureService","$state","productData","ProductEnquiry",function(a,b,c,d,e,f,g,h,j,k,l,m,n){a.pimgs=[],a.inquiry="know",a.searchCommentBy,a.searchBySelected={type:"general"},a.searchfields={},a.searchfields=[{name:"general",value:"commenttext"},{name:"commentcategory",value:"commentcategory"}],a.commenttagSelected={tag:"general"},a.isCollapsedSearch=1,c.comment_image_l=[],c.file_data="",c.count=0,a.productComments={comments:[{}]},a.searchComment={},a.search={},a.tabForComment={tabComment:"true",tabSearch:"false"},a.newProductComment=[],c.productCommentResponsearray=[],a.mytags,a.myFeaturetags,a.count=0,a.commenttextField={userComment:""},a.pretags=[],a.featuretags=[],a.productcommentResponseListener,a.tagPairs=[],a.editStatus,a.product={product:[{}]},a.newProduct={product:[{}]},a.type="product",c.product_prodle,c.orgid,a.pImages_l={product_images:[{}]},a.currentProdle,a.currentOrgid,a.userIDFromSession,a.usernameFromSession,a.grpnameFromSession,a.orgnameFromSession,a.orgidFromSession,a.ProductsFollowedFromSession=[],a.socket,a.isCollapsed=!0,a.$state=l,$(document).ready(function(){$(".btn-slide").click(function(){return $("#panel").slideToggle("slow"),$(this).toggleClass("active"),!1})}),a.sendEnquiry=function(d,e,f){a.EnquiryData={subject:"",body:""},a.subjectbody="","know"==f?(a.EnquiryData.subject="know",a.EnquiryData.body="I want to know more about product"):"buy"==f?(a.EnquiryData.subject="buy",a.EnquiryData.body="I want to buy this product"):"custom"==f&&(a.EnquiryData.subject="custom",a.EnquiryData.body=a.productreqMsg),b.debug(a.EnquiryData),a.AllData={productenquirydata:a.EnquiryData},n.sendEnquiry({orgid:d,prodle:e},a.AllData,function(b){b.success?a.handleEnquirySuccess(b):a.handleEnquiryError(b.error)},function(a){b.debug(a),c.ProdoAppMessage("Server Error:"+a.status,"error")})},a.handleEnquirySuccess=function(a){b.debug(a.success),c.ProdoAppMessage("Your enquiry request sent successfully","success")},a.handleEnquiryError=function(a){a&&("AL001"==a.code?c.showModal():(b.debug(a),c.ProdoAppMessage(a.message,"error")))},c.$watch("product_prodle",function(){a.features=[],$("#productLogo").attr("src","");document.getElementById("prodo-comment-container");void 0!==c.product_prodle||null!==c.product_prodle||""!==c.product_prodle?(a.getProduct(c.product_prodle,c.orgid),a.tabComment=!0):($("#prodo-ProductDetails").css("display","none"),$("#ErrMsging").css("display","block"),document.getElementById("ErrMsging").innerHTML="Product not available")}),a.getUserDetails=function(){a.userIDFromSession=c.usersession.currentUser.userid,a.usernameFromSession=c.usersession.currentUser.username,a.ProductsFollowedFromSession=e.productfollowlist,c.usersession.currentUser.org?(a.grpnameFromSession=c.usersession.currentUser.org.grpname,a.orgidFromSession=c.usersession.currentUser.org.orgid,a.orgnameFromSession=c.usersession.currentUser.org.orgname):(a.grpnameFromSession="",a.orgnameFromSession="",a.orgidFromSession="")},a.getUserDetails(),a.preGetProductPrepaireData=function(){$("#load-more").css("display","none"),a.commenttextField.userComment="",a.tabForComment.tabComment=!0,a.tabForComment.tabSearch=!1},a.getProductHandleSuccess=function(d,e){$("#prodo-ProductDetails").css("display","block"),$("productExtraInfo").css("display","block"),$("#ErrMsging").css("display","none"),b.debug(m.success.product),a.getProductFeatures(d,e),$("#prodo-ProductFeatureTable").css("display","table"),a.product=m.success.product,m.success.product.product_images?(a.pimgs=m.success.product.product_images,b.debug("Product images emitting when not null "),a.$emit("emittingProductImages",a.pimgs)):(a.$emit("emittingNoProductImages",a.pimgs),b.debug("Product images emitting when null ")),a.productComments=m.success.product.product_comments,void 0!==m.success.product.product_comments&&$("#prodo-comment-media-list").css("display","block"),a.pImages_l=m.success.product.product_images,$("#prodo-addingProduct").text(a.product.status),$("#loadMoreCommentMsg").css("display","none"),c.usersession.currentUser.org&&1==c.usersession.currentUser.org.isAdmin&&(c.isAdminCheck=a.orgidFromSession===a.currentOrgid?!0:!1),b.debug("COmments :   "+m.success.product.product_comments),(void 0==m.success.product.product_comments||null==m.success.product.product_comments||""==m.success.product.product_comments)&&$("#loadMoreCommentMsg").css("display","none"),m.success.product.product_comments&&(m.success.product.product_comments.length>4?$("#load-more").css("display","inline"):$("#load-more").css("display","none"))},a.getProductHandleError=function(a){a&&("AL001"==a.code?c.showModal():(b.debug(a),$("#prodo-ProductDetails").css("display","none"),$("#ErrMsging").css("display","inline"),document.getElementById("ErrMsging").innerHTML=a.message))},a.getProduct=function(c,d){b.debug("Prodle n orgid "+c+" "+d),a.preGetProductPrepaireData(),void 0==m.success?(a.getProductHandleError(),$("#prodo-ProductDetails").css("display","none"),$("#ErrMsging").css("display","block"),null!==document.getElementById("ErrMsging")&&(document.getElementById("ErrMsging").innerHTML="Product not available , please select product....")):a.getProductHandleSuccess(c,d),m.error&&a.getProductHandleError(m.error),a.isCollapsed=!0},a.features=[],a.PFeatures=[],a.handleGetProductFeaturesError=function(a){"AL001"==a.code&&c.showModal()},a.handleGetProductFeaturesSuccess=function(b){for(a.features=[],a.featuretags=[],i=0;i<b.success.productfeature.length;i++)a.features.push(b.success.productfeature[i]),a.PFeatures.push(b.success.productfeature[i]),a.featuretags.push(b.success.productfeature[i].featurename)},a.getProductFeatures=function(b,d){""!==b&&k.getFeature({orgid:d,prodle:b},function(b){void 0==b.success?a.handleGetProductFeaturesError(b.error):a.handleGetProductFeaturesSuccess(b)},function(a){c.ProdoAppMessage("Server Error:"+a.status,"error")})},$(".show-more").click(function(){$(".text").toggleClass("show-more-height"),$(".text").hasClass("show-more-height")?($(this).text(" Show More"),$(this).removeClass("fa-arrow-up").addClass("fa-arrow-down")):($(this).text(" Show Less"),$(this).removeClass("fa-arrow-down").addClass("fa-arrow-up"))}),a.cslcShowMoreLength=function(){return a.product.description&&a.product.description.length<130?{display:"none"}:void 0},a.CheckIfAlreadyFollowingProduct=function(){var b;for(i=0;i<a.ProductsFollowedFromSession.length;i++)a.ProductsFollowedFromSession[i].prodle==c.product_prodle&&(b=!0);return 1==b?{display:"none"}:{display:"inline"}},a.followCurrentProduct=function(){c.usersession.followProduct(c.product_prodle)};var o=a.$on("followProductDone",function(b,d){d.success?(c.ProdoAppMessage("You can start your product conversation","success"),e.productfollowlist.unshift(a.product),$("#prodo-followBtn").css("display","none")):d.error&&"AL001"==d.error.code&&c.showModal()});a.$on("$destroy",function(){o()}),a.formatDate=function(a){return moment(a).format("DD MMM YYYY")},a.showSearchCategories=function(){a.isCollapsedSearch=0},a.hideSearchCategories=function(){a.isCollapsedSearch=1}}]),angular.module("prodo.ProductApp").controller("ManageProductController",["$scope","$log","$rootScope","ProductService","UserSessionService","$http","CommentLoadMoreService","ENV","TagReffDictionaryService","ProductFeatureService","allproductdata","allproductCategories","$state","CategoryTags","allCommentTags",function(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p){a.$state=n,a.form={},a.editStatus,a.edit,a.category=[],a.commentcategory=[],a.product={product:[{}]},a.ErrMsging=0,a.newProduct={product:[{}]},a.listProductCategories={categoriesList:[],commenttagsList:[]},a.listCategory={productCategories:[]},a.productCategories=[],a.type="product",a.productlist=[],c.product_prodle,a.newProduct_ResponseProdle="",c.orgid,a.chckedIndexs=[],a.pImages_l={product_images:[{}]},a.currentProdle,a.currentOrgid,a.userIDFromSession,a.usernameFromSession,a.grpnameFromSession,a.orgnameFromSession,a.orgidFromSession,a.ProductsFollowedFromSession=[],a.socket,a.handleAllProductDataError=function(d){b.debug(JSON.stringify(d)),"AL001"==d.code?c.showModal():($("#prodo-ProductDetails").css("display","none"),a.ErrMsging=1,a.productlist=[],document.getElementById("ErrMsging").innerHTML="<br>Product not available ... Add new product<br><br>")},a.handleAllProductDataSuccess=function(d){a.productlist=d.success.product,0==a.productlist.length&&($("#prodo-ProductDetails").css("display","none"),a.ErrMsging=1,document.getElementById("ErrMsging").innerHTML="<br>Product not available ... Add new product<br><br>"),0!==a.productlist.length&&(b.debug("prodle "+a.productlist[0].prodle+"orgid "+a.orgidFromSession),a.currentProdle=a.productlist[0].prodle,a.currentOrgid=a.productlist[0].orgid,c.currentProdleRoot=a.productlist[0].prodle,""!==a.newProduct_ResponseProdle?(a.getProduct(a.newProduct_ResponseProdle,a.currentOrgid),a.newProduct_ResponseProdle=""):a.getProduct(a.currentProdle,a.currentOrgid))},a.$watch("$state.$current.locals.globals.allproductdata",function(b){b.error?a.handleAllProductDataError(b.error):a.handleAllProductDataSuccess(b)}),p.error?(a.listProductCategories.commenttagsList=["product","warranty"],b.debug(a.listProductCategories.commenttagsList)):p.success&&(a.listProductCategories.commenttagsList=p.success.commenttags,b.debug(a.listProductCategories.commenttagsList)),m.error?a.listProductCategories.categoriesList=["product","software"]:m.success&&(a.listProductCategories.categoriesList=m.success.categorytags),a.$watch("$state.$current.locals.globals.allproductCategories",function(b){b.error?a.listProductCategories.categoriesList=["product","software"]:b.success&&(a.listProductCategories.categoriesList=b.success.categorytags)}),a.getUserDetails=function(){c.usersession.currentUser.org?(a.grpnameFromSession=c.usersession.currentUser.org.grpname,a.orgidFromSession=c.usersession.currentUser.org.orgid,a.orgnameFromSession=c.usersession.currentUser.org.orgname):(a.grpnameFromSession="",a.orgnameFromSession="",a.orgidFromSession=""),a.userIDFromSession=c.usersession.currentUser.userid,a.usernameFromSession=c.usersession.currentUser.username,a.ProductsFollowedFromSession=e.productfollowlist},a.getUserDetails(),a.handleGetProductSuccess=function(b,d,e){$("#showHideAllchk").prop("checked",!1),$("#prodo-ProductDetails").css("display","block"),$("productExtraInfo").css("display","block"),a.ErrMsging=0,a.getProductFeatures(d,e),$("#prodo-ProductFeatureTable").css("display","table"),a.currentProdle=b.success.product.prodle,a.product=b.success.product,c.currentProdleRoot=b.success.product.prodle,a.productComments=b.success.product.product_comments,a.pImages_l=b.success.product.product_images,$("#prodo-addingProduct").text(a.product.status),c.usersession.currentUser.org&&1==c.usersession.currentUser.org.isAdmin&&(c.isAdminCheck=a.orgidFromSession===a.currentOrgid?!0:!1)},a.handleGetProductError=function(d){"AL001"==d.code?c.showModal():(b.debug(d.message),$("#prodo-ProductDetails").css("display","none"),a.ErrMsging=1,null!==document.getElementById("ErrMsging")&&(document.getElementById("ErrMsging").innerHTML="Product not available , please select product...."))},a.getProduct=function(c,e){d.getProduct({orgid:e,prodle:c},function(b){void 0==b.success?a.handleGetProductError(b.error):a.handleGetProductSuccess(b,c,e)},function(c){b.debug(c),$("#prodo-ProductDetails").css("display","none"),a.ErrMsging=1,document.getElementById("ErrMsging").innerHTML="Server Error:"+c.status})},a.handleSaveProductResponse=function(d){d.success?(c.ProdoAppMessage(d.success.message,"success"),a.disableEditor(),n.reload()):("AL001"==d.error.code&&c.showModal(),"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage(d.error.message,"error")):"AP001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage(d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage(d.error.message,"error")))},a.handleSaveProductFeatureResponse=function(d){d.success?(c.ProdoAppMessage(d.success.message,"success"),a.disableEditor(),n.reload()):("AL001"==d.error.code&&c.showModal(),"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage(d.error.message,"error")):"AP001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage(d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage(d.error.message,"error")))},a.addProduct=function(e){a.productForm.$invalid?a.productForm.submitted=!0:(a.productForm.$setPristine(),$("productExtraInfo").css("display","none"),a.ErrMsging=0,"add"==e?0==a.category.length?c.ProdoAppMessage("Please add category","error"):0==a.commentcategory.length?c.ProdoAppMessage("Please add comment tags","error"):(a.newProduct={product:{model_no:a.product.model_no,name:a.product.name,display_name:a.product.display_name,description:a.product.description,category:a.category,commentcategory:a.commentcategory}},b.debug(a.newProduct),1==c.usersession.currentUser.org.isAdmin?d.saveProduct({orgid:a.orgidFromSession},a.newProduct,function(b){b.success&&(a.newProduct_ResponseProdle=b.success.prodle,a.category=[],a.commentcategory=[],a.disableEditor(),$("#productExtraInfo").css("display","block")),a.handleSaveProductResponse(b)
},function(d){c.ProdoAppMessage(d,"error"),a.category=[],b.debug(d)}):c.ProdoAppMessage(data.error.message,"error")):"update"==e&&(0==a.product.category.length?c.ProdoAppMessage("Please add category","error"):0==a.product.commentcategory.length?c.ProdoAppMessage("Please add comment tags","error"):(a.newProduct={product:{model_no:a.product.model_no,name:a.product.name,description:a.product.description,support_discontinuation_date:a.product.support_discontinuation_date,sale_discontinuation_date:a.product.sale_discontinuation_date,banneddate:a.product.banneddate,display_name:a.product.display_name,category:a.product.category,commentcategory:a.product.commentcategory}},1==c.usersession.currentUser.org.isAdmin?a.orgidFromSession===a.currentOrgid&&d.updateProduct({orgid:a.orgidFromSession,prodle:a.currentProdle},a.newProduct,function(c){a.newProduct_ResponseProdle=a.currentProdle,b.debug("update......"+c),a.handleSaveProductResponse(c),a.getProduct(a.currentProdle,a.currentOrgid),a.disableEditor()},function(d){b.debug(d),a.editMode.editorEnabled=!0,c.ProdoAppMessage(d,"error")}):c.ProdoAppMessage("You dont have rights to update this product...","error"))))},a.handleDeleteProductSuccess=function(d){b.debug(JSON.stringify(d)),c.ProdoAppMessage("Product deleted successfully...","success"),a.editMode.editorEnabled=!1,$("#prodo-ProductDetails").css("display","none"),n.reload()},a.handleDeleteProductError=function(a){"AL001"==a.code?c.showModal():b.debug(a.message)},a.deleteProduct=function(){b.debug("Deleting product  ..."+a.currentProdle),c.ProdoAppMessage("Deleting product  ..."+a.currentProdle,"info"),(void 0!==a.currentProdle||null!==a.currentProdle||""!==a.currentProdle)&&(1==c.isAdminCheck?d.deleteProduct({orgid:a.orgidFromSession,prodle:a.currentProdle},function(b){b.success?a.handleDeleteProductSuccess(b):b.error&&a.handleDeleteProductError(b.error)},function(a){b.debug(JSON.stringify(a)),c.ProdoAppMessage(a,"error")}):c.ProdoAppMessage("You dont have rights to delete this product...","error"))},a.clearText=function(){a.product="",a.pImages_l="",a.features=""},a.selectAllImages=function(b){if($("#showHideAllchk").is(":checked"))for($(".imgToggles").prop("checked",!0),i=0;i<b.length;i++)a.chckedIndexs.push(b[i]);else $(".imgToggles").prop("checked",!1),a.chckedIndexs.length=0},a.checkedIndex=function(b){-1===a.chckedIndexs.indexOf(b)?a.chckedIndexs.push(b):a.chckedIndexs.splice(a.chckedIndexs.indexOf(b),1),$(".imgToggles").length==$(".imgToggles:checked").length?$("#showHideAllchk").prop("checked","checked"):$("#showHideAllchk").prop("checked",!1)},a.checkImageSelectedToDelete=function(){b.debug("Delete images......."),a.chckedIndexs.length>0?($("#imgDelModal").modal("toggle"),$("#imgDelModal").modal("show")):c.ProdoAppMessage("Select atlest 1 image to delete ","error")},a.checkAdminProductImagesDelete=function(){return 1==c.isAdminCheck?{display:"inline"}:{display:"none"}},a.handledeleteProductImagesSuccess=function(a){b.debug(a),c.ProdoAppMessage("Images deleted successfully...","success")},a.handledeleteProductImagesError=function(a){"AL001"==a.code?c.showModal():b.debug(a)},a.deleteProductImages=function(){1==c.isAdminCheck?(a.imgIds=[{}],a.ids,$(":checkbox:checked").each(function(b){a.imgIds[b]=$(this).val(),a.ids=$(this).val()}),angular.forEach(a.chckedIndexs,function(b){a.pImages_l.indexOf(b);a.pImages_l.splice(a.pImages_l.indexOf(b),1)}),a.chckedIndexs=[],a.temp={prodleimageids:a.imgIds},f({method:"DELETE",url:h.apiEndpoint_notSocket+"/api/image/product/"+a.orgidFromSession+"/"+a.currentProdle+"?prodleimageids="+a.imgIds}).success(function(b){b.success?a.handledeleteProductImagesSuccess(b.success):b.error&&a.handledeleteProductImagesError(b.error)}).error(function(a,b){c.ProdoAppMessage(b,"error")})):c.ProdoAppMessage("You dont have rights to delete images","error")},a.checkAdmintoUpdateProduct=function(){return c.usersession.currentUser.org?1==c.usersession.currentUser.org.isAdmin?a.orgidFromSession===a.currentOrgid?(c.isAdminCheck=!0,{display:"block"}):{display:"none"}:{display:"none"}:{display:"none"}},a.checkAdmin=function(){c.usersession.currentUser.org&&1==c.usersession.currentUser.org.isAdmin&&a.orgidFromSession===a.currentOrgid&&(c.isAdminCheck=!0),1==c.isAdminCheck?$("#prodo.productAdminAddProduct").css("display","inline"):1==c.usersession.currentUser.org.isAdmin?($("#prodo.productAdmin").css("display","none"),$("#prodo.productAdminAddProduct").css("display","inline")):($("#prodo.productAdmin").css("display","none"),$("#prodo.productAdminAddProduct").css("display","none"))},a.features=[],a.PFeatures=[],a.handleGetProductFeatureSuccess=function(b){for(a.features=[],a.featuretags=[],i=0;i<b.success.productfeature.length;i++)a.features.push(b.success.productfeature[i]),a.PFeatures.push(b.success.productfeature[i]),a.featuretags.push(b.success.productfeature[i].featurename)},a.handleGetProductFeatureError=function(a){"AL001"==a.code?c.showModal():b.debug(a)},a.getProductFeatures=function(b,d){""!==b&&k.getFeature({orgid:d,prodle:b},function(b){void 0==b.success?b.error&&a.handleGetProductFeatureError(b.error):a.handleGetProductFeatureSuccess(b)},function(a){c.ProdoAppMessage("Server Error:"+a.status,"error")})},a.handleDeleteFeatureSuccess=function(b,d){var e=a.features.indexOf(d);-1!=e&&a.features.splice(e,1),c.ProdoAppMessage(b.success.message,"success")},a.handleDeleteFeatureError=function(a){"AL001"==a.code?c.showModal():b.debug(a)},a.deleteFeature=function(d){(void 0!==d||null!==d||""!==d)&&(c.ProdoAppMessage("Deleting product feature ...","info"),1==c.isAdminCheck?k.deleteFeature({orgid:a.orgidFromSession,prodle:a.currentProdle,productfeatureid:d.featureid},function(b){b.success?a.handleDeleteFeatureSuccess(b,d):b.error&&a.handleDeleteFeatureError(b.error)},function(a){b.debug(JSON.stringify(a)),c.ProdoAppMessage(JSON.stringify(a),"error")}):c.ProdoAppMessage("You dont have rights to delete this feature...","error"))},a.addProductFeature=function(d){a.productFeaturesForm.$invalid?a.productFeaturesForm.submitted=!0:(a.newFeature={},a.newFeature={productfeature:[{featurename:a.featurename,featuredescription:a.featuredescription}]},a.disableEditorFeature(),a.productFeaturesForm.$setPristine(),b.debug(a.newFeature),(void 0!==a.newFeature||null!==a.newFeature||""!==a.newFeature)&&"add"==d&&(1==c.isAdminCheck?k.saveFeature({orgid:a.orgidFromSession,prodle:a.currentProdle},a.newFeature,function(c){a.newProduct_ResponseProdle=a.currentProdle,a.handleSaveProductFeatureResponse(c),b.debug("new Feature : "+JSON.stringify(a.newFeature.productfeature[0])),a.features.push(a.newFeature.productfeature[0]),a.featurename="",a.featuredescription="",b.debug(a.features),a.feature=""},function(d){a.enableFeatureErrorMsg(),ProdFERRMsg.innerHTML=d,c.ProdoAppMessage(d,"error"),b.debug(d)}):c.ProdoAppMessage("You dont have rights to add product feature...","error")))},a.updateProductFeature=function(d,e){a.productFeatureUpdate.$invalid?c.ProdoAppMessage("Please add valid information","error"):(void 0!==d||null!==d||""!==d)&&(1==c.isAdminCheck?k.updateFeature({orgid:a.orgidFromSession,prodle:a.currentProdle,productfeatureid:e},{productfeature:d},function(b){a.newProduct_ResponseProdle=a.currentProdle,a.handleSaveProductFeatureResponse(b)},function(a){b.debug(a),c.ProdoAppMessage(a,"error")}):c.ProdoAppMessage("You dont have rights to update product feature...","error"))},a.editMode={editorEnabled:!1,editorEnabledF:!1},a.enableEditor=function(){a.editMode.editorEnabled=!0,c.ProdoAppMessage("   Adding product data....","info")},a.disableEditor=function(){a.editMode.editorEnabled=!1,a.productForm.submitted=!1,a.feature="",a.commentcategory=[],a.category=[],void 0==a.currentProdle||null==a.currentProdle||""==a.currentProdle?($("#prodo-ProductDetails").css("display","none"),a.ErrMsging=1,document.getElementById("ErrMsging").innerHTML="<br>Product not available ... Add new product<br><br>"):(a.getProduct(a.currentProdle,a.currentOrgid),a.getProductFeatures(a.currentProdle,a.currentOrgid))},a.enableEditorFeature=function(){a.editMode.editorEnabledF=!0,c.ProdoAppMessage("   Adding product data....","info")},a.disableEditorFeature=function(){a.editMode.editorEnabledF=!1,a.productFeaturesForm.$setPristine(),a.productFeaturesForm.submitted=!1,a.featurename="",a.descriptio="",(void 0!==a.currentProdle||null!==a.currentProdle||""!==a.currentProdle)&&(a.getProduct(a.currentProdle,a.currentOrgid),a.getProductFeatures(a.currentProdle,a.currentOrgid))},$(document).ready(function(){1==c.isAdminCheck?($("#productLogoUpload").css("display","inline"),$("#productLogo").hover(function(){$("#productLogoUpload").show()},function(){setTimeout(function(){$("#productLogoUpload").hide()},3e3)})):$("#productLogoUpload").css("display","none")}),a.changeProduct=function(b){a.productForm.submitted=!1,a.productFeaturesForm.submitted=!1,a.feature="",a.currentProdle=b.prodle,a.currentOrgid=b.orgid,a.getProduct(a.currentProdle,a.currentOrgid),a.editMode.editorEnabled=!1,a.editMode.editorEnabledF=!1,$("#productExtraInfo").css("display","block")},a.getSelectedProduct=function(b){jQuery("#FileName").hide(),1==a.editMode.editorEnabled||1==a.editMode.editorEnabledF?($("#changeProductModal").modal("toggle"),$("#changeProductModal").modal("show"),$("#ChangeProductOkButton").on("click",function(){a.changeProduct(b)})):(a.currentProdle=b.prodle,a.currentOrgid=b.orgid,a.getProduct(a.currentProdle,a.currentOrgid))},a.currentPage=0,a.pageSize=4,a.numberOfPages=function(){return Math.ceil(a.productlist.length/a.pageSize)},a.selectedFeature,a.getSelectedFeature=function(b){a.selectedFeature=b},a.formatDate=function(a){return moment(a).format("DD MMM YYYY")};a.$on("productUploadResponseSuccess",function(){a.newProduct_ResponseProdle=a.currentProdle,n.reload()}),a.$on("productUploadLogoResponseSuccess",function(){a.newProduct_ResponseProdle=a.currentProdle,n.reload()})}]),angular.module("prodo.ProductApp").filter("startFrom",function(){return function(a,b){return void 0!==a||void 0!==b?(b=+b,a.slice(b)):void 0}}),angular.module("prodo.ProductApp").controller("ProductCommentController",["$scope","$log","$rootScope","ProductService","UserSessionService","$http","CommentLoadMoreService","ENV","TagReffDictionaryService","ProductFeatureService","isLoggedin","CommentService",function(a,b,c,d,e,f,g,h,j,k,l,m){function n(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function o(){return n()+"-"+n()+"-"+Date.now().toString()}a.deleteProductComment=function(c){c.user.userid==a.userIDFromSession&&(m.deleteComment({commentid:c.commentid},function(b){if(b.success){var d=a.productComments.indexOf(c);-1!=d&&a.productComments.splice(d,1),a.handleDeleteProductCommentSuccess(b)}else b.error&&a.handleDeleteProductCommentError(b.error)},function(a){b.debug(JSON.stringify(a))}),b.debug(c.commentid))},a.loadMoreComments=function(){$("#img-spinner").show();var c=a.getLastCommentId();(""!==c||" "!==c||void 0!==c||null!==c)&&g.loadMoreComments({commentid:c},function(b){a.handleLoadMoreCommentResponse(b),$("#img-spinner").hide()},function(a){b.debug(a),$("#loadMoreCommentMsg").css("display","block"),$("#loadMoreCommentMsg").html(a)})},$(document).ready(function(){var a,c;$("#prodo-comment-Textbox").on("blur mouseleave",function(){$(this).height(30),a=$("#prodo-comment-Textbox").height(),c=$("#prodo-comment-Textbox").width()}),$("#prodo-comment-Textbox").on("focus change keyup paste keypress click",function(){$(this).height(85),a=$("#prodo-comment-Textbox").height(),c=$("#prodo-comment-Textbox").width()}),$("#holder").hover(function(){a=$("#prodo-comment-Textbox").height(),c=$("#prodo-comment-Textbox").width(),document.getElementById("holder").style.height=a,document.getElementById("holder").style.width=c,c="",a=""},function(){b.debug("hovering out",$(this).attr("id")),a=$("#prodo-comment-Textbox").height(),c=$("#prodo-comment-Textbox").width(),document.getElementById("holder").style.height=a,document.getElementById("holder").style.width=c,c="",a=""}),c="",a=""}),a.count,localStorage.sid=c.usersession.currentUser.sessionid,(""!==localStorage.sid||" "!==localStorage.sid||void 0!==localStorage.sid||null!==localStorage.sid)&&(b.debug("Socket = "+h.apiEndpoint),a.socket=io.connect(h.apiEndpoint+h.port+"/api/prodoapp",{query:"session_id="+localStorage.sid})),a.commentError="",a.socket.removeAllListeners("addcommentResponse"),a.socket.on("addcommentResponse",function(d,e){d?(a.commentError=d.error.message,b.debug(d.error.message),c.ProdoAppMessage(d.error.message,"error"),a.showErrorIfCommentNotAdded(),a.showRetryIconIfCommentNotAdded()):e&&(a.ifErrorAddingComment=!1,a.commentError=!1,b.debug("addcommentResponse success"+JSON.stringify(e.success.product_comment)))}),a.productcommentResponseListener="productcommentResponse"+c.product_prodle,a.socket.removeAllListeners(a.productcommentResponseListener),a.socket.on(a.productcommentResponseListener,function(d,e){if(d)b.debug(d.error.message),c.ProdoAppMessage(d.error.message,"error");else if(e){b.debug("productcomment  Response success"+JSON.stringify(e.success.product_comment)),a.newProductComment={product_comment:{user:{userid:e.success.product_comment.user.userid,username:e.success.product_comment.user.username,orgname:e.success.product_comment.user.orgname,grpname:e.success.product_comment.user.grpname,profilepic:e.success.product_comment.user.profilepic},commentid:e.success.product_comment.commentid,type:e.success.product_comment.type,datecreated:e.success.product_comment.datecreated,commenttext:e.success.product_comment.commenttext,analytics:e.success.product_comment.analytics,commentcategory:e.success.product_comment.commentcategory}},c.productCommentResponsearray.push(a.newProductComment.product_comment),b.debug(c.productCommentResponsearray),a.count=c.productCommentResponsearray.length,b.debug(a.count);var f=document.getElementById("responseComment");f.style.display="inline",f.innerHTML=a.count+" new comments"}}),a.commenttextField.userComment="",a.getTagsFromCommentText=function(){a.mytags=a.pretags;var c=a.commenttextField.userComment,d=[];if(a.commenttextField.userComment)for(var e=c.split(" "),f=0;f<e.length;f++)for(var g=0;g<a.mytags.length;g++)e[f].toLowerCase()==a.mytags[g].toLowerCase()&&d.push(e[f]);a.mytags=d,a.myFeaturetags=a.featuretags;var d=[];if(a.commenttextField.userComment)for(var e=c.split(" "),f=0;f<e.length;f++)for(var g=0;g<a.myFeaturetags.length;g++)e[f].toLowerCase()==a.myFeaturetags[g].toLowerCase()&&d.push(e[f]);a.myFeaturetags=d,b.debug(a.mytags),b.debug(a.myFeaturetags)},a.$watch("commenttextField.userComment",function(){a.getTagsFromCommentText(),0==a.mytags.length?$("#prodo-productTags").css("display","none"):$("#prodo-productTags").css("display","inline")}),a.$watch("mytags",function(){a.mytags}),a.makeTagsPair=function(b,c){for(var d=0;d<c.length;d++)a.tagPairs.push(void 0==b[d]?{featurename:a.features[0].featurename,tag:c[d]}:{featurename:b[d],tag:c[d]})},a.handleAddProductComment=function(a){"AL001"==a.code?c.showModal():(b.debug(a),c.showModal())},a.addProductComment=function(){l.checkUserSession(function(d){if(void 0==d.success)d.error&&a.handleAddProductComment(d.error);else if(a.commentError=!1,""==a.commenttextField.userComment||void 0==a.commenttextField.userComment||null==a.commenttextField.userComment)c.ProdoAppMessage("You can not add blank comment","error");else{b.debug("tags "+a.mytags),b.debug("features "+a.myFeaturetags),a.makeTagsPair(a.myFeaturetags,a.mytags),b.debug("Pair : "+JSON.stringify(a.tagPairs)),b.debug(c.file_data),b.debug(c.comment_image_l);var e=o();""==c.file_data||" "==c.file_data||void 0==c.file_data||null==c.file_data?(a.newProductComment={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:e,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:a.commenttextField.userComment,analytics:a.tagPairs,commentcategory:a.commenttagSelected.tag}},a.newProductComment_image={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:e,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:a.commenttextField.userComment,analytics:a.tagPairs,commentcategory:a.commenttagSelected.tag}}):(a.newProductComment={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:e,type:a.type,datecreated:Date.now(),commenttext:a.commenttextField.userComment,tags:a.mytags,comment_image:c.file_data,analytics:a.tagPairs,commentcategory:a.commenttagSelected.tag}},a.newProductComment_image={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:e,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:a.commenttextField.userComment,comment_image:c.comment_image_l,analytics:a.tagPairs,commentcategory:a.commenttagSelected.tag}},c.file_data="");var f;for(i=0;i<a.ProductsFollowedFromSession.length;i++)a.ProductsFollowedFromSession[i].prodle==c.product_prodle&&(f=!0);1==f?(b.debug(a.newProductComment.product_comment),a.socket.emit("addComment",c.product_prodle,a.newProductComment.product_comment),void 0==a.productComments?(a.productComments=[],a.productComments.unshift(a.newProductComment_image.product_comment)):a.productComments.unshift(a.newProductComment_image.product_comment),a.commenttextField.userComment="",a.commenttagSelected.tag="general",a.tagPairs=[],c.count=0,document.getElementById("prodo-comment-commentContainer").style.marginTop="0px",document.getElementById("crossButton").style.display="none",$("#prodo-uploadedCommentImage").css("display","none"),a.mytags=""):c.ProdoAppMessage("Please talkin this product to start commenting...","error")}})},a.addProductCommentretry=function(d){l.checkUserSession(function(e){if(void 0==e.success)e.error&&a.handleAddProductComment(e.error);else{var f=o();""==c.file_data||" "==c.file_data||void 0==c.file_data||null==c.file_data?(a.newProductComment={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:f,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:d.commenttext,analytics:a.tagPairs,commentcategory:d.commentcategory}},a.newProductComment_image={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:f,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:d.commenttext,analytics:a.tagPairs,commentcategory:d.commentcategory}}):(a.newProductComment={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:f,type:a.type,datecreated:Date.now(),commenttext:d.commenttext,tags:a.mytags,comment_image:c.file_data,analytics:a.tagPairs,commentcategory:d.commentcategory}},a.newProductComment_image={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:f,type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:d.commenttext,comment_image:c.comment_image_l,analytics:a.tagPairs,commentcategory:d.commentcategory}},c.file_data=""),b.debug(a.newProductComment),a.socket.emit("addComment",c.product_prodle,a.newProductComment.product_comment),void 0==a.productComments?(a.productComments=[],a.productComments.unshift(a.newProductComment_image.product_comment)):(a.productComments.shift(),a.productComments.unshift(a.newProductComment_image.product_comment)),a.commenttextField.userComment="",a.commenttagSelected.tag="general",a.tagPairs=[],c.count=0,document.getElementById("prodo-comment-commentContainer").style.marginTop="0px",document.getElementById("crossButton").style.display="none",$("#prodo-uploadedCommentImage").css("display","none"),a.mytags=""}})},a.getLatestComments=function(){if(0!==c.productCommentResponsearray.length){b.debug(c.productCommentResponsearray),a.reversecomments_l=a.productCommentResponsearray.reverse(),b.debug(a.reversecomments_l),a.productComments=a.reversecomments_l.concat(a.productComments),b.debug(a.productComments);var d=document.getElementById("responseComment");d.style.display="none",d.innerHTML="",a.productCommentResponsearray.length=0,a.reversecomments_l.length=0,a.count=0}}}]),angular.module("prodo.ProductApp").factory("ProductService",["$resource",function(a){return a("/api/product/:orgid/:prodle",{},{getProduct:{method:"GET",params:{orgid:"id",prodle:"id"}},updateProduct:{method:"PUT",params:{orgid:"id",prodle:"id"},isArray:!1},deleteProduct:{method:"DELETE",params:{orgid:"id",prodle:"id"}},saveProduct:{method:"POST",params:{orgid:"id"}}})}]).factory("ProductFeatureService",["$resource",function(a){return a("/api/productfeature/:orgid/:prodle/:productfeatureid",{},{getFeature:{method:"GET",params:{orgid:"id",prodle:"id"}},updateFeature:{method:"PUT",params:{orgid:"id",prodle:"id",productfeatureid:"id"},isArray:!1},deleteFeature:{method:"DELETE",params:{orgid:"id",prodle:"id",productfeatureid:"id"}},saveFeature:{method:"POST",params:{orgid:"id",prodle:"id"}}})}]).factory("CommentService",["$resource",function(a){return a("/api/comment/:commentid",{},{deleteComment:{method:"DELETE",params:{commentid:"id"}}})}]).factory("CommentLoadMoreService",["$resource",function(a){return a("/api/nextcomments/:commentid",{},{loadMoreComments:{method:"GET",params:{commentid:"id"}}})}]).factory("TagReffDictionaryService",["$resource",function(a){return a("/api/tagreffdictionary/getAllTag",{},{getAllTags:{method:"GET"}})}]).factory("CategoryTags",["$resource",function(a){return a("/api/categorytags",{},{getCategoryTags:{method:"GET"}})}]).factory("CommentTags",["$resource",function(a){return a("/api/commenttags",{},{getCommentTags:{method:"GET"}})}]).factory("isLoggedin",["$resource",function(a){return a("/api/isloggedin",{},{checkUserSession:{method:"GET"}})}]).factory("ProductEnquiry",["$resource",function(a){return a("/api/productenquiry/:orgid/:prodle",{},{sendEnquiry:{method:"POST",params:{orgid:"id",prodle:"id"}}})}]),angular.module("prodo.WarrantyApp").controller("ManageWarrantyController",["$scope","$rootScope","$state","$http","$timeout","$log","WarrantyService","checkIfSessionExist","orgnameData","productnameData","warrantydata","fileReader","ENV","isLoggedin",function(a,b,c,d,e,f,g,h,j,k,l,m,n,o){a.$state=c,a.format="dd MMM yyyy";var p=moment().format("dd MMM yyyy");a.maxDatePurchase=moment(),$("#prodo_warranty_purchase_date").attr("max",p),$("#prodo_warranty_purchase_dateUpdate").attr("max",p),a.newWarranty_Responsewarranty_id="",a.editMode={editorEnabledWarranty:!1,editorEnabledWarrantyUpdate:!1},a.warranty={},a.type=["standard","extended"],a.editStatus,a.allOrgNames=[],a.allProductNames=[],a.form={},a.org={orgnamefromUser:"",orgidfromUser:""},a.product={productnamefromUser:"",productidfromUser:""},a.purchase_location={city:"",country:""},a.productOrgName={name:"",orgid:""},a.productallProductName={name:"",prodle:""},a.productwarranty={model_no:"",orgname:"",orgid:"",name:"",prodle:"",model_name:"",serial_no:"",purchase_date:"",purchase_period:"",purchase_location:{city:"",country:""},description:"",disclaimer:"",coverage:"",warranty_type:""},a.newWarranty={warrantydata:{}},a.warranties=[],a.fileLength,a.uploadSrc,a.progressbar=0,a.counter=0,a.file,b.currentclient={name:""},a.file_data={filetype:"",filename:"",filebuffer:""},a.action={},a.isValidImage=!1,a.invoiceimage,a.clearText=function(){a.productwarranty={},a.purchase_location={},a.org={},a.product={},a.productOrgName.name="",a.productallProductName.name="",a.file_data={},a.file={},a.file1="",a.isValidImage=!1,a.productwarranty.type=a.type[1]},a.open=function(b,c){b.preventDefault(),b.stopPropagation(),a[c]=!0},a.formatDate=function(a){return moment(a).format("DD MMM YYYY")},a.startsWith=function(a,b){return a.substr(0,b.length).toLowerCase()==b.toLowerCase()},a.handleDeleteWarrantyError=function(a){"AL001"==a.code?b.showModal():(b.ProdoAppMessage(a.message,"error"),f.debug(a.message))},a.handleDeleteWarrantySuccess=function(d){f.debug(JSON.stringify(d)),a.warranty={},b.ProdoAppMessage("Warranty deleted successfully...","success"),$("#prodo-ProductDetails").css("display","none"),c.reload()},a.deleteWarranty=function(){f.debug("Deleting"),a.warranty.userid==b.usersession.currentUser.userid?g.delete_warranty.deleteWarranty({userid:b.usersession.currentUser.userid,warrantyid:a.warranty.warranty_id},function(b){b.success?a.handleDeleteWarrantySuccess(b):b.error&&a.handleDeleteWarrantyError(b.error)},function(a){f.debug(JSON.stringify(a)),b.ProdoAppMessage(a,"error")}):b.ProdoAppMessage("You dont have rights to delete this warranty...","error")},a.handleAllWarrantyDataError=function(c){f.debug(JSON.stringify(c)),"AL001"==c.code?b.showModal():($("#prodo-ProductDetails").css("display","none"),$("#ErrMsging").css("display","block"),a.warranties=[],document.getElementById("ErrMsging").innerHTML="<br>Warranty not available ... Add new Warranty<br><br>")},a.handleAllWarrantyDataSuccess=function(b){a.warranties=b.success.Warranty,f.debug(b.success.Warranty),0==a.warranties.length&&($("#prodo-ProductDetails").css("display","none"),$("#ErrMsging").css("display","block"),document.getElementById("ErrMsging").innerHTML="<br>Warranty not available ... Add new Warranty<br><br>"),0!==a.warranties.length&&(a.currentWarrantyId=a.warranties[0].warranty_id,$("#ErrMsging").css("display","none"),""!==a.newWarranty_Responsewarranty_id?(a.getWarranty(a.newWarranty_Responsewarranty_id),a.newWarranty_Responsewarranty_id=""):a.getWarranty(a.currentWarrantyId))},a.$watch("$state.$current.locals.globals.warrantydata",function(b){b.error?a.handleAllWarrantyDataError(b.error):a.handleAllWarrantyDataSuccess(b)}),a.currentPage=0,a.pageSize=3,a.numberOfPages=function(){return Math.ceil(a.warranties.length/a.pageSize)},f.debug(l),a.getAllWarranties=function(){l.success&&(a.warranties=l.success.Warranty,f.debug("warranties: "+a.warranties))},a.getAllWarranties(),a.getAllOrgNames=function(){j.success&&(a.allOrgNames=j.success.OrgNames)},a.getAllOrgNames(),a.getAllProductNames=function(){k.success&&(a.allProductNames=k.success.product)},a.getAllProductNames(),a.changeWarranty=function(){a.form.WarrantyForm.submitted=!1,a.form.WarrantyFormUpdate.submitted=!1,a.getWarranty(a.currentWarrantyId),a.editMode.editorEnabledWarranty=!1,a.editMode.editorEnabledWarrantyUpdate=!1},a.handleGetWarrantyError=function(a){"AL001"==a.code?b.showModal():b.ProdoAppMessage(a.message,"error")},a.handleGetWarrantySuccess=function(c){c.success&&f.debug(c.success),$("#prodo-ProductDetails").css("display","block"),a.warranty=c.success.Warranty,b.Upload_warranty_id=a.warranty.warranty_id},a.getWarranty=function(c){g.get_warranty.getWarrantyDetail({userid:b.usersession.currentUser.userid,warrantyid:c},function(b){void 0==b.success?a.handleGetWarrantyError(b.error):a.handleGetWarrantySuccess(b,c)},function(a){f.debug(a),b.ProdoAppMessage(a.status,"error")})},a.getSelectedWarranty=function(b){1==a.editMode.editorEnabledWarranty||1==a.editMode.editorEnabledWarrantyUpdate?($("#changeWarrantyModal").modal("toggle"),$("#changeWarrantyModal").modal("show"),$("#ChangeWarrantyOkButton").on("click",function(){a.changeWarranty(b)})):(a.currentWarrantyId=b.warranty_id,a.currentWarrantyId==a.warranty.warranty_id||a.getWarranty(a.currentWarrantyId))},a.getNextDateDiffMonths=function(b,c){return a.nextdate=moment(b).add("M",c).calendar(),f.debug(a.nextdate),a.nextdate},a.getNewWarrantyData=function(){a.expdate=a.getNextDateDiffMonths(a.productwarranty.purchase_date,a.productwarranty.purchase_period),a.orgnamefromUser,a.productOrgName.name.name?(a.org.orgnamefromUser=a.productOrgName.name.name,a.org.orgidfromUser=a.productOrgName.name.orgid):(a.org.orgnamefromUser=a.productOrgName.name,a.org.orgidfromUser=""),a.productallProductName.name.name?(a.product.productnamefromUser=a.productallProductName.name.name,a.product.productidfromUser=a.productallProductName.name.prodle):(a.product.productnamefromUser=a.productallProductName.name,a.product.productidfromUser=""),a.newWarranty={warrantydata:{orgname:a.org.orgnamefromUser,orgid:a.org.orgidfromUser,name:a.product.productnamefromUser,prodle:a.product.productidfromUser,model_no:a.productwarranty.model_no,model_name:a.productwarranty.model_name,serial_no:a.productwarranty.serial_no,purchase_date:a.productwarranty.purchase_date,expirydate:a.expdate,purchase_location:{city:a.purchase_location.city,country:a.purchase_location.country},userid:b.usersession.currentUser.userid,description:a.productwarranty.description,disclaimer:a.productwarranty.disclaimer,coverage:a.productwarranty.coverage,warranty_type:a.productwarranty.type}}},a.addWarranty=function(){o.checkUserSession(function(c){c.error?a.handleUploadError(c.error):a.form.WarrantyForm.$invalid?(a.form.WarrantyForm.submitted=!0,f.debug("Invalid data"),a.productwarranty.purchase_date>a.maxDatePurchase&&(f.debug("Wrong purchase_date"),b.ProdoAppMessage("Purchase date should not be greater than todays date. Please Enter correct purchase date","error"))):(a.getNewWarrantyData(),f.debug(a.newWarranty),1==a.isValidImage?(a.socket.emit("addWarranty",b.usersession.currentUser.userid,a.newWarranty.warrantydata,a.file_data),f.debug("data emitted")):(f.debug("Upload invoice image"),b.ProdoAppMessage("Invoice is mandatory. Please upload the scanned image , digital or pdf of invoice...","error")))})},a.handleUpdateWarrantySuccess=function(d){d.success&&(b.ProdoAppMessage("Warranty updated successfully","success"),f.debug(d.success),a.disableEditorFeatureUpdate(),a.newWarranty_Responsewarranty_id=a.warranty.warranty_id,c.reload())},a.handleUpdateWarrantyError=function(c){"AL001"==c.code?b.showModal():(a.enableEditorFeatureUpdate(),f.debug(c.message))},a.org_l={orgnamefromUser:"",orgidfromUser:""},a.product_l={productnamefromUser:"",productidfromUser:""},a.updatedWarranty={},a.getOrgProductDetailsForUpdate=function(){for(a.warranty.orgname.name?(a.org_l.orgnamefromUser=a.warranty.orgname.name,a.org_l.orgidfromUser=a.warranty.orgname.orgid):(a.org_l.orgnamefromUser=a.warranty.orgname,a.org_l.orgidfromUser=""),a.warranty.name.name?(a.product_l.productnamefromUser=a.warranty.name.name,a.product_l.productidfromUser=a.warranty.name.prodle):(a.product_l.productnamefromUser=a.warranty.name,a.product_l.productidfromUser=""),i=0;i<a.allOrgNames.length-1;i++)a.warranty.orgname==a.allOrgNames[i].name&&(a.org_l.orgnamefromUser=a.allOrgNames[i].name,a.org_l.orgidfromUser=a.allOrgNames[i].orgid);for(i=0;i<a.allProductNames.length-1;i++)a.warranty.name==a.allProductNames[i].name&&(a.product_l.productnamefromUser=a.allProductNames[i].name,a.product_l.productidfromUser=a.allProductNames[i].prodle);a.updatedWarranty={warrantydata:{orgname:a.org_l.orgnamefromUser,orgid:a.org_l.orgidfromUser,name:a.product_l.productnamefromUser,prodle:a.product_l.productidfromUser,model_no:a.warranty.model_no,model_name:a.warranty.model_name,serial_no:a.warranty.serial_no,purchase_date:a.warranty.purchase_date,expirydate:a.warranty.expirydate,purchase_location:{city:a.warranty.purchase_location.city,country:a.warranty.purchase_location.country},description:a.warranty.description,disclaimer:a.warranty.disclaimer,coverage:a.warranty.coverage,warranty_type:a.warranty.warranty_type}}},a.updateWarranty=function(){f.debug(a.warranty),a.form.WarrantyFormUpdate.$invalid?(a.form.WarrantyFormUpdate.submitted=!0,f.debug("Invalid data"),a.warranty.purchase_date>a.maxDatePurchase&&(f.debug("Wrong purchase_date"),b.ProdoAppMessage("Purchase date should not be greater than todays date. Please Enter correct purchase date","error")),a.warranty.expirydate<a.warranty.purchase_date&&(f.debug("Wrong expiry date"),b.ProdoAppMessage("Expiry date should not be greater than purchase date. Please Enter correct expiry date","error"))):(a.getOrgProductDetailsForUpdate(),f.debug(a.updatedWarranty),g.update_warranty.updateWarranty({userid:b.usersession.currentUser.userid,warrantyid:a.warranty.warranty_id},a.updatedWarranty,function(b){b.success?a.handleUpdateWarrantySuccess(b):b.error&&a.handleUpdateWarrantyError(b.error)
},function(a){f.debug(a)}))},a.disableEditorFeatureUpdate=function(){a.editMode.editorEnabledWarrantyUpdate=!1,a.form.WarrantyFormUpdate.submitted=!1,a.warranty.warranty_id&&a.getWarranty(a.warranty.warranty_id)},a.enableEditorFeatureUpdate=function(){a.form.WarrantyFormUpdate.$setPristine(),a.editMode.editorEnabledWarrantyUpdate=!0},a.disableEditorFeature=function(){a.editMode.editorEnabledWarranty=!1,a.form.WarrantyForm.submitted=!1,a.warranty.warranty_id&&a.getWarranty(a.warranty.warranty_id),a.clearText()},a.enableEditorFeature=function(){1==a.editMode.editorEnabledWarranty||1==a.editMode.editorEnabledWarrantyUpdate?($("#addWarrantyModal").modal("toggle"),$("#addWarrantyModal").modal("show"),$("#addWarrantyOkButton").on("click",function(){a.form.WarrantyForm.$setPristine(),a.editMode.editorEnabledWarranty=!0,a.disableEditorFeatureUpdate()})):(a.form.WarrantyForm.$setPristine(),a.editMode.editorEnabledWarranty=!0)},a.socket=io.connect(n.apiEndpoint+n.port+"/api/prodoupload",{query:"session_id="+b.usersession.currentUser.sessionid}),a.handleUploadError=function(a){$("#bar").hide(),"AL001"==a.code?b.showModal():(f.debug(a),b.showModal())},a.getFile=function(c){o.checkUserSession(function(d){void 0==d.success?d.error&&a.handleUploadError(d.error):(a.progressbar=0,f.debug("getFile called ... "+c),m.readAsBinaryString(c,a).then(function(d){f.debug("reader called ... "+c);a.imageBfr=d,a.file=c,a.file_data={filetype:a.file.type,filename:a.file.name,filebuffer:a.imageBfr},"image/jpg"==a.file.type||"image/png"==a.file.type||"image/gif"==a.file.type||"image/jpeg"==a.file.type||"application/pdf"==a.file.type?a.file.size/1024<2048?a.isValidImage=!0:(f.debug("Image size must ne less than 2MB"),b.ProdoAppMessage("Image size must ne less than 2MB","error"),$("#EditWarranty")[0].reset()):(b.ProdoAppMessage("Please upload invoice of correct format ","error"),$("#EditWarranty")[0].reset())}))})},a.socket.removeAllListeners("addWarrantyResponse"),a.socket.on("addWarrantyResponse",function(b,c){a.warrantyResponseHandler(b,c)}),a.warrantyResponseHandler=function(d,e){$("#EditWarranty")[0].reset(),d?"AP003"==d.error.code?(f.debug(d.error.code+" "+d.error.message),b.ProdoAppMessage(d.error.message,"error")):"AV001"==d.error.code?(f.debug(d.error.code+" "+d.error.message),b.ProdoAppMessage(d.error.message,"error")):(f.debug(d.error.message),b.ProdoAppMessage(d.error.message,"error")):(a.imageSrc=JSON.stringify(e.success.invoiceimage),f.debug(JSON.stringify(e.success)),f.debug("Emit"),b.$broadcast("productUploadResponseSuccess","success"),b.ProdoAppMessage("Warranty added successfully","success"),c.reload(),a.newWarranty_Responsewarranty_id=e.success.warranty_id,a.counter++,f.debug(a.counter),a.counter<a.fileLength||(a.counter=0),a.clearText(),$("#EditWarranty")[0].reset(),a.disableEditorFeature())};a.$on("warrantyUploadLogoResponseSuccess",function(){a.newWarranty_Responsewarranty_id=a.warranty.warranty_id,c.reload()});a.countries=["Afghanistan","Albania","Algeria","American Samoa","Andorra","Angola","Anguilla","Antigua and Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia","Bosnia-Herzegovina","Botswana","Bouvet Island","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Cayman Islands","Central African Republic","Chad","Chile","China","Christmas Island","Cocos (Keeling) Islands","Colombia","Comoros","Congo, Democratic Republic of the (Zaire)","Congo, Republic of","Cook Islands","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Falkland Islands","Faroe Islands","Fiji","Finland","France","French Guiana","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guadeloupe (French)","Guam (USA)","Guatemala","Guinea","Guinea Bissau","Guyana","Haiti","Holy See","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Ivory Coast (Cote D`Ivoire)","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macau","Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Martinique (French)","Mauritania","Mauritius","Mayotte","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","Netherlands Antilles","New Caledonia (French)","New Zealand","Nicaragua","Niger","Nigeria","Niue","Norfolk Island","North Korea","Northern Mariana Islands","Norway","Oman","Pakistan","Palau","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Pitcairn Island","Poland","Polynesia (French)","Portugal","Puerto Rico","Qatar","Reunion","Romania","Russia","Rwanda","Saint Helena","Saint Kitts and Nevis","Saint Lucia","Saint Pierre and Miquelon","Saint Vincent and Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Georgia and South Sandwich Islands","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Svalbard and Jan Mayen Islands","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste (East Timor)","Togo","Tokelau","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Turks and Caicos Islands","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Virgin Islands","Wallis and Futuna Islands","Yemen","Zambia","Zimbabwe"],a.cities=["Port Blair","Hyderabad","Itanagar","Dispur","Patna","Silvassa","Daman","Delhi","Gandhinagar","Chandigarh","Ranchi","Bengaluru","Thiruvananthapuram","Kavaratti","Bhopal","Imphal","Shillong","Aizwal","Kohima","Bhubaneshwar","Puducherry","Chandigarh","Jaipur","Agartala","Mumbai","Lucknow","Kolkata","Panaji","Pune"]}]),angular.module("prodo.WarrantyApp").filter("startFrom",function(){return function(a,b){return void 0!==a||void 0!==b?(b=+b,a.slice(b)):void 0}}),angular.module("prodo.WarrantyApp").controller("ProdoWallWarrantyController",["$scope","$rootScope","$state","$http","$timeout","$log","growl","WarrantyService","GetWarrantyService","checkIfSessionExist","warrantydata",function(a,b,c,d,e,f,g,h,i,j,k){a.warranties=[],j.success&&k.success&&a.$watch("$state.$current.locals.globals.warrantydata",function(b){a.warranties=b.success.Warranty}),a.handleGetMoreWarrantiesResponse=function(c){if(c.success){console.log(c.success.warranty);for(var d=0;d<c.success.warranty.length;d++){if(c.success.warranty[d])var e=c.success.warranty[d];a.warranties.push(e)}b.ProdoAppMessage(c.success.message,"success")}else f.debug(c.error.message),b.ProdoAppMessage(c.error.message,"error");a.hideSpinner()},a.loadWarranties=function(){a.showSpinner();var b=a.warranties.length-1;a.WarrantyId=a.warranties[b].warranty_id,i.getMoreWarranties(a.WarrantyId)};var l=a.$on("getMoreWarrantiesDone",function(b,c){a.handleGetMoreWarrantiesResponse(c)}),m=a.$on("getMoreWarrantiesNotDone",function(c,d){a.hideSpinner(),b.ProdoAppMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+d,"error")});a.$on("$destroy",function(){l(),m()})}]),angular.module("prodo.WarrantyApp").factory("WarrantyService",["$resource",function(a){var b={add_warranty:a("/api/warranty/:userid",{},{addWarrantyDetail:{method:"POST"},headers:{"Content-Type":"multipart/form-data"}}),get_warranty:a("/api/warranty/:userid/:warrantyid",{},{getWarrantyDetail:{method:"GET"}}),get_allwarranties:a("/api/warranty/:userid",{},{getAllWarrantyDetails:{method:"GET"}}),get_latest5warranties:a("/api/latestwarranty/:userid",{},{getLatestWarrantyDetails:{method:"GET"}}),update_warranty:a("/api/warranty/:userid/:warrantyid",{},{updateWarranty:{method:"PUT"}}),delete_warranty:a("/api/warranty/:userid/:warrantyid",{},{deleteWarranty:{method:"DELETE"}})};return b}]).factory("GetWarrantyService",["$rootScope","$resource","$http","$state","$log",function(a,b,c,d,e){var f={get_next5warranties:b("/api/nextwarranties/:userid/:warrantyid",{},{getNextWarrantyDetails:{method:"GET",params:{userid:"@userid",warrantyid:"@warrantyid"}}})},g={};return g.getMoreWarranties=function(b){f.get_next5warranties.getNextWarrantyDetails({userid:a.usersession.currentUser.userid,warrantyid:b},function(b){e.debug(b),a.$broadcast("getMoreWarrantiesDone",b)},function(b){e.debug(b),a.$broadcast("getMoreWarrantiesNotDone",b.status)})},g}]).factory("OrgnameService",["$resource",function(a){return a("/api/orgnames",{},{getOrgname:{method:"GET"}})}]).factory("ProductnameService",["$resource",function(a){return a("/api/productname",{},{getProductname:{method:"GET"}})}]),angular.module("prodo.WarrantyApp").directive("ngFileSelectdata",["fileReader",function(){return{link:function(a,b){b.bind("change",function(b){a.file=(b.srcElement||b.target).files,a.fileLength=(b.srcElement||b.target).files,a.file=(b.srcElement||b.target).files,a.getFile(a.file[0])})}}}]),function(a){var b=function(a){var b=function(a,b,c){return function(){c.$apply(function(){b.resolve(a.result)})}},c=function(a,b,c){return function(){c.$apply(function(){b.reject(a.result)})}},d=function(a,b){return function(a){b.$broadcast("fileProgress",{total:a.total,loaded:a.loaded})}},e=function(a,e){var f=new FileReader;return f.onload=b(f,a,e),f.onerror=c(f,a,e),f.onprogress=d(f,e),f},f=function(b,c){var d=a.defer(),f=e(d,c);return f.readAsBinaryString(b),d.promise};return{readAsBinaryString:f}};a.factory("fileReader",["$q","$log",b])}(angular.module("prodo.WarrantyApp")),angular.module("prodo.UploadApp").controller("UploadController",["$scope","$log","$rootScope","fileReader","ENV","isLoggedin",function(a,b,c,d,e,f){a.socket=io.connect(e.apiEndpoint+e.port+"/api/prodoupload",{query:"session_id="+c.usersession.currentUser.sessionid}),a.fileLength,a.uploadSrc,a.progressbar=0,a.counter=0,c.currentclient={name:""},a.handleUploadError=function(a){$("#bar").hide(),"AL001"==a.code?c.showModal():(b.debug(a),c.showModal())},a.getFile=function(e){f.checkUserSession(function(f){void 0==f.success?f.error&&a.handleUploadError(f.error):(a.progressbar=0,b.debug("source: "+a.uploadSrc),b.debug("getFile called ... "+e),d.readAsBinaryString(e,a).then(function(d){b.debug("reader called ... "+e);var f;a.imageBfr=d,a.file=e;var g={filetype:a.file.type,filename:a.file.name,filebuffer:a.imageBfr};"image/jpg"==a.file.type||"image/png"==a.file.type||"image/gif"==a.file.type||"image/jpeg"==a.file.type?"user"==a.uploadSrc?a.file.size/1024<500?f={user:{userid:c.usersession.currentUser.userid}}:(c.ProdoAppMessage(" Image size must ne less than 500KB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploaduser")[0].reset()):"product"==a.uploadSrc?a.file.size/1024<2048?f={product:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid,prodle:c.currentProdleRoot}}:(c.ProdoAppMessage(" Image size must ne less than 2MB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadproduct")[0].reset()):"orgkeyclient"==a.uploadSrc?a.file.size/1024<2048?c.currentclient.name?f={orgkeyclient:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid,clientname:c.currentclient.name}}:(c.ProdoAppMessage("Please enter key client name","error"),$("#spinner").hide(),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadorgkeyclient")[0].reset()):(c.ProdoAppMessage("Image size must ne less than 2MB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadorgkeyclient")[0].reset()):"campaign"==a.uploadSrc?a.file.size/1024<2048?f={campaign:{userid:c.usersession.currentUser.userid,campaign_id:c.campaign_id}}:(c.ProdoAppMessage("Image size must ne less than 2MB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadcampaign")[0].reset()):"campaignBannerUpdate"==a.uploadSrc?a.file.size/1024<2048?f={campaign:{userid:c.usersession.currentUser.userid,campaign_id:c.campaign_id,orgid:c.usersession.currentUser.org.orgid,prodle:c.campaign_prodle,campaignbanner:""}}:(c.ProdoAppMessage("Image size must ne less than 2MB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadcampaignBannerUpdate")[0].reset()):"warranty"==a.uploadSrc?a.file.size/1024<2048?f={warranty:{userid:c.usersession.currentUser.userid,warranty_id:c.Upload_warranty_id}}:(c.ProdoAppMessage("Image size must ne less than 2MB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadwarranty")[0].reset()):"org"==a.uploadSrc?a.file.size/1024<2048?f={org:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid}}:(c.ProdoAppMessage("Image size must ne less than 2MB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadorg")[0].reset()):"productlogo"==a.uploadSrc?a.file.size/1024<1024?f={productlogo:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid,prodle:c.currentProdleRoot}}:(c.ProdoAppMessage("Image size must ne less than 1MB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadproductlogo")[0].reset()):"orglogo"==a.uploadSrc&&(a.file.size/1024<1024?f={orglogo:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid}}:(c.ProdoAppMessage("Image size must ne less than 1MB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadorglogo")[0].reset())):"productdata"==a.uploadSrc?a.file.size/1024<10240?f={product:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid,prodle:c.currentProdleRoot}}:(c.ProdoAppMessage("Image size must ne less than 10MB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadproductdata")[0].reset()):"org"==a.uploadSrc?a.file.size/1024<10240?f={org:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid}}:(c.ProdoAppMessage("Image size must ne less than 1MB","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadorg")[0].reset()):"warranty"==a.uploadSrc?"application/pdf"==a.file.type?f={warranty:{userid:c.usersession.currentUser.userid,warranty_id:c.Upload_warranty_id}}:(c.ProdoAppMessage("Invoive can be image or pdf only","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),$("#fileInputsUploadorg")[0].reset()):(c.ProdoAppMessage("Please upload file of images type...","error"),$("#bar").hide(),setTimeout(function(){jQuery("#FileName").hide()},1e3),"org"==a.uploadSrc&&$("#fileInputsUploadorg")[0].reset(),"orglogo"==a.uploadSrc&&$("#fileInputsUploadorglogo")[0].reset(),"productlogo"==a.uploadSrc&&$("#fileInputsUploadproductlogo")[0].reset(),"product"==a.uploadSrc&&$("#fileInputsUploadproduct")[0].reset(),"productdata"==a.uploadSrc&&$("#fileInputsUploadproductdata")[0].reset(),"warranty"==a.uploadSrc&&$("#fileInputsUploadwarranty")[0].reset(),"campaign"==a.uploadSrc&&$("#fileInputsUploadcampaign")[0].reset(),"orgkeyclient"==a.uploadSrc&&$("#fileInputsUploadorgkeyclient")[0].reset(),"user"==a.uploadSrc&&$("#fileInputsUploaduser")[0].reset(),"campaignBannerUpdate"==a.uploadSrc&&$("#fileInputsUploadcampaignBannerUpdate")[0].reset()),a.socket.emit("uploadFiles",g,f),b.debug("pic emitted")}))})},a.socket.removeAllListeners("productUploadResponse"),a.socket.on("productUploadResponse",function(b,c){a.productUploadResponseHandler(b,c)}),a.socket.removeAllListeners("orgKeyClientResponse"),a.socket.on("orgKeyClientResponse",function(b,c){a.orgKeyClientResponseHandler(b,c)}),a.socket.removeAllListeners("campaignUploadResponse"),a.socket.on("campaignUploadResponse",function(b,c){a.campaignUploadResponseHandler(b,c)}),a.socket.removeAllListeners("warrantyUploadResponse"),a.socket.on("warrantyUploadResponse",function(b,c){a.warrantyUploadResponseHandler(b,c)}),a.socket.removeAllListeners("productUploadLogoResponse"),a.socket.on("productUploadLogoResponse",function(b,c){a.productUploadLogoResponseHandler(b,c)}),a.socket.removeAllListeners("orgUploadResponse"),a.socket.on("orgUploadResponse",function(b,c){a.orgUploadResponseHandler(b,c)}),a.socket.removeAllListeners("orgUploadLogoResponse"),a.socket.on("orgUploadLogoResponse",function(b,c){a.orgUploadLogoResponseHandler(b,c)}),a.socket.removeAllListeners("userUploadResponse"),a.socket.on("userUploadResponse",function(b,c){a.userUploadResponseHandler(b,c)}),a.socket.removeAllListeners("campaignBannerUploadResponse"),a.socket.on("campaignBannerUploadResponse",function(b,c){a.campaignBannerUploadResponseHandler(b,c)}),a.productUploadResponseHandler=function(d,e){if($("#fileInputsUploadproduct")[0].reset(),$("#spinner").hide(),d)"AP003"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error"));else{a.imageSrc=JSON.stringify(e),b.debug(JSON.stringify(e.success.filename)),b.debug("Emit");var f=e.success.filename.replace(/ /g,"");document.getElementById("check"+f).style.color="#01DF74",c.$broadcast("productUploadResponseSuccess","success"),b.debug("getting response for product upload  "+a.imageSrc),c.ProdoAppMessage(f+"  uploaded successfully...","success"),a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0}setTimeout(function(){jQuery("#FileName").hide()},1e3)},a.campaignUploadResponseHandler=function(d,e){if($("#fileInputsUploadcampaign")[0].reset(),$("#spinner").hide(),d)"AP003"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error"));else{a.imageSrc=JSON.stringify(e),b.debug(JSON.stringify(e.success.filename)),b.debug("Emit");var f=e.success.filename.replace(/ /g,"");document.getElementById("check"+f).style.color="#01DF74",c.$broadcast("campaignUploadResponseSuccess","success"),b.debug("getting response for campaign upload  "+a.imageSrc),c.ProdoAppMessage(f+"  uploaded successfully...","success"),a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0}setTimeout(function(){jQuery("#FileName").hide()},1e3)},a.campaignBannerUploadResponseHandler=function(d,e){if($("#fileInputsUploadcampaignBannerUpdate")[0].reset(),$("#spinner").hide(),d)"AP003"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error"));else{a.imageSrc=JSON.stringify(e),b.debug(JSON.stringify(e.success.filename)),b.debug("Emit");var f=e.success.filename.replace(/ /g,"");document.getElementById("check"+f).style.color="#01DF74",c.$broadcast("campaignBannerUploadResponseSuccess","success"),b.debug("getting response for campaign upload  "+a.imageSrc),c.ProdoAppMessage(f+"  uploaded successfully...","success"),a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0}setTimeout(function(){jQuery("#FileName").hide()},1e3)},a.warrantyUploadResponseHandler=function(d,e){if($("#fileInputsUploadwarranty")[0].reset(),$("#spinner").hide(),d)"AP003"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error"));else{a.imageSrc=JSON.stringify(e),b.debug(JSON.stringify(e.success.filename)),b.debug("Emit");var f=e.success.filename.replace(/ /g,"");document.getElementById("check"+f).style.color="#01DF74",c.$broadcast("warrantyUploadLogoResponseSuccess","success"),b.debug("getting response for warranty upload  "+a.imageSrc),c.ProdoAppMessage(f+"  uploaded successfully...","success"),a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0}setTimeout(function(){jQuery("#FileName").hide()},1e3)},a.orgKeyClientResponseHandler=function(d,e){if($("#fileInputsUploadorgkeyclient")[0].reset(),$("#spinner").hide(),d)"AP003"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error"));else{a.imageSrc=JSON.stringify(e),b.debug(JSON.stringify(e.success.filename)),b.debug("Emit");var f=e.success.filename.replace(/ /g,"");document.getElementById("check"+f).style.color="#01DF74",c.$broadcast("orgKeyClientResponseSuccess","success"),b.debug("getting response for orgKeyClient upload  "+a.imageSrc),c.ProdoAppMessage(f+"  uploaded successfully...","success"),a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0}setTimeout(function(){jQuery("#FileName").hide()},1e3)},a.productUploadLogoResponseHandler=function(d,e){if($("#fileInputsUploadproductlogo")[0].reset(),$("#spinner").hide(),d)"AP003"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error"));else{a.imageSrc=JSON.stringify(e),b.debug("Emit");var f=e.success.filename.replace(/ /g,"");document.getElementById("check"+f).style.color="#01DF74",c.$broadcast("productUploadLogoResponseSuccess","success"),b.debug("getting response for logo upload  "+a.imageSrc),c.ProdoAppMessage(f+"  uploaded successfully...","success"),a.imageSrc=e,a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0}setTimeout(function(){jQuery("#FileName").hide()},1e3)},a.orgUploadResponseHandler=function(d,e){if($("#fileInputsUploadorg")[0].reset(),$("#spinner").hide(),d)"AP003"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error"));else{b.debug("getting response for org upload  "+e),c.$broadcast("orgUploadResponseSuccess","success"),c.ProdoAppMessage(" File uploaded successfully...","success");var f=e.success.filename.replace(/ /g,"");document.getElementById("check"+f).style.color="#01DF74",a.imageSrc=e,a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0}setTimeout(function(){jQuery("#FileName").hide()},1e3)},a.orgUploadLogoResponseHandler=function(d,e){if($("#fileInputsUploadorglogo")[0].reset(),$("#spinner").hide(),d)"AP003"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error"));else{b.debug("getting response for org upload logo "+e),console.log("Emitting"),c.$broadcast("orgUploadLogoResponseSuccess","success");var f=e.success.filename.replace(/ /g,"");document.getElementById("check"+f).style.color="#01DF74",c.ProdoAppMessage("File uploaded successfully...","success"),a.imageSrc=e,a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0}setTimeout(function(){jQuery("#FileName").hide()},1e3)},a.userUploadResponseHandler=function(d,e){if($("#fileInputsUploaduser")[0].reset(),$("#spinner").hide(),d)"AP003"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):"AV001"==d.error.code?(b.debug(d.error.code+" "+d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error")):(b.debug(d.error.message),c.ProdoAppMessage("Error while uploading "+a.file.name+" "+d.error.message,"error"));else{b.debug("getting response for user upload  "+e),c.$broadcast("userUploadResponseSuccess","success"),c.ProdoAppMessage("File uploaded successfully...","success");var f=e.success.filename.replace(/ /g,"");document.getElementById("check"+f).style.color="#01DF74",a.imageSrc=e,a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0}setTimeout(function(){jQuery("#FileName").hide()},1e3)},a.filess=[]}]),angular.module("prodo.UploadApp").directive("ngFileSelect",["fileReader",function(){return{link:function(b,c){c.bind("change",function(c){b.file=(c.srcElement||c.target).files,b.filess=b.file,document.getElementById("FileName").innerHTML="",b.fileLength=(c.srcElement||c.target).files,b.file=(c.srcElement||c.target).files;for(var d=function(b){var c=document.getElementById("FileName");$("#FileName").show();var d=document.createElement("span");d.className="prodo-right-check glyphicon glyphicon-ok";var e="check"+b.name.replace(/ /g,"");d.id=e,c.appendChild(d);var f=document.createElement("label");f.type="label";var g=document.createTextNode(" "+b.name);f.appendChild(g),f.name="label",f.setAttribute("style","text-align:left"),c.appendChild(f),c.setAttribute("style","text-align:left"),c.style.width="500px";var h=document.createElement("span");h.id="spinner",c.appendChild(h);var i=document.createElement("i");i.className="prodo-loadmoreUpload fa fa-spinner fa-spin ",i.id="spinnerChild",h.appendChild(i),$("#spinner").show();var j=document.createElement("br");c.appendChild(j),f="",g="",c="",a=""},e=0;e<b.file.length;e++)d(b.file[e]),b.getFile(b.file[e])})}}}]),function(a){var b=function(a){var b=function(a,b,c){return function(){c.$apply(function(){b.resolve(a.result)})}},c=function(a,b,c){return function(){c.$apply(function(){b.reject(a.result)})}},d=function(a,b){return function(a){b.$broadcast("fileProgress",{total:a.total,loaded:a.loaded})}},e=function(a,e){var f=new FileReader;return f.onload=b(f,a,e),f.onerror=c(f,a,e),f.onprogress=d(f,e),f},f=function(b,c){var d=a.defer(),f=e(d,c);return f.readAsBinaryString(b),d.promise};return{readAsBinaryString:f}};a.factory("fileReader",["$q","$log",b])}(angular.module("prodo.UploadApp")),angular.module("prodo.ProdoCommentApp").directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}),angular.module("prodo.ProdoCommentApp").directive("commentLimit",function(){return{require:"ngModel",link:function(a,b,c,d){function e(a){if(a){if(a.length>f){var b=a.substring(0,f);return d.$setViewValue(b),d.$render(),b}return a}}var f=Number(c.commentLimit);d.$parsers.push(e)}}}),angular.module("prodo.CommonApp").controller("prodoUserProfileDataController",["$scope","$log","$rootScope","UserSessionService","$state",function(a,b,c,d){a.modaluser={products_followed:""},a.ProductsFollowedMessage="",a.ProductsRecommendedMessage="",a.regularExpressionForProdonus=/^prodonus/i,a.profilePicDeleteduser="";a.errorIfUserDoesNotExist="",a.userProfileModal=function(b,c,e){a.modaluser={products_followed:""},a.profilePicDeleteduser="",a.profileUserName="",d.getUserProfileData(b,e),a.profilePicDeleteduser=c};var e=a.$on("getUserDataNotDone",function(){}),f=a.$on("getUserDataDone",function(b,d,e){a.errorIfUserDoesNotExist="",void 0!==d.error&&"AL001"===d.error.code?c.showModal():void 0!==d.error&&"AU003"===d.error.code?(a.modaluser={username:""},a.modaluser.username=e,a.ProductsFollowedMessage="",a.errorIfUserDoesNotExist="This user is deactivated",a.modaluser.profilepic=void 0,$("#profileInfoModal").modal("show")):(a.modaluser=d.success.user,a.ProductsFollowedMessage=0===a.modaluser.products_followed.length?"NO PRODUCTS FOLLOWED":1===a.modaluser.products_followed.length&&a.regularExpressionForProdonus.test("prodonus")===!0?"NO PRODUCTS FOLLOWED":"PRODUCTS FOLLOWED",a.ProductsRecommendedMessage=0===a.modaluser.products_recommends.length?"":"RECOMMENDED PRODUCTS",$("#profileInfoModal").modal({keyboard:!1,backdrop:"static",show:!0}))});a.emitProductData=function(a,b){c.product_prodle=a,c.orgid=b,$("#profileInfoModal").modal("hide"),c.$broadcast("emittingOrgidByUserProfile","success")},a.$on("$destroy",function(){e(),f()})}]),angular.module("prodo.ProdoWallApp").controller("prodoSearchController",["$scope","$log","$rootScope","prodoSearchService","UserSessionService","searchProductService","$http","$resource","trendingProductService","$state",function(a,b,c,d,e,f,g,h,i){a.productNames=[],a.selected=void 0,a.search={},a.result=[],a.productSearch={product:""},a.enhancement={},a.searchCriterion={},a.countForEmptyTextbox=0,a.names=[],a.message="",i.getTrendingProductsIndustrySpecific(),a.trendingProducts={},a.errors="",a.title="Trending Products",a.followedProductsCount=6;var j=0;a.regularExpressionForProdonus=/^prodonus/i,$("#searchText").popover({content:"Enter * for all products",trigger:"hover"}),a.openSearchModal=function(){$("#advancedSearchModal").modal({keyboard:!1,backdrop:"static",show:!0})};var k=a.$on("gotIndustrySpecificTrendingProducts",function(b,c){void 0!==c.success&&(a.trendingProducts=c.success.ProductTrends,0===a.trendingProducts.length&&(a.title="Product Search"))}),l=a.$on("notGotIndustrySpecificTrendingProducts",function(){a.errors="Server Error",c.ProdoAppMessage("There is some issue with the server! Please try after some time","error")});a.searchProductData=function(){if(a.message="",a.result=[],a.countForEmptyTextbox=0,a.search.productsearchdata={},""!==a.product_name){var b=a.product_name.replace(/\s/g,"");a.search.productsearchdata.Product_Name=b,b=""}else a.search.productsearchdata.Product_Name="",a.countForEmptyTextbox++;if(""!==a.model_number){var b=a.model_number.replace(/\s/g,"");a.search.productsearchdata.Model_Number=b,b=""}else a.search.productsearchdata.Model_Number="",a.countForEmptyTextbox++;if(""!==a.feature){var b=a.feature.replace(/\s/g,"");
a.search.productsearchdata.Feature=b,b=""}else a.search.productsearchdata.Feature="",a.countForEmptyTextbox++;if(""!==a.category){var b=a.category.replace(/\s/g,"");a.search.productsearchdata.Category=b,b=""}else a.search.productsearchdata.Category="",a.countForEmptyTextbox++;if(""!==a.org){var b=a.org.replace(/\s/g,"");a.search.productsearchdata.Organization_Name=b,b=""}else a.search.productsearchdata.Organization_Name="",a.countForEmptyTextbox++;a.search.productsearchdata.searchtype="wall",5==a.countForEmptyTextbox?c.ProdoAppMessage("Please enter atleast one search criteria to proceed","error"):d.searchProduct(a.search)};var m=a.$on("getSearchProductDone",function(b,d){void 0!==d.error&&"AL001"===d.error.code?($("#advancedSearchModal").modal("hide"),c.showModal()):d.error?c.ProdoAppMessage(d.error.message,"error"):(a.result=d.success.doc,a.message="",a.message=d.success.message)}),n=a.$on("getSearchProductNotDone",function(){c.ProdoAppMessage("There is some issue with the server! Please try after some time","error")});a.orgProdleEmitter=function(a,b){c.product_prodle=a,c.orgid=b,$("#advancedSearchModal").modal("hide"),c.$broadcast("emittingOrgid","success")},a.modalReset=function(){document.getElementById("textBoxCategoryName").value="",document.getElementById("textBoxModelNumber").value="",document.getElementById("textBoxFeatureName").value="",document.getElementById("textBoxProductName").value="",document.getElementById("textBoxOrgName").value="",a.product_name="",a.model_number="",a.category="",a.feature="",a.search.productsearchdata={},a.result=[],a.org="",a.message=""},a.quickSearchEmit=function(){angular.forEach(a.productNames,function(b){a.productSearch.product===b.name&&(c.product_prodle=b.prodle,c.orgid=b.orgid)}),c.$broadcast("emittingOrgidBySearch","success"),a.title="Trending Products",a.productSearch.product=""},a.toggleTitleForDiv=function(){a.title="Product Search",a.errors=""},a.unfollowProduct=function(a){e.unfollowProduct(a.prodle),j=e.productfollowlist.indexOf(a)};var o=a.$on("unfollowProductDone",function(a,b){void 0!==b.error&&"AL001"===b.error.code?c.showModal():(e.productfollowlist.splice(j,1),c.$broadcast("unfollowProductFromSidelist","success"))});a.loadMoreFollowedProduct=function(){100===a.followedProductsCount?(document.getElementById("tabMore").innerHTML="Read More",a.followedProductsCount=6):6===a.followedProductsCount&&(document.getElementById("tabMore").innerHTML="Read Less",a.followedProductsCount=100)},a.$on("$destroy",function(){k(),l(),m(),n(),o()})}]),angular.module("prodo.ProdoWallApp").factory("prodoSearchService",["$rootScope","$resource","$log","$state",function(a,b,c){var d={Product:b("/api/searchproduct",{},{searchProductByKey:{method:"POST"}})},e={};return e.searchProduct=function(b){d.Product.searchProductByKey(b,function(b){c.debug(b),a.$broadcast("getSearchProductDone",b)}),function(b){c.debug(b),a.$broadcast("getSearchProductNotDone",b)}},e}]).factory("searchProductService",["$rootScope","$resource","$log",function(a,b,c){var d={Product:b("/api/allproduct",{},{searchProductByKey:{method:"POST"}})},e={};return e.searchProduct=function(b){d.Product.searchProductByKey(b,function(b){c.debug(b),a.$broadcast("gotAllProducts",b)}),function(b){c.debug(b),a.$broadcast("notGotAllProducts",b)}},e}]).factory("trendingProductService",["$rootScope","$resource","$log",function(a,b,c){var d={Product:b("/api/trendingproducts",{},{searchTrendingProducts:{method:"GET"}})},e={Product:b("/api/domaintrending",{},{getIndustryTrending:{method:"GET"}})},f={};return f.getTrendingProducts=function(){d.Product.searchTrendingProducts(function(b){c.debug(b),a.$broadcast("gotTrendingProducts",b)}),function(b){c.debug(b),a.$broadcast("notGotTrendingProducts",b)}},f.getTrendingProductsIndustrySpecific=function(){e.Product.getIndustryTrending(function(b){c.debug(b),a.$broadcast("gotIndustrySpecificTrendingProducts",b)}),function(b){c.debug(b),a.$broadcast("notGotIndustrySpecificTrendingProducts",b)}},f}]);