angular.module("prodo.CommonApp",[]),angular.module("prodo.UserApp",[]),angular.module("prodo.ProdoWallApp",[]),angular.module("prodo.OrgApp",[]),angular.module("prodo.ProductApp",[]),angular.module("prodo.ProdoCommentApp",[]),angular.module("prodo.WarrantyApp",[]),angular.module("prodo.DashboardApp",[]),angular.module("prodo.ContentApp",[]),angular.module("prodo.BlogApp",[]),angular.module("prodo.AdApp",[]),angular.module("prodo.AdminApp",[]),angular.module("prodo.SubscriptionApp",[]),angular.module("prodo.UploadApp",[]),angular.module("prodo.ProdonusApp",["ui.router","ui.bootstrap","ngAnimate","$strap.directives","vcRecaptcha","ngResource","tags-input","ngCookies","angular-growl","prodo.CommonApp","prodo.UserApp","prodo.ProdoWallApp","prodo.OrgApp","prodo.ProductApp","prodo.ProdoCommentApp","prodo.WarrantyApp","prodo.DashboardApp","prodo.ContentApp","prodo.BlogApp","prodo.AdApp","prodo.AdminApp","prodo.SubscriptionApp","prodo.UploadApp","configSocket"]).config(["$logProvider","growlProvider","$httpProvider",function(a,b){a.debugEnabled(!0),b.globalTimeToLive(5e3),b.onlyUniqueMessages(!0),b.messagesKey("errors"),b.messageTextKey("message"),b.messageSeverityKey("field")}]).run(["$rootScope","UserSessionService","OrgRegistrationService","$log","growl",function(a,b,c,d){b.checkUser(),a.usersession=b,a.organizationData=c,a.$log=d}]).controller("ProdoMainController",["$scope","$rootScope","$state","$log","$location","growl","UserSessionService","OrgRegistrationService",function(a,b,c,d,e,f,g){c.transitionTo("prodo.landing.signup"),a.prodlesfollowed=[{}],a.showSignin=function(){c.transitionTo("prodo.landing.signin")},a.showSignup=function(){c.transitionTo("prodo.landing.signup")};var h=a.$on("session-changed-failure",function(b,d){g.authfailed(),c.transitionTo("prodo.landing.signup"),a.showAlert("alert-danger","Server Error: "+d)}),i=a.$on("session",function(e,f){if(d.debug(f),b.usersession.isLoggedIn)if("business"==f.prodousertype&&void 0==f.org)c.transitionTo("prodo.orgregistration.company");else if(("business"==f.prodousertype||"individual"==f.prodousertype)&&f.hasDonePayment){if(null==f.products_followed&&void 0==f.products_followed)d.debug("There is some problem with the database. Please contact support.");else if(f.products_followed.length>0){var h=f.products_followed.length-1;b.orgid=f.products_followed[h].orgid,b.product_prodle=f.products_followed[h].prodle;for(var i=0;i<f.products_followed.length;i++){if(f.products_followed[i]&&f.products_followed[i].prodle)var j=f.products_followed[i].prodle;a.prodlesfollowed.push(j)}g.getProductFollowed(a.prodlesfollowed)}if(f.org&&"Manufacturer"==f.org.orgtype)b.orgid=f.org.orgid,c.transitionTo("prodo.home.wall.org");else if(f.products_followed.length>0){var h=f.products_followed.length-1;b.orgid=f.products_followed[h].orgid,c.transitionTo("prodo.home.wall.org")}}});a.logout=function(){g.logoutUser()};var j=a.$on("logoutDone",function(d,e){console.log(b.usersession.isLoggedIn),c.transitionTo("prodo.landing.signup"),a.showAlert("alert-success",e)}),k=a.$on("logoutNotDone",function(b,c){a.showAlert("alert-danger","Server Error:"+c)});a.$on("$destroy",function(){h(),i(),j(),k()})}]),angular.module("prodo.UserApp").controller("UserRegistrationController",["$scope","$state","$http","$timeout","$sce","$log","UserSessionService","UserSignupService","vcRecaptchaService","UserRecaptchaService",function(a,b,c,d,e,f,g,h,i,j){a.submitted=!1,a.user={username:"",email:"",password:"",terms:!0,type:"business"},a.clearformData=function(){a.user.username="",a.user.email="",a.user.password=""},d(function(){a.hideAlert()},5e4),$("#recaptcha_reload_button").on("click",function(){$(this).find(":selected").data("placeholder");$("#recaptcha_response_field").attr("placeholder","Enter what you see")}),$("#recaptcha_audio_button").on("click",function(){$(this).find(":selected").data("placeholder");$("#recaptcha_response_field").attr("placeholder","Enter what you hear")}),a.jsonUserData=function(){var b={user:{username:a.user.username,email:a.user.email,password:a.user.password,terms:a.user.terms,prodousertype:a.user.type}};return JSON.stringify(b)},a.handleSignupResponse=function(c){c.success?b.transitionTo("prodo.user-content.emailverification"):"AU001"==c.error.code?(f.debug(c.error.code+" "+c.error.message),a.showAlert("alert-danger",c.error.message)):"AV001"==c.error.code?(f.debug(c.error.code+" "+c.error.message),a.showAlert("alert-danger",c.error.message)):"AT001"==c.error.code?(f.debug(c.error.code+" "+c.error.message),b.transitionTo("user-content.resetGenerateToken")):(f.debug(c.error.message),a.showAlert("alert-danger","Prodonus Database Server error. Please wait for some time."))},a.signup=function(){if(a.signupForm.$valid){a.showSpinner();{a.jsonUserData()}f.debug("User Data entered successfully"),j.validate(a)}else a.signupForm.submitted=!0};var k=a.$on("recaptchaNotDone",function(){a.hideSpinner(),a.showAlert("alert-danger","Recaptcha failed, please try again")}),l=a.$on("recaptchaFailure",function(b,c){a.hideSpinner(),a.showAlert("alert-danger","Server is not responding. Error:"+c)}),m=a.$on("recaptchaDone",function(){g.signupUser(a.jsonUserData()),a.hideSpinner()}),n=a.$on("signupDone",function(b,c){f.debug(c),a.handleSignupResponse(c),a.hideSpinner()}),o=a.$on("signupNotDone",function(b,c){a.hideSpinner(),f.debug(c),a.showAlert("alert-danger","Server Error:"+c.status)});a.jsonRegenerateTokenData=function(){var b={email:a.user.email};return JSON.stringify(b)},a.handleRegenerateTokenResponse=function(c){c.success?(b.transitionTo("messageContent.emailverification"),a.clearformData()):"AU004"==c.error.code?(f.debug(c.error.code+" "+c.error.message),a.showAlert("alert-danger",c.error.message)):(f.debug(c.error.message),a.showAlert("alert-danger",c.error.message))},a.regeneratetoken=function(){a.showSpinner(),g.regenerateTokenUser(a.jsonRegenerateTokenData())};var p=a.$on("regenerateTokenDone",function(b,c){a.clearformData(),a.handleRegenerateTokenResponse(c),a.hideSpinner()}),q=a.$on("regenerateTokenNotDone",function(){a.clearformData(),a.hideSpinner()});a.$on("$destroy",function(){k(),l(),m(),n(),o(),p(),q()})}]),angular.module("prodo.UserApp").controller("UserAccountController",["$scope","$rootScope","$state","$http","$timeout","$log","growl","UserSessionService","OrgRegistrationService",function(a,b,c,d,e,f,g,h){a.editorEnabled=!1,a.editEmail=!1,a.editAddress=!1,a.hasChangedPassword=!1,a.hasChangedEmail=!1,a.isInvites=!1,a.isUnfollowed=!1,a.hasChangedAddress=!1,a.hasChangedPersonalSettings=!1,a.form={},a.enableEditor=function(){a.editorEnabled=!0},a.disableEditor=function(){a.editorEnabled=!1},a.emailEditor=function(){a.generalsettingchange="",a.editEmail=a.editEmail?!1:!0},a.addrEditor=function(){a.locationsettingchange="",a.editAddress=a.editAddress?!1:!0},a.jsonUserAccountData=function(){var b={user:{firstname:a.user.firstname,lastname:a.user.lastname,dob:a.user.dob,gender:a.user.gender,phone:a.user.phone,mobile:a.user.mobile}};return JSON.stringify(b)},a.handleUpdateUserResponse=function(b){b.success?(g.addSuccessMessage(b.success.message),a.showAlert("alert-success",b.success.message)):"AU004"==b.error.code?(f.debug(b.error.code+" "+b.error.message),g.addErrorMessage(b.error.message)):(f.debug(b.error.message),g.addErrorMessage(b.error.message))},a.updateUserAccount=function(){a.form.userpersonalsettingform.$valid?(a.personalsettingchange="",a.disableEditor(),h.saveUserSettings(a.jsonUserAccountData())):a.personalsettingchange="Please enter valid data."};var i=a.$on("updateUserDone",function(b,c){a.hasChangedPersonalSettings=!0,a.handleUpdateUserResponse(c)}),j=a.$on("updateUserNotDone",function(b,c){a.hasChangedPersonalSettings=!0,g.addErrorMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.jsonUpdateEmailData=function(){var b={user:{email:a.user.email,currentpassword:a.user.password}};return JSON.stringify(b)},a.handleUpdateUserEmailResponse=function(a){a.success?g.addSuccessMessage(a.success.message):"AU004"==a.error.code?(f.debug(a.error.code+" "+a.error.message),g.addErrorMessage(a.error.message)):(f.debug(a.error.message),g.addErrorMessage(a.error.message))},a.updateUserEmail=function(){a.form.usergeneralsettingform.$valid?(a.emailEditor(),h.updateEmail(a.jsonUpdateEmailData())):a.generalsettingchange="Please enter valid data."};var k=a.$on("updateUserEmailDone",function(b,c){a.hasChangedEmail=!0,a.handleUpdateUserEmailResponse(c)}),l=a.$on("updateUserEmailNotDone",function(b,c){a.hasChangedEmail=!0,g.addErrorMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.jsonUpdatePasswordData=function(){var b={user:{currentpassword:a.user.currentpassword,newpassword:a.user.newpassword,confirmnewpassword:a.user.confirmpassword}};return JSON.stringify(b)},a.clear=function(){a.user.currentpassword="",a.user.newpassword="",a.user.confirmpassword="",a.passwordsettingchange=""},a.handleUpdateUserPasswordResponse=function(a){a.success?g.addSuccessMessage(a.success.message):"AU004"==a.error.code?(f.debug(a.error.code+" "+a.error.message),g.addErrorMessage(a.error.message)):(f.debug(a.error.message),g.addErrorMessage(a.error.message))},a.changePassword=function(){a.form.userpasswordsettingform.$valid?(a.passwordsettingchange="",h.updatePassword(a.jsonUpdatePasswordData())):a.passwordsettingchange="Please enter valid data."};var m=a.$on("updateUserPasswordDone",function(b,c){a.hasChangedPassword=!0,a.handleUpdateUserPasswordResponse(c),a.clear()}),n=a.$on("updateUserPasswordNotDone",function(b,c){a.hasChangedPassword=!0,g.addErrorMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.jsonUserAddressData=function(){var b={user:{address:{address1:a.user.address.address1,address2:a.user.address.address2,address3:a.user.address.address3,city:a.user.address.city,state:a.user.address.state,country:a.user.address.country,zipcode:a.user.address.zipcode}}};return JSON.stringify(b)},a.updateUserAddress=function(){a.form.userlocationsettingform.$valid?(a.addrEditor(),h.saveUserSettings(a.jsonUserAddressData())):a.locationsettingchange="Please enter valid data."};var i=a.$on("updateUserDone",function(b,c){hasChangedAddress=!0,a.handleUpdateUserResponse(c)}),j=a.$on("updateUserNotDone",function(a,b){hasChangedAddress=!0,g.addErrorMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+b)});a.handleDeleteUserResponse=function(b){b.success?(h.logoutUser(),a.showAlert("alert-success",b.success.message)):(f.debug(b.error.message),a.showAlert("alert-danger",b.error.message))};var o=a.$on("logoutDone",function(b,d){c.transitionTo("prodo.landing.signin"),a.showAlert("alert-success",d)});a.deleteUserAccount=function(){h.removeUserSettings()};var p=a.$on("deleteUserDone",function(b,c){a.handleDeleteUserResponse(c)}),q=a.$on("deleteUserNotDone",function(b,c){a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.prodlesrecommend=[{}],a.handleGetUserResponse=function(b){if(b.success){if(console.log(b.success.user),a.user=b.success.user,null!=b.success.user.dob){var c=new Date(b.success.user.dob),d=c.getFullYear(),e=c.getMonth()+1;10>e&&(e="0"+e);var g=c.getDate();a.user.dob=d+"-"+e+"-"+g}if(a.user.products_recommends.length>0){for(var i=0;i<a.user.products_recommends.length;i++){if(a.user.products_recommends[i]&&a.user.products_recommends[i].prodle)var j=a.user.products_recommends[i].prodle;a.prodlesrecommend.push(j)}h.getProductRecommend(a.prodlesrecommend)}h.updateUserData(b.success.user),a.showAlert("alert-success",b.success.message)}else f.debug(b.error.message),a.showAlert("alert-error",b.error.message)},a.products_followed=[];var r=b.$on("getProductFollowedDone",function(b,c){a.products_followed=c.success.products,a.showAlert("alert-success",c.success.message)}),s=b.$on("getProductFollowedNotDone",function(b,c){a.showAlert("alert-error",c.error.message)}),t=b.$on("getProductRecommendDone",function(b,c){a.products_recommends=c.success.products,a.showAlert("alert-success",c.success.message)}),u=b.$on("getProductRecommendNotDone",function(b,c){a.showAlert("alert-error",c.error.message)}),v=b.$on("getUserDone",function(b,c){a.handleGetUserResponse(c)}),w=b.$on("getUserNotDone",function(b,c){a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.userinvites=[{name:"",email:""}],a.addUserInvites=function(){a.userinvites.push({name:"",email:""})},a.jsonUserInvitesData=function(){var b={userinvites:a.userinvites};return JSON.stringify(b)},a.handleUserInviteResponse=function(a){a.success?g.addSuccessMessage("Your invites has been successfully sent."):"AU004"==a.error.code?(f.debug(a.error.code+" "+a.error.message),g.addErrorMessage(a.error.message)):(f.debug(a.error.message),g.addErrorMessage(a.error.message))},a.sendUserInvites=function(){a.form.userinvitesform.$valid?(a.invitesettingchange="",console.log(a.jsonUserInvitesData()),h.sendInvites(a.jsonUserInvitesData())):a.invitesettingchange="Please pass valid data."};var x=a.$on("sendUserInvitesDone",function(b,c){a.isInvites=!0,a.handleUserInviteResponse(c)}),y=a.$on("sendUserInvitesNotDone",function(b,c){a.isInvites=!0,g.addErrorMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.unfollow=function(a){h.unfollowProduct(a.prodle)};var z=a.$on("unfollowProductDone",function(){a.isUnfollowed=!0,g.addSuccessMessage("You have successfully unfollowed product: "+product.name);for(var b=a.products_followed,c=0,d=b.length;d>c;c++)product===b[c]&&b.splice(c,1)}),A=a.$on("unfollowProductNotDone",function(a,b){g.addErrorMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+b)});a.$on("$destroy",function(){i(),j(),k(),l(),m(),n(),i(),j(),p(),q(),o(),r(),s(),t(),u(),v(),w(),x(),y(),z(),A()})}]),angular.module("prodo.UserApp").controller("UserSigninController",["$scope","$rootScope","$state","$timeout","$stateParams","$log","UserSessionService","OrgRegistrationService",function(a,b,c,d,e,f,g,h){a.submitted=!1,a.user={email:"",password:"",newpassword:""},a.clearformData=function(){a.user.email="",a.user.password="",a.user.newpassword="",a.user.confirmnewpassword=""},d(function(){a.hideAlert()},5e4),a.jsonUserSigninData=function(){var b={email:a.user.email,password:a.user.password};return JSON.stringify(b)},a.handleSigninResponse=function(b){b.success?(g.authSuccess(b.success.user),a.showAlert("alert-success","Welcome to Prodonus, you have successfully signed up.")):void 0==b.error.user?(f.debug(b.error.code+" "+b.error.message),a.showAlert("alert-danger",b.error.message)):b.error.user&&("AW001"==b.error.code?(f.debug(b.error.code+" "+b.error.message),g.authSuccess(b.error.user),a.showAlert("alert-info",b.error.message)):(f.debug(b.error.code+" "+b.error.message),g.authSuccess(b.error.user),a.showAlert("alert-danger",b.error.message)))},a.signin=function(){a.signinForm.$valid?(a.showSpinner(),f.debug("User Data entered successfully"),g.signinUser(a.jsonUserSigninData())):a.signinForm.submitted=!0};var i=a.$on("signinDone",function(b,c){a.handleSigninResponse(c),a.hideSpinner()}),j=a.$on("signinNotDone",function(b,c){a.clearformData(),a.hideSpinner(),a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.jsonForgotPasswordData=function(){var b={user:{email:a.user.email}};return JSON.stringify(b)},a.handleForgotPasswordResponse=function(b){b.success?a.showAlert("alert-info","Your temporary password has been sent. Please check your email, and follow instructions."):"AV001"==b.error.code?(f.debug(b.error.code+" "+b.error.message),a.showAlert("alert-danger",b.error.message)):"AV004"==b.error.code?(f.debug(b.error.code+" "+b.error.message),a.showAlert("alert-danger",b.error.message)):"AT001"==b.error.code?(f.debug(b.error.code+" "+b.error.message),a.showAlert("alert-danger",b.error.message)):(f.debug(b.error.message),a.showAlert("alert-danger",b.error.message))},a.forgotpassword=function(){a.showSpinner(),g.forgotPasswordUser(a.jsonForgotPasswordData())};var k=a.$on("forgotPasswordDone",function(b,c){a.clearformData(),a.hideSpinner(),a.handleForgotPasswordResponse(c)}),l=a.$on("forgotPasswordNotDone",function(b,c){a.clearformData(),a.hideSpinner(),a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.jsonResetPasswordData=function(){var b={user:{newpassword:a.user.newpassword,confirmnewpassword:a.user.confirmnewpassword}};return JSON.stringify(b)},a.handleResetPasswordResponse=function(d){d.success?b.usersession.currentUser.hasDonePayment&&b.usersession.currentUser.org.orgid?h.getOrgDetailSettings():b.usersession.currentUser.isSubscribed&&(!b.usersession.currentUser.isSubscribed||b.usersession.currentUser.subscriptionExpired||b.usersession.currentUser.hasDonePayment?b.usersession.currentUser.isSubscribed&&b.usersession.currentUser.subscriptionExpired?c.transitionTo("subscription.payment",{planid:b.usersession.currentUser.subscription.planid,plantype:b.usersession.currentUser.usertype}):b.usersession.currentUser.hasDonePayment&&c.transitionTo("prodo.wall.org"):c.transitionTo("subscription.payment",{planid:b.usersession.currentUser.subscription.planid,plantype:b.usersession.currentUser.usertype})):"AV001"==d.error.code?(f.debug(d.error.code+" "+d.error.message),a.showAlert("alert-danger",d.error.message)):(f.debug(d.error.message),a.showAlert("alert-danger",d.error.message)),a.hideSpinner()},a.resetpassword=function(){a.resetPasswordForm.$valid?(a.showSpinner(),g.resetPasswordUser(a.jsonResetPasswordData())):a.resetPasswordForm.submitted=!0};var m=a.$on("resetPasswordDone",function(b,c){a.clearformData(),a.handleResetPasswordResponse(c)}),n=a.$on("resetPasswordNotDone",function(b,c){a.clearformData(),a.hideSpinner(),a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.$on("$destroy",function(){i(),j(),k(),l(),m(),n()})}]),angular.module("prodo.UserApp").factory("UserSessionService",["$rootScope","$resource","$http","$state","$log",function(a,b,c,d,e){var f={Signup:b("/api/user/signup",{},{saveUser:{method:"POST"}}),Signin:b("/api/user/signin",{},{signinUser:{method:"POST"}}),ManageUser:b("/api/user/:userid",{},{getAllUsers:{method:"GET",isArray:!0},getUserSettings:{method:"GET",params:{userid:"@userid"},isArray:!1},updateUserSettings:{method:"PUT",params:{userid:"@userid"},isArray:!1},deleteUserSettings:{method:"DELETE",params:{userid:"@userid"}}}),User_Invites:b("/api/userinvites",{},{sendUserInvites:{method:"POST",isArray:!1}}),Update_Email:b("/api/changeemail/:userid",{},{updateEmailSettings:{method:"POST",params:{userid:"@userid"},isArray:!1}}),Change_Password:b("/api/changepassword/:userid",{},{updatePasswordSettings:{method:"POST",params:{userid:"@userid"},isArray:!1}}),ForgotPassword:b("/api/user/forgotpassword",{},{forgotPassword:{method:"POST"}}),ResetPassword:b("/api/user/resetpassword/:userid",{},{resetPassword:{method:"PUT",params:{userid:"@userid"},isArray:!1}}),RegenerateToken:b("/api/regenerateverificationtoken",{},{regenerateToken:{method:"POST"}}),IsUserLoggedin:b("/api/isloggedin",{},{checkUserSession:{method:"GET"}}),Logout:b("/api/logout",{},{logoutUser:{method:"GET"}}),Product_Followed:b("/api/myproductsfollowed?prodles=:data",{},{getProduct_Followed:{method:"GET",params:{data:"@data"}}}),Product_Recommend:b("/api/myrecommendproducts?prodles=:data",{},{getProduct_Recommend:{method:"GET",params:{data:"@data"}}}),Product_Follow:b("/api/user/follow/:data",{},{followProduct:{method:"GET",params:{data:"@data"}}}),Product_Unfollow:b("/api/user/unfollow/:data",{},{unfollowProduct:{method:"GET",params:{data:"@data"}}}),User_Profile:b("/api/profileinfo/:userid",{},{getUserProfile:{method:"GET",params:{userid:"@userid"}}})},g={};return g.isLoggedIn=!1,g.currentUser=null,g.productfollowlist=[],g.signupUser=function(b){f.Signup.saveUser(b,function(b){e.debug(b),a.$broadcast("signupDone",b)},function(b){e.debug(b),a.$broadcast("signupNotDone",b.status)})},g.signinUser=function(b){f.Signin.signinUser(b,function(b){e.debug(b),a.$broadcast("signinDone",b)},function(b){e.debug(b),a.$broadcast("signinNotDone",b.status)})},g.getUserProfileData=function(b){f.User_Profile.getUserProfile({userid:b},function(b){e.debug(b),a.$broadcast("getUserDataDone",b)}),function(b){e.debug(b),a.$broadcast("getUserDataNotDone",b)}},g.saveUserSettings=function(b){f.ManageUser.updateUserSettings({userid:g.currentUser.userid},b,function(b){e.debug(b),a.$broadcast("updateUserDone",b)},function(b){e.debug(b),a.$broadcast("updateUserNotDone",b.status)})},g.updateEmail=function(b){f.Update_Email.updateEmailSettings({userid:g.currentUser.userid},b,function(b){e.debug(b),a.$broadcast("updateUserEmailDone",b)},function(b){e.debug(b),a.$broadcast("updateUserEmailNotDone",b.status)})},g.updatePassword=function(b){f.Change_Password.updatePasswordSettings({userid:g.currentUser.userid},b,function(b){e.debug(b),a.$broadcast("updateUserPasswordDone",b)},function(b){e.debug(b),a.$broadcast("updateUserPasswordNotDone",b.status)})},g.getProductFollowed=function(b){f.Product_Followed.getProduct_Followed({data:b},function(b){e.debug(b),b.error?console.log("No products followed"):g.productfollowlist=b.success.products,a.$broadcast("getProductFollowedDone",b)},function(b){e.debug(b),a.$broadcast("getProductFollowedNotDone",b)})},g.getProductRecommend=function(b){f.Product_Recommend.getProduct_Recommend({data:b},function(b){e.debug(b),a.$broadcast("getProductRecommendDone",b)},function(b){e.debug(b),a.$broadcast("getProductRecommendNotDone",b)})},g.unfollowProduct=function(b){f.Product_Unfollow.unfollowProduct({data:b},function(b){e.debug(b),a.$broadcast("unfollowProductDone",b)},function(b){e.debug(b),a.$broadcast("unfollowProductNotDone",b)})},g.followProduct=function(b){f.Product_Follow.followProduct({data:b},function(b){e.debug(b),a.$broadcast("followProductDone",b)},function(b){e.debug(b),a.$broadcast("followProductNotDone",b)})},g.sendInvites=function(b){f.User_Invites.sendUserInvites(b,function(b){e.debug(b),a.$broadcast("sendUserInvitesDone",b)},function(b){e.debug(b),a.$broadcast("sendUserInvitesNotDone",b)})},g.removeUserSettings=function(){f.ManageUser.deleteUserSettings({userid:g.currentUser.userid},function(b){e.debug(b),a.$broadcast("deleteUserDone",b)},function(b){e.debug(b),a.$broadcast("daleteUserNotDone",b.status)})},g.getUserDetailSettings=function(){f.ManageUser.getUserSettings({userid:g.currentUser.userid},function(b){e.debug(b),a.$broadcast("getUserDone",b)},function(b){e.debug(b),a.$broadcast("getUserNotDone",b.status)})},g.updateUserData=function(a){g.currentUserData=a},g.forgotPasswordUser=function(b){f.ForgotPassword.forgotPassword(b,function(b){e.debug(b),a.$broadcast("forgotPasswordDone",b)},function(b){e.debug(b),a.$broadcast("forgotPasswordNotDone",b.status)})},g.resetPasswordUser=function(b){f.ResetPassword.resetPassword({userid:g.currentUser.userid},b,function(b){e.debug(b),a.$broadcast("resetPasswordDone",b)},function(b){e.debug(b),a.$broadcast("resetPasswordNotDone",b.status)})},g.regenerateTokenUser=function(b){f.RegenerateToken.regenerateToken(b,function(b){e.debug(b),a.$broadcast("regenerateTokenDone",b)},function(b){e.debug(b),a.$broadcast("regenerateTokenNotDone",b.status)})},g.init=function(){g.resetSession()},g.resetSession=function(){g.currentUser=null,g.isLoggedIn=!1},g.logoutUser=function(){f.Logout.logoutUser(function(b){e.debug(b.success.message),g.resetSession(),a.$broadcast("logoutDone",b.success.message)},function(b){e.debug(b),a.$broadcast("logoutNotDone",b.status)})},g.authSuccess=function(b){g.currentUser=b,g.isLoggedIn=!0,a.$broadcast("session",b)},g.authfailed=function(){g.resetSession()},g.checkUser=function(){f.IsUserLoggedin.checkUserSession(function(a){e.debug(a),a.success?g.authSuccess(a.success.user):g.authfailed()},function(b){e.debug(b),a.$broadcast("session-changed-failure",b.status)})},g}]).factory("UserSignupService",["$resource",function(a){return a("/api/user/signup",{},{saveUser:{method:"POST"}})}]).factory("UserRecaptchaService",["$http","vcRecaptchaService","$log",function(a,b,c){var d={};return d.validate=function(e){var f="POST",g="/api/recaptcha",h={recaptcha:{response:Recaptcha.get_response(),challenge:Recaptcha.get_challenge()}},i=JSON.stringify(h);a({method:f,url:g,data:i,headers:{"Content-Type":"application/json"}}).success(function(a){c.debug("success"),c.debug(a),d.handleRecaptchaResponse(e,a)}).error(function(a,d){c.debug(d),e.$broadcast("recaptchaFailure",d),b.reload()})},d.handleRecaptchaResponse=function(a,d){d.success?(c.debug(d.success),a.$emit("recaptchaDone","Success")):(c.debug(d.error.message),a.$emit("recaptchaNotDone","Failure"),b.reload())},d}]),angular.module("prodo.OrgApp").controller("OrgAccountController",["$scope","$rootScope","$state","$http","$timeout","$log","growl","UserSessionService","OrgRegistrationService","OrgService","currentorgdata","currentorgaddr","currentorgproduct","currentorggroup",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){a.productlist=[],a.hasBroadcast=!1,a.editorEnabled=!1,a.form={},a.enableEditor=function(){a.editorEnabled=!0},a.disableEditor=function(){a.editorEnabled=!1,a.orggeneralsettingchange=""},m.error?console.log("no product available"):a.productlist=m.success.product,a.org=k.success.organization,a.groups=n.success.usergrp,a.orgaddr=l.success.orgaddress,i.updateOrgData(k.success.organization),a.password="",a.jsonOrgAccountData=function(){var b={organization:{name:a.org.name,description:a.org.description,password:a.password}};return JSON.stringify(b)},a.handleUpdateOrgResponse=function(a){a.success?g.addSuccessMessage(a.success.message):"AU004"==a.error.code?(f.debug(a.error.code+" "+a.error.message),g.addErrorMessage(a.error.message)):(f.debug(a.error.message),g.addErrorMessage(a.error.message))},a.updateOrgAccount=function(){a.form.orggeneralsettingform.$valid?(a.disableEditor(),i.saveOrgSettings(a.jsonOrgAccountData())):a.orggeneralsettingchange="Please enter valid data"};var o=a.$on("updateOrgDone",function(b,c){a.handleUpdateOrgResponse(c)}),p=a.$on("updateOrgNotDone",function(a,b){g.addErrorMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+b)});a.jsonOrgAddressData=function(){var b={location:{address:{address1:a.org.address1,address2:a.org.address2,address3:a.org.address3,country:a.org.country,city:a.org.city,state:a.org.state,zipcode:a.org.zipcode},contacts:[{customerhelpline:a.org.contact.customerhelpline1},{customerhelpline:a.org.contact.customerhelpline2},{customerhelpline:a.org.contact.customerhelpline3}],locationtype:a.org.orgaddresstype}};return JSON.stringify(b)},a.handleAddOrgAddressResponse=function(b){b.success?a.showAlert("alert-success",b.success.message):"AU004"==b.error.code?(f.debug(b.error.code+" "+b.error.message),a.showAlert("alert-danger",b.error.message)):(f.debug(b.error.message),a.showAlert("alert-danger",b.error.message))},a.addOrgAddress=function(){i.saveOrgAddress(a.jsonOrgAddressData())};var q=a.$on("addOrgAddressDone",function(b,c){a.handleAddOrgAddressResponse(c)}),r=a.$on("addOrgAddressNotDone",function(b,c){a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.handleUpdateOrgAddressResponse=function(b){b.success?a.showAlert("alert-success",b.success.message):"AU004"==b.error.code?(f.debug(b.error.code+" "+b.error.message),a.showAlert("alert-danger",b.error.message)):(f.debug(b.error.message),a.showAlert("alert-danger",b.error.message))},a.updateAddress=function(b){console.log(a.jsonOrgAddressData()),i.updateOrgAddress(a.jsonOrgAddressData(),b)};var s=a.$on("updateOrgAddressDone",function(b,c){a.handleUpdateOrgAddressResponse(c)}),t=a.$on("updateOrgAddressNotDone",function(b,c){a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.handleDeleteOrgResponse=function(b){b.success?a.showAlert("alert-success",b.success.message):(f.debug(b.error.message),a.showAlert("alert-danger",b.error.message))},a.deleteOrgAccount=function(){i.removeOrgSettings()};var u=a.$on("deleteOrgDone",function(b,c){a.handleDeleteOrgResponse(c)}),v=a.$on("deleteOrgNotDone",function(b,c){a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.handleDeleteOrgAddressResponse=function(b){b.success?a.showAlert("alert-success",b.success.message):(f.debug(b.error.message),a.showAlert("alert-danger",b.error.message))},a.deleteOrgAddress=function(a){i.removeOrgAddress(a)};var w=a.$on("deleteOrgAddressDone",function(b,c){a.handleDeleteOrgResponse(c)}),x=a.$on("deleteOrgAddressNotDone",function(b,c){a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.handleDeleteOrgGroupMemberResponse=function(b){b.success?(console.log(b.success.message),a.showAlert("alert-success",b.success.message)):"AU004"==b.error.code?(f.debug(b.error.code+" "+b.error.message),a.showAlert("alert-danger",b.error.message)):(f.debug(b.error.message),a.showAlert("alert-danger",b.error.message))},a.deleteGroupMember=function(a,b){i.deleteMember(a,b)};var y=a.$on("deleteOrgGroupMemberDone",function(b,c){a.handleDeleteOrgGroupMemberResponse(c)}),z=a.$on("deleteOrgGroupMemberNotDone",function(b,c){a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.orginvites=[{name:"",orgname:"",email:""}],a.addMoreInvites=function(){a.orginvites.push({name:"",orgname:"",email:""})},a.jsonOrgInvitesData=function(){var b={otherorginvites:a.orginvites};return JSON.stringify(b)},a.handleOrgInviteResponse=function(b){b.success?a.showAlert("alert-success",b.success.message):"AU004"==b.error.code?(f.debug(b.error.code+" "+b.error.message),a.showAlert("alert-danger",b.error.message)):(f.debug(b.error.message),a.showAlert("alert-danger",b.error.message))},a.sendOrgInvites=function(){console.log(a.jsonOrgInvitesData()),i.sendInvites(a.jsonOrgInvitesData())};var A=a.$on("sendOrgInvitesDone",function(b,c){a.handleOrgInviteResponse(c)}),B=a.$on("sendOrgInvitesNotDone",function(b,c){a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.customerinvites=[{name:"",email:""}],a.addCustomerInvites=function(){a.customerinvites.push({name:"",email:""})},a.jsonOrgCustomerInvitesData=function(){var b={orgcustomerinvites:a.customerinvites};return JSON.stringify(b)},a.handleOrgCustomerInviteResponse=function(b){b.success?a.showAlert("alert-success",b.success.message):"AU004"==b.error.code?(f.debug(b.error.code+" "+b.error.message),a.showAlert("alert-danger",b.error.message)):(f.debug(b.error.message),a.showAlert("alert-danger",b.error.message))
},a.orgCustomerInvites=function(){console.log(a.jsonOrgInvitesData()),i.sendCustomerInvites(a.jsonOrgCustomerInvitesData())};var C=a.$on("sendOrgCustomerInvitesDone",function(b,c){a.handleOrgCustomerInviteResponse(c)}),D=a.$on("sendOrgCustomerInvitesNotDone",function(b,c){a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.showInvites=!1,a.addInvites=function(){a.showInvites=!0},a.group={grpname:"",invites:""},a.jsonOrgGroupInvitesData=function(){var b={usergrp:{grpname:a.group.grpname,invites:a.group.invites}};return JSON.stringify(b)},a.handleOrgGroupInviteResponse=function(a){a.success?g.addSuccessMessage(a.success.message):"AU004"==a.error.code?(f.debug(a.error.code+" "+a.error.message),g.addErrorMessage(a.error.message)):(f.debug(a.error.message),g.addErrorMessage(a.error.message))},a.addGroupInvite=function(){a.form.orggroupinvitesform.$valid?(a.orggroupinvitesettingchange="",i.groupInvites(a.jsonOrgGroupInvitesData())):a.orggroupinvitesettingchange="Please enter valid data"};var E=a.$on("sendOrgGroupInvitesDone",function(b,c){a.handleOrgGroupInviteResponse(c)}),F=a.$on("sendOrgGroupInvitesNotDone",function(){g.addErrorMessage("It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+message)});a.$on("$destroy",function(){o(),p(),q(),r(),s(),t(),u(),v(),w(),x(),y(),z(),A(),B(),C(),D(),E(),F()})}]),angular.module("prodo.OrgApp").controller("OrgRegistrationController",["$scope","$rootScope","OrgModel","$state","$stateParams","$log","OrgRegistrationService","UserSessionService",function(a,b,c,d,e,f,g,h){a.errmessage="",a.org=c,a.countries=["Afghanistan","Albania","Algeria","American Samoa","Andorra","Angola","Anguilla","Antigua and Barbuda","Argentina","Armenia","Aruba","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bermuda","Bhutan","Bolivia","Bosnia-Herzegovina","Botswana","Bouvet Island","Brazil","Brunei","Bulgaria","Burkina Faso","Burundi","Cambodia","Cameroon","Canada","Cape Verde","Cayman Islands","Central African Republic","Chad","Chile","China","Christmas Island","Cocos (Keeling) Islands","Colombia","Comoros","Congo, Democratic Republic of the (Zaire)","Congo, Republic of","Cook Islands","Costa Rica","Croatia","Cuba","Cyprus","Czech Republic","Denmark","Djibouti","Dominica","Dominican Republic","Ecuador","Egypt","El Salvador","Equatorial Guinea","Eritrea","Estonia","Ethiopia","Falkland Islands","Faroe Islands","Fiji","Finland","France","French Guiana","Gabon","Gambia","Georgia","Germany","Ghana","Gibraltar","Greece","Greenland","Grenada","Guadeloupe (French)","Guam (USA)","Guatemala","Guinea","Guinea Bissau","Guyana","Haiti","Holy See","Honduras","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Ivory Coast (Cote D`Ivoire)","Jamaica","Japan","Jordan","Kazakhstan","Kenya","Kiribati","Kuwait","Kyrgyzstan","Laos","Latvia","Lebanon","Lesotho","Liberia","Libya","Liechtenstein","Lithuania","Luxembourg","Macau","Macedonia","Madagascar","Malawi","Malaysia","Maldives","Mali","Malta","Marshall Islands","Martinique (French)","Mauritania","Mauritius","Mayotte","Mexico","Micronesia","Moldova","Monaco","Mongolia","Montenegro","Montserrat","Morocco","Mozambique","Myanmar","Namibia","Nauru","Nepal","Netherlands","Netherlands Antilles","New Caledonia (French)","New Zealand","Nicaragua","Niger","Nigeria","Niue","Norfolk Island","North Korea","Northern Mariana Islands","Norway","Oman","Pakistan","Palau","Panama","Papua New Guinea","Paraguay","Peru","Philippines","Pitcairn Island","Poland","Polynesia (French)","Portugal","Puerto Rico","Qatar","Reunion","Romania","Russia","Rwanda","Saint Helena","Saint Kitts and Nevis","Saint Lucia","Saint Pierre and Miquelon","Saint Vincent and Grenadines","Samoa","San Marino","Sao Tome and Principe","Saudi Arabia","Senegal","Serbia","Seychelles","Sierra Leone","Singapore","Slovakia","Slovenia","Solomon Islands","Somalia","South Africa","South Georgia and South Sandwich Islands","South Korea","South Sudan","Spain","Sri Lanka","Sudan","Suriname","Svalbard and Jan Mayen Islands","Swaziland","Sweden","Switzerland","Syria","Taiwan","Tajikistan","Tanzania","Thailand","Timor-Leste (East Timor)","Togo","Tokelau","Tonga","Trinidad and Tobago","Tunisia","Turkey","Turkmenistan","Turks and Caicos Islands","Tuvalu","Uganda","Ukraine","United Arab Emirates","United Kingdom","United States","Uruguay","Uzbekistan","Vanuatu","Venezuela","Vietnam","Virgin Islands","Wallis and Futuna Islands","Yemen","Zambia","Zimbabwe"],a.states={},a.states.india=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar ","Chhattisgarh ","Goa","Gujarat","Haryana","Himachal Pradesh","Jammu and Kashmir","Jharkhand","Kerala ","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Orissa ","Punjab","Rajasthan","Sikkim","Tamil Nadu","Tripura","Uttar Pradesh","Uttarakhand","West Bengal"],a.india={},a.india.major_cities=["Port Blair","Hyderabad","Itanagar","Dispur","Patna","Silvassa","Daman","Delhi","Gandhinagar","Chandigarh","Ranchi","Bengaluru","Thiruvananthapuram","Kavaratti","Bhopal","Imphal","Shillong","Aizwal","Kohima","Bhubaneshwar","Puducherry","Chandigarh","Jaipur","Agartala","Mumbai","Lucknow","Kolkata","Panaji","Pune"],a.selected_country="",a.submitted=!1,a.goToAddress=function(){a.OrgCompanyForm.$valid?(a.errmessage="",d.transitionTo("prodo.orgregistration.address")):(a.submitted=!0,a.errmessage="Please enter correct data.")},a.goToGroupuser=function(){a.OrgAddressForm.$valid?(a.errmessage="",d.transitionTo("prodo.orgregistration.groupuser")):(a.errmessage="Please enter correct data.",a.submitted=!0)},a.goToState=function(){a.OrgGroupuserForm.$valid?(a.errmessage="",d.transitionTo("Manufacturer"==a.org.orgtype?"prodo.orgregistration.terms":"prodo.orgregistration.finish")):(a.errmessage="Please enter correct data.",a.submitted=!0)},a.goToSummary=function(){a.org.terms&&d.transitionTo("prodo.orgregistration.finish")},a.return_states=function(){return"India"===a.org.country?a.states.india:""},a.return_cities=function(){return"India"===a.org.country?a.india.major_cities:""},a.clearOrgData=function(){a.org.name="",a.org.description="",a.org.orgtype="",a.org.contractid="",a.org.address1="",a.org.address2="",a.org.address3="",a.org.country="",a.org.city="",a.org.state="",a.org.zipcode="",a.org.contact.customerhelpline1="",a.org.contact.customerhelpline2="",a.org.contact.customerhelpline3="",a.org.contact.customerhelpline4="",a.org.grpname="",a.org.invites=""},a.handleOrgResponse=function(c){console.log(c),c.success?(f.debug(c.success),b.usersession.checkUser()):(f.debug(c.error),a.showAlert("alert-danger",c.error.message))};var i=b.$on("session",function(c,e){if(f.debug(e),b.usersession.isLoggedIn&&"business"==e.prodousertype&&e.hasDonePayment){if(null==e.products_followed&&void 0==e.products_followed)f.debug("There is some problem with the database. Please contact support.");else if(e.products_followed.length>0){var g=e.products_followed.length-1;console.log(g),b.orgid=e.products_followed[g].orgid,b.product_prodle=e.products_followed[g].prodle;for(var i=0;i<e.products_followed.length;i++){if(e.products_followed[i]&&e.products_followed[i].prodle)var j=e.products_followed[i].prodle;a.prodlesfollowed.push(j)}h.getProductFollowed(a.prodlesfollowed)}b.orgid=e.org.orgid,d.transitionTo("prodo.home.wall.org")}});a.jsonOrgData=function(){var b={organization:{name:a.org.name,description:a.org.description,orgtype:a.org.orgtype,contractid:a.org.contractid,location:[{locationtype:a.org.orgaddresstype,address:{address1:a.org.address1,address2:a.org.address2,address3:a.org.address3,country:a.org.country,city:a.org.city,state:a.org.state,zipcode:a.org.zipcode},contacts:a.org.contacts}],usergrp:[{grpname:a.org.grpname,invites:a.org.invites}],terms:a.org.terms}};return JSON.stringify(b)},a.registerOrg=function(){g.RegisterOrg(a.jsonOrgData())};var j=a.$on("orgRegistrationDone",function(b,c){console.log(c),a.handleOrgResponse(c)}),k=a.$on("orgRegistrationNotDone",function(b,c){a.showAlert("alert-danger","It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."+c)});a.$on("$destroy",function(){i(),j(),k()})}]),angular.module("prodo.OrgApp").factory("OrgModel",function(){return{name:"",orgtype:"",description:"",contractid:"",orginvites:[],subscription:[],grpname:"",invites:"",grpmembers:[],orgaddresstype:"",address1:"",address2:"",address3:"",country:"",city:"",state:"",zipcode:"",timezone:"",region:"",geo:{latitude:2,longitude:1},contacts:[{customerhelpline:""},{customerhelpline:""},{customerhelpline:""}],terms:""}}).factory("OrgService",["$resource",function(a){var b={org_data:a("/api/organization/:orgid",{},{getOrgSettings:{method:"GET"}}),ManageOrgLocation:a("/api/orgaddress/:orgid/:orgaddressid",{},{getAllOrgAddress:{method:"GET"}}),GetOrgProducts:a("/api/product/:orgid",{},{getAllOrgProducts:{method:"GET"}}),GetOrgGroupMembers:a("/api/orggroupmembers/:orgid",{},{getGroupDetails:{method:"GET"}})};return b}]).factory("OrgRegistrationService",["$rootScope","$resource","$log","$state",function(a,b,c){var d={OrgRegistration:b("/api/organization/:orgid",{},{getAllOrgs:{method:"GET",isArray:!0},getOrgSettings:{method:"GET",params:{orgid:"@orgid"}},saveOrg:{method:"POST"},updateOrgSettings:{method:"PUT",params:{orgid:"@orgid"},isArray:!1},deleteOrgSettings:{method:"DELETE",params:{orgid:"@orgid"}}}),ManageOrgLocation:b("/api/orgaddress/:orgid/:orgaddressid",{},{getAllOrgAddress:{method:"GET",params:{orgid:"@orgid"}},addOrgAddress:{method:"POST",params:{orgid:"@orgid"}},updateOrgAddress:{method:"PUT",params:{orgid:"@orgid",orgaddressid:"@orgaddressid"},isArray:!1},deleteOrgAddressById:{method:"DELETE",params:{orgid:"@orgid",orgaddressid:"@orgaddressid"}}}),OtherOrgInvites:b("/api/otherorginvite/:orgid",{},{sendOtherOrgInvites:{method:"POST",params:{orgid:"@orgid"}}}),OrgCustomerInvites:b("/api/orgcustomerinvite/:orgid",{},{sendOrgCustomerInvites:{method:"POST",params:{orgid:"@orgid"}}}),OrgGroupInvites:b("/api/orginvite/:orgid",{},{sendGroupInvites:{method:"POST",params:{orgid:"@orgid"}}}),GetOrgGroupMembers:b("/api/orggroupmembers/:orgid",{},{getGroupDetails:{method:"GET",params:{orgid:"@orgid"}}}),RemoveOrgGroupMember:b("/api/orggroupmember/:orgid/:grpid/:userid",{},{deleteGrpMember:{method:"DELETE",params:{orgid:"@orgid",grpid:"@grpid",userid:"@userid"}}}),GetOrgProducts:b("/api/product/:orgid",{},{getAllOrgProducts:{method:"GET",params:{orgid:"@orgid"}}})},e={};return e.deleteMember=function(b,e){d.RemoveOrgGroupMember.deleteGrpMember({orgid:a.usersession.currentUser.org.orgid,grpid:b,userid:e},function(b){c.debug(b),a.$broadcast("deleteOrgGroupMemberDone",b)},function(b){c.debug(b),a.$broadcast("deleteOrgGroupMemberNotDone",b.status)})},e.RegisterOrg=function(b){d.OrgRegistration.saveOrg(b,function(b){c.debug(b),a.$broadcast("orgRegistrationDone",b)},function(b){c.debug(b),a.$broadcast("orgRegistrationNotDone",b.status)})},e.saveOrgSettings=function(b){d.OrgRegistration.updateOrgSettings({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("updateOrgDone",b)},function(b){c.debug(b),a.$broadcast("updateOrgNotDone",b.status)})},e.saveOrgAddress=function(b){d.ManageOrgLocation.addOrgAddress({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("addOrgAddressDone",b)},function(b){c.debug(b),a.$broadcast("addOrgAddressNotDone",b.status)})},e.updateOrgAddress=function(b,e){d.ManageOrgLocation.updateOrgAddress({orgid:a.usersession.currentUser.org.orgid,orgaddressid:e},b,function(b){c.debug(b),a.$broadcast("updateOrgAddressDone",b)},function(b){c.debug(b),a.$broadcast("updateOrgAddressNotDone",b.status)})},e.removeOrgAddress=function(b){d.ManageOrgLocation.deleteOrgAddressById({orgid:a.usersession.currentUser.org.orgid,orgaddressid:b},function(b){c.debug(b),a.$broadcast("deleteOrgAddressDone",b)},function(b){c.debug(b),a.$broadcast("deleteOrgAddressNotDone",b.status)})},e.removeOrgSettings=function(){d.OrgRegistration.deleteOrgSettings({orgid:a.usersession.currentUser.org.orgid},function(b){c.debug(b),a.$broadcast("deleteOrgDone",b)},function(b){c.debug(b),a.$broadcast("deleteOrgNotDone",b.status)})},e.updateOrgData=function(a){e.currentOrgData=a},e.updateOrgAdd=function(b){e.currentOrgAdd=b,a.$broadcast("getOrgAddData",b)},e.sendInvites=function(b){d.OtherOrgInvites.sendOtherOrgInvites({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("sendOrgInvitesDone",b)},function(b){c.debug(b),a.$broadcast("sendOrgInvitesNotDone",b.status)})},e.sendCustomerInvites=function(b){d.OrgCustomerInvites.sendOrgCustomerInvites({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("sendOrgCustomerInvitesDone",b)},function(b){c.debug(b),a.$broadcast("sendOrgCustomerInvitesNotDone",b.status)})},e.groupInvites=function(b){d.OrgGroupInvites.sendGroupInvites({orgid:a.usersession.currentUser.org.orgid},b,function(b){c.debug(b),a.$broadcast("sendOrgGroupInvitesDone",b)},function(b){c.debug(b),a.$broadcast("sendOrgGroupInvitesNotDone",b.status)})},e}]),angular.module("prodo.ProdoWallApp").controller("ProdoDashboardController",["$scope","$state","dataFromService",function(a,b,c){console.log("data received from resolve"+JSON.stringify(c)),a.data=[{key:"Awesome",y:500},{key:"Good",y:200},{key:"Average",y:900},{key:"Bad",y:700},{key:"Worst",y:400}]}]),angular.module("prodo.CommonApp").directive("prodonusPasswordCheck",["$parse",function(a){return{require:"ngModel",link:function(b,c,d,e){b.$watch(function(){return a(d.prodonusPasswordCheck)(b)===e.$modelValue},function(a){e.$setValidity("mismatch",a)})}}}]).directive("prodonusPasswordValidate",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(b){return a.pwdValidLength=b&&b.length>=6?"valid":void 0,a.pwdHasAlphabet=b&&/[A-z]/.test(b)?"valid":void 0,a.pwdHasNumber=b&&/\d/.test(b)?"valid":void 0,a.pwdHasSymbol=b&&/(?=(?:.*[!@#$%^&*-]){1})/.test(b)?"valid":void 0,a.pwdValidLength&&a.pwdHasAlphabet&&a.pwdHasNumber&&a.pwdHasSymbol?(d.$setValidity("pwd",!0),b):void d.$setValidity("pwd",!1)})}}}).directive("prodonusMultiEmailValidate",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(b){return a.emailHas=b&&/(([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)(\s*,\s*|\s*$)+)/.test(b)?"valid":void 0,a.emailHas?(d.$setValidity("email",!0),b):void d.$setValidity("email",!1)})}}}).directive("notification",["$timeout",function(a){return{restrict:"E",replace:!0,scope:{ngModel:"="},template:'<div class="alert alert-info fade" bs-alert="ngModel"></div>',link:function(b,c){a(function(){c.hide()},6e5)}}}]).directive("popdown",function(){return{restrict:"E",scope:{},replace:!0,controller:["$scope","PopdownAPI",function(a,b){function c(){a.show=!(!a.api.status||!a.api.message)}a.show=!1,a.api=b,a.$watch("api.status",c),a.$watch("api.message",c),a.hide=function(){a.show=!1,a.api.clear()}}],template:'<div class="alert alert-{{api.status}}" ng-show="show">  <button type="button" class="close" ng-click="hide()">&times;</button>  {{api.message}}</div>'}}).directive("prodoAlertMessage",["$timeout",function(){return{restrict:"EA",replace:!0,template:'<div style="text-align:left; padding: 8px; margin: 10px;" class="alert {{mainAlert.alertType}}" ng-show="mainAlert.isShown"><button type="button" class="close" ng-click="closeAlert()" aria-hidden="true">&times;</button>{{mainAlert.message}}<a href="#/{{mainAlert.linkpage}}" class="alert-link"> {{mainAlert.linkmessage}}</a></div>',controller:["$scope","$rootScope",function(a){a.mainAlert={isShown:!1},a.showAlert=function(b,c,d,e){a.mainAlert.message=c,a.mainAlert.isShown=!0,a.mainAlert.linkpage=d,a.mainAlert.linkmessage=e,a.mainAlert.alertType=b},a.showmessage=function(b,c,d,e){var f=b,g=c,h=d,i=e;return a.showAlert(f,g,h,i),!0},a.closeAlert=function(){a.mainAlert.isShown=!1},a.hideAlert=function(){a.mainAlert.isShown=!1}}]}}]).directive("prodoSpinner",["$timeout",function(){return{restrict:"EA",replace:!0,template:'<span ng-show="spinner.isShown"><i style="color:yellow;" class="fa fa-spinner fa-spin"></i></span>',controller:["$scope","$rootScope",function(a){a.spinner={isShown:!1},a.showSpinner=function(){a.spinner.isShown=!0},a.hideSpinner=function(){a.spinner.isShown=!1}}]}}]).directive("prodovideo",function(){return{restrict:"EA",replace:!0,transclude:!0,scope:{video:"@"},template:'<div class="prodovideo"><iframe ng-src="{{ video }}"></iframe></div>',link:function(a,b,c){var d=c.height/c.width*100;b[0].style.paddingTop=d+"%"}}}).directive("prodoSlider",function(){var a={restrict:"A",link:function(){$("#layerslider").layerSlider({autoStart:!0,responsive:!0,responsiveUnder:0,sublayerContainer:0,firstLayer:1,twoWaySlideshow:!1,randomSlideshow:!1,keybNav:!0,touchNav:!0,imgPreload:!0,navPrevNext:!0,navStartStop:!0,navButtons:!0,thumbnailNavigation:"hover",tnWidth:100,tnHeight:60,tnContainerWidth:"60%",tnActiveOpacity:35,tnInactiveOpacity:100,hoverPrevNext:!0,hoverBottomNav:!0,pauseOnHover:!0,globalBGColor:"transparent",globalBGImage:!1,animateFirstLayer:!0,yourLogo:!1,yourLogoStyle:"position: absolute; z-index: 1001; left: 10px; top: 10px;",yourLogoLink:!1,yourLogoTarget:"_blank",loops:0,forceLoopNum:!0,autoPlayVideos:!0,autoPauseSlideshow:"auto",showBarTimer:!1,showCircleTimer:!1,slideDirection:"right",slideDelay:4e3,durationIn:1e3,durationOut:1e3,easingIn:"easeInOutQuint",easingOut:"easeInOutQuint",delayIn:0,delayOut:0})}};return a}).directive("prodoNav",function(){var a={restrict:"A",link:function(){$("document").ready(function(){$("ul.nav.nav-pills li a").click(function(){$(this).parent().addClass("active").siblings().removeClass("active")})})}};return a}).directive("showtab",function(){return{link:function(a,b){b.click(function(a){a.preventDefault(),$(b).tab("show")})}}}).directive("prodoUnique",["$http",function(a){var b={restrict:"A",require:"ngModel",link:function(b,c,d,e){$("#prodo-form-input-username-signup").on("keyup",function(){var b=$(this).val().trim(),c={username:b};b.length>2&&b.length<15&&a({method:"GET",url:"/api/userunique/"+b,data:c}).success(function(a){a.success?(console.log(a.success.message),e.$setValidity("nametaken",!0)):"AV001"==a.error.code?(console.log(a.error.code+a.error.message),e.$setValidity("namelength",!1)):"ED001"==a.error.code?(console.log(a.error.code+a.error.message),e.$setValidity("nametaken",!1)):"ED003"==a.error.code&&(console.log(a.error.code+a.error.message),e.$setValidity("nametaken",!1))}).error(function(a){console.log(a)})})}};return b}]).directive("prodoBarchart",function(){var a={restrict:"EA",link:function(){function a(){return[{key:"Product Ratings",values:[{label:"Awsome ",value:300},{label:"Average",value:600},{label:"Good",value:200},{label:"Bad",value:400},{label:"Worst",value:10},{label:"Complaints",value:20}]}]}nv.addGraph(function(){var b=nv.models.discreteBarChart().x(function(a){return a.label}).y(function(a){return a.value}).staggerLabels(!0).tooltips(!0).showValues(!0);return d3.select("#chart").datum(a()).transition().duration(50).call(b),nv.utils.windowResize(b.update),b})}};return a}).directive("prodoPiechart",function(){var a={restrict:"EA",link:function(a){nv.addGraph(function(){var b=500,c=500,d=nv.models.pieChart().x(function(a){return a.key}).y(function(a){return a.y}).color(d3.scale.category10().range()).width(b).height(c);return d3.select("#test1").datum(a.data).transition().duration(1200).attr("width",b).attr("height",c).call(d),d.dispatch.on("stateChange",function(a){nv.log("New State:",JSON.stringify(a))}),d})}};return a}).directive("prodoProductChart",function(){var a={restrict:"EA",link:function(){var a=d3.select("#a").append("div").attr("class","abc").style("opacity",0),b=d3.select("#a").style("background-image","url(http://s1.ibtimes.com/sites/www.ibtimes.com/files/styles/v2_article_large/public/2013/09/18/apple-iphone-5s-release.jpg) ").style("background-repeat","no-repeat").style("background-size","78%"),c=b.append("svg"),d=c.append("circle").attr("cx",389).attr("cy",54).attr("r",5).style("fill","blue").style("position","relative");d.on("mouseenter",function(){d.attr("r",10).style("fill","none").style("stroke","red").style("stroke-opacity",1e-6).style("stroke-width",3).transition().duration(500).attr("r",5).style("fill","blue").style("stroke-opacity",2),a.text("Front Camera").style("opacity",2).style("left","400px").style("bottom","265px")}).on("mouseout",function(){d.attr("r",5).style("stroke","none"),a.style("opacity",0).style("left","0px").style("bottom","0px")}),screenCircle=c.append("circle").attr("cx",192).attr("cy",90).attr("r",5).style("fill","blue").style("position","relative").on("mouseover",function(){screenCircle.attr("r",10).style("fill","none").style("stroke","red").style("stroke-opacity",1e-6).style("stroke-width",3).transition().duration(500).attr("r",5).style("fill","blue").style("stroke-opacity",2),a.text("Screen").style("opacity",2).style("left","200px").style("bottom","220px")}).on("mouseout",function(){screenCircle.attr("r",5).style("stroke","none"),a.style("opacity",0).style("left","0px").style("bottom","0px")}),speakersCircle=c.append("circle").attr("cx",120).attr("cy",300).attr("r",4).style("fill","blue").style("position","relative").on("mouseover",function(){speakersCircle.attr("r",10).style("fill","none").style("stroke","red").style("stroke-opacity",1e-6).style("stroke-width",3).transition().duration(500).attr("r",4).style("fill","blue").style("stroke-opacity",2),a.text("Speakers").style("opacity",2).style("left","122px").style("bottom","38px")}).on("mouseout",function(){speakersCircle.attr("r",4).style("stroke","none").style("left","0px").style("bottom","0px"),a.style("opacity",0)})}};return a}).directive("prodoIndia",function(){var a={restrict:"EA",link:function(){function a(){c.scale(6700),c.translate([-1240,720])}var b,c=d3.geo.mercator(),d=d3.geo.path().projection(c),e=d3.select("#map").append("svg:svg").attr("class","maps").attr("width",600).attr("height",800).call(a),f=e.append("svg:g").attr("id","india"),g=d3.select("#map").append("div").attr("class","abctooltip").style("opacity",0);d3.json("../../dashboard/json/IndiaData.json",function(a){f.selectAll("path").data(a.features).enter().append("path").attr("d",d)}),d3.json("../../dashboard/json/Counties.json",function(a){b=a.reduce(function(a,b){return a[b.id]=b,a},{}),f.selectAll("path").style("fill",function(a){return a.amount<2?"rgb(247,251,255)":a.amount>1&&a.amount<3?"rgb(8,48,107)":a.amount>2&&a.amount<4?"rgb(8,81,156)":a.amount>3&&a.amount<5?"rgb(8,81,156)":"rgb(8,48,107)"}).attr("d",d).on("mouseover",function(a){d3.select("#subtitle").text(a.id);g.text("State: "+a.id+"  Number of Customers: "+1e5*a.amount).style("opacity",4).style("left",d3.event.pageX+5+"px").style("top",d3.event.pageY+5+"px");d3.select("#subblurb").text(a.comment);console.log("The amount is "+a.amount)}).on("mouseout",function(){g.style("opacity",0)}).on("click",function(){})})}};return a}).directive("generalSearch",["$http","$rootScope",function(a,b){var c={restrict:"A",require:"ngModel",link:function(c){$("#searchText").on("keyup",function(){c.errors="";var d=$(this).val().trim(),e={name:d,orgid:b.orgid};""!==d&&a({method:"POST",url:"/api/allproduct/",data:e}).success(function(a){a.error?"AD001"===a.error.code&&(c.errors="Please assign orgid"):a.success&&0===a.name.doc.length&&(""===d?c.errors="":(c.errors="No products found for \n '"+b.orgdata.name+"'",window.setTimeout(function(){c.toggleTitleForDiv()},1e3))),c.enhancement={},c.productNames=[],c.enhancement=a.name.doc,c.productNames=a.success.doc}).error(function(){c.errors="Server Error"})})}};return c}]),angular.module("prodo.AdminApp").factory("tagAddService",["$rootScope","$resource","$state",function(a,b){var c={Product:b("/api/tagreffdictionary/addtag",{},{addTags:{method:"POST"}})},d={};return d.addTagFunction=function(b){c.Product.addTags(b,function(b){$log.debug(b),a.$broadcast("tagAddedSuccessfully",b)}),function(b){$log.debug(b),a.$broadcast("tagsNotAddedSuccessfully",b)}},d}]),angular.module("prodo.AdminApp").controller("prodoAdminTagInputController",["$scope","$log","$rootScope","UserSessionService","$http","tagAddService",function(a,b,c,d,e,f){a.category_selection,a.option1,a.option2,a.objectComponents={},a.tagInfo={},a.tagid,a.tagname,a.result,a.level,a.emotion,a.urls,a.emotionvalueinsert,a.trimmedURL,a.setEmotion=function(){"Love"===a.category_selection?(a.option1="Serenity [10]",a.option2="Joy [20]",a.option3="Ecstasy [30]"):"Optimism"===a.category_selection?(a.option1="Interest [10]",a.option2="Anticipation [20]",a.option3="Vigilance [30]"):"Aggressiveness"===a.category_selection?(a.option1="Annoyance [10]",a.option2="Anger [20]",a.option3="Rage [30]"):"Contempt"===a.category_selection?(a.option1="Boredom [10]",a.option2="Disgust [20]",a.option3="Loathing [30]"):"Remorse"===a.category_selection?(a.option1="Pensiveness [10]",a.option2="Sadness [20]",a.option3="Grief [30]"):"Disapproval"===a.category_selection?(a.option1="Distraction [10]",a.option2="Surprise [20]",a.option3="Amazement [30]"):"Awe"===a.category_selection?(a.option1="Apprehension [10]",a.option2="Fear [20]",a.option3="Terror [30]"):"Submission"===a.category_selection&&(a.option1="Acceptance [10]",a.option2="Trust [20]",a.option3="Adoration [30]")},a.submitTag=function(){a.objectComponents.tagname=a.tagname,a.objectComponents.emotions={},a.objectComponents.emotions.category=a.category_selection,a.objectComponents.emotions.emotion=a.emotion,a.objectComponents.emotions.level=a.level,a.objectComponents.emotions.result=a.result;var b=document.getElementById("4").value;if(b){var c=b.lastIndexOf(b.indexOf("\\")>=0?"\\":"/"),d=b.substring(c);(0===d.indexOf("\\")||0===d.indexOf("/"))&&(d=d.substring(1)),a.trimmedURL=d}a.objectComponents.emotions.emotion_url=a.trimmedURL,a.tagInfo.tagreffdicdata={},a.tagInfo.tagreffdicdata=a.objectComponents,f.addTagFunction(a.tagInfo)},a.$on("$destroy",function(){})}]),angular.module("prodo.ProductApp").controller("DragImageController",["$scope","$rootScope","$log","growl",function(a,b,c,d){function e(a){j.filereader===!0&&k[a.type]===!0?(g=new FileReader,g.onload=function(a){$("#prodo-uploadedCommentImage").css("display","inline"),document.getElementById("crossButton").style.display="inline",$("#prodo-uploadedCommentImage").attr("src",a.target.result),b.comment_image_l=[{image:a.target.result}]},g.readAsDataURL(a)):i.innerHTML+=" Uploaded "+a.name+" "+(a.size?(a.size/1024|0)+"K":""),h=new FileReader,h.onload=function(c){var d=c.target.result;b.file_data={filetype:a.type,filename:a.name,filebuffer:d}},h.readAsBinaryString(a)}function f(a){for(var b=j.formdata?new FormData:null,d=0;d<a.length;d++)j.formdata&&b.append("file",a[d]),e(a[d]),c.debug(a[d].name)}var g,h;b.count=0;{var i=document.getElementById("holder"),j={filereader:"undefined"!=typeof FileReader,dnd:"draggable"in document.createElement("span"),formdata:!!window.FormData},k=({filereader:document.getElementById("filereader"),formdata:document.getElementById("formdata"),progress:document.getElementById("progress")},{"image/png":!0,"image/jpeg":!0,"image/gif":!0});document.getElementById("upload")}j.dnd&&(i.ondragover=function(){return this.className="hover",!1},i.ondragend=function(){return this.className="",!1},i.ondragleave=function(){return this.className="",!1},i.ondrop=function(a){b.count++,this.className="",a.preventDefault(),a.dataTransfer.files[0].size/1024>500?d.addErrorMessage(" Image size must ne less than 500kb "):k[a.dataTransfer.files[0].type]===!1?d.addErrorMessage("Add image only"):b.count>1?d.addErrorMessage("Add only one image at a time"):1==b.count&&k[a.dataTransfer.files[0].type]===!0&&a.dataTransfer.files[0].size/1024<500&&f(a.dataTransfer.files)}),a.clearReader=function(){c.debug("Clear called"),document.getElementById("prodo-comment-commentContainer").style.marginTop="0px",document.getElementById("crossButton").style.display="none",document.getElementById("prodo-uploadedCommentImage").style.display="none",g.abort(),h.abort(),g=new FileReader,h=new FileReader,b.file_data="",b.count=0;document.getElementById("prodo-uploadedCommentImage")}}]),angular.module("prodo.ProductApp").controller("ProductController",["$scope","$log","$rootScope","ProductService","UserSessionService","$http","CommentLoadMoreService","ENV","TagReffDictionaryService","ProductFeatureService","growl",function(a,b,c,d,e,f,g,h,j,k,l){a.productComments={comments:[{}]},a.newProductComment=[],c.productCommentResponsearray=[],a.mytags,a.myFeaturetags,a.count=0,a.commenttextField={userComment:""},a.pretags=[],a.featuretags=[],a.productcommentResponseListener,a.tagPairs=[],a.editStatus,a.product={product:[{}]},a.newProduct={product:[{}]},a.type="product",c.product_prodle,c.orgid,a.pImages_l={product_images:[{}]},a.currentProdle,a.currentOrgid,a.userIDFromSession,a.usernameFromSession,a.grpnameFromSession,a.orgnameFromSession,a.orgidFromSession,a.ProductsFollowedFromSession=[],a.socket,c.$watch("product_prodle",function(){a.features=[],$("#productLogo").attr("src","");document.getElementById("prodo-comment-container");void 0!==c.product_prodle&&null!==c.product_prodle&&""!==c.product_prodle?a.getProduct(c.product_prodle,c.orgid):($("#prodo-ProductDetails").css("display","none"),$("#ErrMsging").css("display","block"),document.getElementById("ErrMsging").innerHTML="Product not available")}),a.getUserDetails=function(){c.usersession.currentUser.org?(a.grpnameFromSession=c.usersession.currentUser.org.grpname,a.orgidFromSession=c.usersession.currentUser.org.orgid,a.orgnameFromSession=c.usersession.currentUser.org.orgname):(a.grpnameFromSession="",a.orgnameFromSession="",a.orgidFromSession=""),a.userIDFromSession=c.usersession.currentUser.userid,a.usernameFromSession=c.usersession.currentUser.username,a.ProductsFollowedFromSession=e.productfollowlist},a.getUserDetails(),a.getProduct=function(e,f){b.debug("1 prodle "+e+"orgid "+f),d.getProduct({orgid:f,prodle:e},function(b){void 0==b.success?($("#prodo-ProductDetails").css("display","none"),$("#ErrMsging").css("display","block"),null!==document.getElementById("ErrMsging")&&(document.getElementById("ErrMsging").innerHTML="Product not available , please select product....")):($("#prodo-ProductDetails").css("display","block"),$("productExtraInfo").css("display","block"),$("#ErrMsging").css("display","none"),a.getProductFeatures(e,f),$("#prodo-ProductFeatureTable").css("display","table"),a.product=b.success.product,a.productComments=b.success.product.product_comments,console.log(a.productComments),a.pImages_l=b.success.product.product_images,$("#prodo-addingProduct").text(a.product.status),c.usersession.currentUser.org&&1==c.usersession.currentUser.org.isAdmin&&(c.isAdminCheck=a.orgidFromSession===a.currentOrgid?!0:!1),$("#loadMoreCommentMsg").css("display","none"),b.success.product.product_comments&&(b.success.product.product_comments.length<4?$("#load-more").css("display","none"):$("#load-more").css("display","inline")),void 0==b.success.product.product_comments&&$("#loadMoreCommentMsg").css("display","none"))},function(a){b.debug(a),$("#prodo-ProductDetails").css("display","none"),$("#ErrMsging").css("display","inline"),document.getElementById("ErrMsging").innerHTML="Server Error:"+a.status})},a.features=[],a.PFeatures=[],a.getProductFeatures=function(b,d){""!==b&&k.getFeature({orgid:d,prodle:b},function(b){if(void 0==b.success)1==c.usersession.currentUser.org.isAdmin;else for(a.features=[],a.featuretags=[],i=0;i<b.success.productfeature.length;i++)a.features.push(b.success.productfeature[i]),a.PFeatures.push(b.success.productfeature[i]),a.featuretags.push(b.success.productfeature[i].featurename)
},function(a){l.addErrorMessage("Server Error:"+a.status)})},a.ShowDescription=function(){"15px"===document.getElementById("prodo-description").style.height?$("#prodo-description").css("height",""):$("#prodo-description").css("height","15px")},a.CheckIfAlreadyFollowingProduct=function(){var b;for(i=0;i<a.ProductsFollowedFromSession.length;i++)a.ProductsFollowedFromSession[i].prodle==c.product_prodle&&(b=!0);return 1==b?{display:"none"}:{display:"inline"}},a.followCurrentProduct=function(){c.usersession.followProduct(c.product_prodle)};var m=a.$on("followProductDone",function(b,c){c.success&&(l.addSuccessMessage("Follwing product"),e.productfollowlist.push(a.product),$("#prodo-followBtn").css("display","none"))});a.$on("$destroy",function(){m()}),a.formatDate=function(a){return moment(a).format("DD MMM YYYY")}}]),angular.module("prodo.ProductApp").controller("ManageProductController",["$scope","$log","$rootScope","ProductService","UserSessionService","$http","CommentLoadMoreService","ENV","TagReffDictionaryService","ProductFeatureService","growl","allproductdata","$state",function(a,b,c,d,e,f,g,h,j,k,l,m,n){a.$state=n,a.editStatus,a.product={product:[{}]},a.newProduct={product:[{}]},a.type="product",a.productlist=[],c.product_prodle,c.orgid,a.pImages_l={product_images:[{}]},a.currentProdle,a.currentOrgid,a.userIDFromSession,a.usernameFromSession,a.grpnameFromSession,a.orgnameFromSession,a.orgidFromSession,a.ProductsFollowedFromSession=[],a.socket,a.$watch("$state.$current.locals.globals.allproductdata",function(c){c.error?temp.innerHTML="<br>Product not available ... Add new product<br><br>":(a.productlist=c.success.product,0==a.productlist.length&&(temp.innerHTML="<br>Product not available ... Add new product<br><br>"),0!==a.productlist.length&&(b.debug("prodle "+a.productlist.length),b.debug("prodle "+a.productlist[a.productlist.length-1].prodle+"orgid "+a.orgidFromSession),a.currentProdle=a.productlist[a.productlist.length-1].prodle,a.currentOrgid=a.productlist[a.productlist.length-1].orgid,a.getProduct(a.currentProdle,a.currentOrgid)))}),a.getUserDetails=function(){c.usersession.currentUser.org?(a.grpnameFromSession=c.usersession.currentUser.org.grpname,a.orgidFromSession=c.usersession.currentUser.org.orgid,a.orgnameFromSession=c.usersession.currentUser.org.orgname):(a.grpnameFromSession="",a.orgnameFromSession="",a.orgidFromSession=""),a.userIDFromSession=c.usersession.currentUser.userid,a.usernameFromSession=c.usersession.currentUser.username,a.ProductsFollowedFromSession=e.productfollowlist},a.getUserDetails(),a.getProduct=function(e,f){b.debug("1 prodle "+e+"orgid "+f),d.getProduct({orgid:f,prodle:e},function(b){void 0==b.success?($("#prodo-ProductDetails").css("display","none"),$("#ErrMsging").css("display","block"),null!==document.getElementById("ErrMsging")&&(document.getElementById("ErrMsging").innerHTML="Product not available , please select product....")):($("#prodo-ProductDetails").css("display","block"),$("productExtraInfo").css("display","block"),$("#ErrMsging").css("display","none"),a.getProductFeatures(e,f),$("#prodo-ProductFeatureTable").css("display","table"),a.product=b.success.product,a.productComments=b.success.product.product_comments,a.pImages_l=b.success.product.product_images,$("#prodo-addingProduct").text(a.product.status),c.usersession.currentUser.org&&1==c.usersession.currentUser.org.isAdmin&&(c.isAdminCheck=a.orgidFromSession===a.currentOrgid?!0:!1))},function(a){b.debug(a),$("#prodo-ProductDetails").css("display","none"),$("#ErrMsging").css("display","inline"),document.getElementById("ErrMsging").innerHTML="Server Error:"+a.status})},a.handleSaveProductResponse=function(a){a.success?(l.addSuccessMessage(a.success.message),n.reload()):"AV001"==a.error.code?(b.debug(a.error.code+" "+a.error.message),l.addErrorMessage(a.error.message)):"AP001"==a.error.code?(b.debug(a.error.code+" "+a.error.message),l.addErrorMessage(a.error.message)):(b.debug(a.error.message),l.addErrorMessage(a.error.message))},a.addProduct=function(e){$("productExtraInfo").css("display","none"),$("#ErrMsging").css("display","none"),"add"==e?(a.newProduct={product:{model_no:a.product.model_no,name:a.product.name,description:a.product.description}},1==c.usersession.currentUser.org.isAdmin?d.saveProduct({orgid:a.orgidFromSession},a.newProduct,function(c){b.debug(c),a.handleSaveProductResponse(c)},function(a){b.debug(a)}):l.addErrorMessage("You dont have rights to add product...")):"update"==e&&(a.newProduct={product:{model_no:a.product.model_no,name:a.product.name,description:a.product.description,support_discontinuation_date:a.product.supDis,sale_discontinuation_date:a.product.prodDis,banneddate:a.product.banneddate}},1==c.usersession.currentUser.org.isAdmin?a.orgidFromSession===a.currentOrgid&&d.updateProduct({orgid:a.orgidFromSession,prodle:a.currentProdle},a.newProduct,function(b){a.handleSaveProductResponse(b),a.getProduct(a.currentProdle,a.currentOrgid)},function(a){b.debug(a)}):l.addErrorMessage("You dont have rights to update this product..."))},a.deleteProduct=function(){l.addInfoMessage("Deleting product  ..."),void 0!==a.currentProdle&&null!==a.currentProdle&&""!==a.currentProdle&&(1==c.isAdminCheck?d.deleteProduct({orgid:a.orgidFromSession,prodle:a.currentProdle},function(a){b.debug(JSON.stringify(a)),l.addSuccessMessage("Product deleted successfully..."),$("#prodo-ProductDetails").css("display","none"),n.reload()},function(a){b.debug(JSON.stringify(a))}):l.addErrorMessage("You dont have rights to delete this product..."))},a.clearText=function(){a.product="",a.pImages_l="",a.features=""},a.selectAllImages=function(){$(".imgToggles").is(":checked")?$(".imgToggles").prop("checked",!1):$(".imgToggles").prop("checked",!0)},a.checkedAllIndex=function(b){for(i=0;i<b.length;i++)a.chckedIndexs.push(b[i])},a.chckedIndexs=[],a.checkedIndex=function(b){-1===a.chckedIndexs.indexOf(b)?a.chckedIndexs.push(b):a.chckedIndexs.splice(a.chckedIndexs.indexOf(b),1)},a.deleteProductImages=function(){1==c.isAdminCheck?(l.addInfoMessage("Deleting product images ..."),a.imgIds=[{}],a.ids,$(":checkbox:checked").each(function(b){a.imgIds[b]=$(this).val(),a.ids=$(this).val()}),angular.forEach(a.chckedIndexs,function(b){a.pImages_l.indexOf(b);a.pImages_l.splice(a.pImages_l.indexOf(b),1)}),a.chckedIndexs=[],a.temp={prodleimageids:a.imgIds},f({method:"DELETE",url:h.apiEndpoint_notSocket+"/api/image/product/"+a.orgidFromSession+"/"+a.currentProdle+"?prodleimageids="+a.imgIds}).success(function(){l.addSuccessMessage("Images deleted successfully...")}).error(function(a,b){l.addErrorMessage(b)})):l.addErrorMessage("You dont have rights to delete this feature")},a.checkAdmintoUpdateProduct=function(){return c.usersession.currentUser.org?1==c.usersession.currentUser.org.isAdmin?a.orgidFromSession===a.currentOrgid?(c.isAdminCheck=!0,{display:"block"}):{display:"none"}:{display:"none"}:{display:"none"}},a.checkAdmin=function(){c.usersession.currentUser.org&&1==c.usersession.currentUser.org.isAdmin&&a.orgidFromSession===a.currentOrgid&&(c.isAdminCheck=!0),1==c.isAdminCheck?$("#prodo.productAdminAddProduct").css("display","inline"):1==c.usersession.currentUser.org.isAdmin?($("#prodo.productAdmin").css("display","none"),$("#prodo.productAdminAddProduct").css("display","inline")):($("#prodo.productAdmin").css("display","none"),$("#prodo.productAdminAddProduct").css("display","none"))},a.checkImageSelectedToDelete=function(){a.chckedIndexs.length>0?($("#imgDelModal").modal("toggle"),$("#imgDelModal").modal("show")):l.addErrorMessage("Select atlest 1 image to delete")},a.checkAdminProductImagesDelete=function(){return 1==c.isAdminCheck?{display:"inline"}:{display:"none"}},a.features=[],a.PFeatures=[],a.getProductFeatures=function(b,d){""!==b&&k.getFeature({orgid:d,prodle:b},function(b){if(void 0==b.success)1==c.usersession.currentUser.org.isAdmin;else for(a.features=[],a.featuretags=[],i=0;i<b.success.productfeature.length;i++)a.features.push(b.success.productfeature[i]),a.PFeatures.push(b.success.productfeature[i]),a.featuretags.push(b.success.productfeature[i].featurename)},function(a){l.addErrorMessage("Server Error:"+a.status)})},a.deleteFeature=function(d){void 0!==d&&null!==d&&""!==d&&(l.addInfoMessage("Deleting product feature ..."),1==c.isAdminCheck?k.deleteFeature({orgid:a.orgidFromSession,prodle:a.currentProdle,productfeatureid:d.featureid},function(b){var c=a.features.indexOf(d);-1!=c&&a.features.splice(c,1),l.addSuccessMessage(b.success.message)},function(a){b.debug(JSON.stringify(a)),l.addErrorMessage(JSON.stringify(a))}):l.addErrorMessage("You dont have rights to delete this feature..."))},a.addProductFeature=function(d){a.newFeature={},a.newFeature={productfeature:[{featurename:a.feature.name,featuredescription:a.feature.description}]},void 0!==a.newFeature&&null!==a.newFeature&&""!==a.newFeature&&"add"==d&&(1==c.isAdminCheck?k.saveFeature({orgid:a.orgidFromSession,prodle:a.currentProdle},a.newFeature,function(c){a.handleSaveProductResponse(c),b.debug("new Feature : "+JSON.stringify(a.newFeature.productfeature[0])),a.features.push(a.newFeature.productfeature[0]),l.addSuccessMessage("Feature added successfully"),b.debug(a.features),a.feature=""},function(a){l.addErrorMessage(a),b.debug(a)}):l.addErrorMessage("You dont have rights to add product feature..."))},a.updateProductFeature=function(d,e){console.log(d),void 0!==d&&null!==d&&""!==d&&(1==c.isAdminCheck?k.updateFeature({orgid:a.orgidFromSession,prodle:a.currentProdle,productfeatureid:e},{productfeature:d},function(b){a.handleSaveProductResponse(b),l.addSuccessMessage(b.success.message)},function(a){b.debug(a),l.addErrorMessage(a)}):l.addErrorMessage("You dont have rights to update product feature..."))},a.editorEnabled=!1,a.editorEnabledF=!1,a.enableEditor=function(){a.editorEnabled=!0,l.addInfoMessage("   Adding product data.....")},a.disableEditor=function(){a.editorEnabled=!1,a.feature="",void 0!==a.currentProdle&&null!==a.currentProdle&&""!==a.currentProdle&&(a.getProduct(a.currentProdle,a.currentOrgid),a.getProductFeatures(a.currentProdle,a.currentOrgid))},a.enableEditorFeature=function(){a.editorEnabledF=!0,l.addInfoMessage("   Adding product data.....")},a.disableEditorFeature=function(){a.editorEnabledF=!1,a.feature="",void 0!==a.currentProdle&&null!==a.currentProdle&&""!==a.currentProdle&&(a.getProduct(a.currentProdle,a.currentOrgid),a.getProductFeatures(a.currentProdle,a.currentOrgid))},$(document).ready(function(){1==c.isAdminCheck?($("#productLogoUpload").css("display","inline"),$("#productLogo").hover(function(){$("#productLogoUpload").show()},function(){setTimeout(function(){$("#productLogoUpload").hide()},3e3)})):$("#productLogoUpload").css("display","none")}),a.getSelectedProduct=function(b){a.currentProdle=b.prodle,a.currentOrgid=b.orgid,a.getProduct(a.currentProdle,a.currentOrgid)},a.currentPage=0,a.pageSize=4,a.numberOfPages=function(){return Math.ceil(a.productlist.length/a.pageSize)},a.selectedFeature,a.getSelectedFeature=function(b){a.selectedFeature=b},a.formatDate=function(a){return moment(a).format("DD MMM YYYY")}}]),angular.module("prodo.ProductApp").filter("startFrom",function(){return function(a,b){return void 0!==a&&void 0!==b?(b=+b,a.slice(b)):void 0}}),angular.module("prodo.ProductApp").controller("ProductCommentController",["$scope","$log","$rootScope","ProductService","UserSessionService","$http","CommentLoadMoreService","ENV","TagReffDictionaryService","ProductFeatureService","growl",function(a,b,c,d,e,f,g,h,k,l,m){function n(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function o(){return n()+"-"+n()+"-"+Date.now().toString()}k.getAllTags(function(b){if(void 0==b.success);else for(var c=0;c<b.success.tags.length;c++)a.pretags.push(b.success.tags[c].tagname)}),localStorage.sid=c.usersession.currentUser.sessionid,(""!==localStorage.sid||" "!==localStorage.sid||void 0!==localStorage.sid||null!==localStorage.sid)&&(b.debug("Socket = "+h.apiEndpoint),a.socket=io.connect(h.apiEndpoint+h.port+"/api/prodoapp",{query:"session_id="+localStorage.sid})),a.socket.removeAllListeners("addcommentResponse"),a.socket.on("addcommentResponse",function(c,d){c?(b.debug(c.error.message),a.showErrorIfCommentNotAdded(),a.showRetryIconIfCommentNotAdded()):d&&(a.ifErrorAddingComment=!1,b.debug("addcommentResponse success"+d.success.product_comment))}),a.productcommentResponseListener="productcommentResponse"+c.product_prodle,a.socket.removeAllListeners(a.productcommentResponseListener),a.socket.on(a.productcommentResponseListener,function(d,e){if(d)b.debug(d.error.message);else if(e){b.debug("productcomment  Response success"+JSON.stringify(e.success.product_comment)),a.newProductComment={product_comment:{user:{userid:e.success.product_comment.user.userid,username:e.success.product_comment.user.username,orgname:e.success.product_comment.user.orgname,grpname:e.success.product_comment.user.grpname,profilepic:e.success.product_comment.user.profilepic},commentid:e.success.product_comment.commentid,type:e.success.product_comment.type,datecreated:e.success.product_comment.datecreated,commenttext:e.success.product_comment.commenttext,analytics:a.tagPairs}},c.productCommentResponsearray.push(a.newProductComment.product_comment),b.debug(c.productCommentResponsearray),a.count=c.productCommentResponsearray.length,b.debug(a.count);var f=document.getElementById("responseComment");f.style.display="inline",f.innerHTML=a.count+" new comments"}}),a.commenttextField.userComment="",a.getTagsFromCommentText=function(){b.debug(a.pretags),a.mytags=a.pretags;var c=a.commenttextField.userComment,d=[];if(a.commenttextField.userComment)for(var e=c.split(" "),f=0;f<e.length;f++)for(var g=0;g<a.mytags.length;g++)e[f]==a.mytags[g]&&d.push(e[f]);a.mytags=d,a.myFeaturetags=a.featuretags;var d=[];if(a.commenttextField.userComment)for(var e=c.split(" "),f=0;f<e.length;f++)for(var g=0;g<a.myFeaturetags.length;g++)e[f]==a.myFeaturetags[g]&&d.push(e[f]);a.myFeaturetags=d,b.debug(a.mytags),b.debug(a.myFeaturetags)},a.$watch("commenttextField.userComment",function(){a.getTagsFromCommentText(),0==a.mytags.length?$("#prodo-productTags").css("display","none"):$("#prodo-productTags").css("display","inline")}),a.$watch("mytags",function(){a.mytags}),a.makeTagsPair=function(c,d){for(var e=0;e<d.length;e++)a.tagPairs.push(void 0==c[e]?{featureid:"1",featurename:a.features[0].featurename,tag:d[e]}:{featureid:"1",featurename:c[e],tag:d[e]});for(var e=0;e<a.features.length;e++)for(j=0;j<a.tagPairs.length;j++)a.features[e].featurename==a.tagPairs[j].featurename&&(a.tagPairs[j].featureid=a.features[e].featureid,b.debug("fn2"+a.tagPairs[j].featurename+" "+a.tagPairs[j].tag+" "+a.tagPairs[j].featureid))},a.addProductComment=function(){if(""!==a.commenttextField.userComment){b.debug("tags "+a.mytags),b.debug("features "+a.myFeaturetags),a.makeTagsPair(a.myFeaturetags,a.mytags),b.debug("Pair : "+JSON.stringify(a.tagPairs)),b.debug(c.file_data),b.debug(c.comment_image_l),""==c.file_data||" "==c.file_data||void 0==c.file_data||null==c.file_data?(a.newProductComment={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:o(),type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:a.commenttextField.userComment,analytics:a.tagPairs}},a.newProductComment_image={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:o(),type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:a.commenttextField.userComment,analytics:a.tagPairs}}):(a.newProductComment={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:o(),type:a.type,datecreated:Date.now(),commenttext:a.commenttextField.userComment,tags:a.mytags,comment_image:c.file_data,analytics:a.tagPairs}},a.newProductComment_image={product_comment:{user:{userid:a.userIDFromSession,username:a.usernameFromSession,orgname:a.orgnameFromSession,grpname:a.grpnameFromSession,profilepic:c.usersession.currentUser.profile_pic.image},commentid:o(),type:a.type,datecreated:Date.now(),tags:a.mytags,commenttext:a.commenttextField.userComment,comment_image:c.comment_image_l,analytics:a.tagPairs}},c.file_data="");var d;for(i=0;i<a.ProductsFollowedFromSession.length;i++)a.ProductsFollowedFromSession[i].prodle==c.product_prodle&&(d=!0);1==d?(b.debug(a.newProductComment),a.socket.emit("addComment",c.product_prodle,a.newProductComment.product_comment),a.productComments.unshift(a.newProductComment_image.product_comment),a.commenttextField.userComment="",a.tagPairs=[],c.count=0,document.getElementById("prodo-comment-commentContainer").style.marginTop="0px",document.getElementById("crossButton").style.display="none",$("#prodo-uploadedCommentImage").css("display","none"),a.mytags=""):m.addErrorMessage("Please follow this product to start commenting...")}},a.getLatestComments=function(){if(0!==c.productCommentResponsearray.length){b.debug(c.productCommentResponsearray),a.reversecomments_l=a.productCommentResponsearray.reverse(),b.debug(a.reversecomments_l),a.productComments=a.reversecomments_l.concat(a.productComments),b.debug(a.productComments);var d=document.getElementById("responseComment");d.style.display="none",d.innerHTML="",a.productCommentResponsearray.length=0,a.reversecomments_l.length=0,a.count=0}},a.hideIfNotUser=function(b){return b&&b!==a.userIDFromSession?{display:"none"}:void 0},a.hideIfNoOrg=function(a){return""==a||" "==a||void 0==a||null==a?{display:"none"}:void 0},a.hideIfNogrp=function(a){return""==a||" "==a||void 0==a||null==a?{display:"none"}:void 0},a.hideIfNotImage=function(a){return""==a||" "==a||void 0==a||null==a?{display:"none"}:void 0},a.showErrorIfCommentNotAdded=function(){var a=document.getElementById("responseComment");a.style.display="inline",a.innerHTML="Error adding comment please try again.."},a.showRetryIconIfCommentNotAdded=function(){var a=document.getElementById("retryIcon");a.style.display="inline"},a.handleLoadMoreCommentResponse=function(c){if(console.log(c),void 0!=c.success){b.debug(c.success.comment);for(var d=0;d<c.success.comment.length;d++)a.productComments.push(c.success.comment[d])}else $("#loadMoreCommentMsg").css("display","block"),$("#load-more").css("display","none"),"AC002"==c.error.code?($("#loadMoreCommentMsg").html(c.error.message),$("#load-more").hide(),b.debug(c.error.message)):"AC001"==c.error.code?(b.debug(c.error.message),$("#loadMoreCommentMsg").html(c.error.message)):(b.debug(c.error.message),$("#loadMoreCommentMsg").html(c.error.message))},$("#load-more").show(),a.getLastCommentId=function(){if(b.debug(a.productComments),a.productComments,a.productComments&&0!==a.productComments.length){var c=a.productComments.length;b.debug(c);var d=a.productComments[c-1];return b.debug(d.commentid),d.commentid}},a.loadMoreComments=function(){$("#img-spinner").show();var c=a.getLastCommentId();(""!==c||" "!==c||void 0!==c||null!==c)&&g.loadMoreComments({commentid:c},function(b){a.handleLoadMoreCommentResponse(b),$("#img-spinner").hide()},function(a){b.debug(a)})},$("#img-spinner").hide(),a.commentImageShow,a.captureCommentImageHere=function(b){a.commentImageShow=b}}]),angular.module("prodo.ProductApp").factory("ProductService",["$resource",function(a){return a("/api/product/:orgid/:prodle",{},{getProduct:{method:"GET",params:{orgid:"id",prodle:"id"}},updateProduct:{method:"PUT",params:{orgid:"id",prodle:"id"},isArray:!1},deleteProduct:{method:"DELETE",params:{orgid:"id",prodle:"id"}},saveProduct:{method:"POST",params:{orgid:"id"}}})}]).factory("ProductFeatureService",["$resource",function(a){return a("/api/productfeature/:orgid/:prodle/:productfeatureid",{},{getFeature:{method:"GET",params:{orgid:"id",prodle:"id"}},updateFeature:{method:"PUT",params:{orgid:"id",prodle:"id",productfeatureid:"id"},isArray:!1},deleteFeature:{method:"DELETE",params:{orgid:"id",prodle:"id",productfeatureid:"id"}},saveFeature:{method:"POST",params:{orgid:"id",prodle:"id"}}})}]).factory("CommentService",["$resource",function(a){return a("/api/comment/:commentid",{},{deleteComment:{method:"DELETE",params:{commentid:"id"}}})}]).factory("CommentLoadMoreService",["$resource",function(a){return a("/api/nextcomments/:commentid",{},{loadMoreComments:{method:"GET",params:{commentid:"id"}}})}]).factory("TagReffDictionaryService",["$resource",function(a){return a("/api/tagreffdictionary/getAllTag",{},{getAllTags:{method:"GET"}})}]),angular.module("prodo.WarrantyApp").controller("WarrantyController",["$scope","$log","WarrantyService","WarrantySaveService",function(a,b,c){a.warrantyComments={comments:[{}]},a.mytags,a.warranty,a.userIDFromSession,a.userFullnameFromSession,a.socket,a.newWarranty={product:[{}]},a.commenttextField={userComment:""},a.type="warranty",a.pretags=["addition","aggregate","all","bad news","budget","cost","damage","entirety","expense","extent","list","lot","net","outlay","output","price tag","product","quantum","score","set-back","sum","tab","tidy sum","whole","article","asset","belonging","chattel","goods","line","material","object","produce","property","specialty","stock","thing","ware","good"],a.showErrorIfCommentNotAdded=function(){var a=document.getElementById("responseComment");a.style.display="inline",a.innerHTML="Error adding comment please try again.."},a.showRetryIconIfCommentNotAdded=function(){var a=document.getElementById("retryIcon");a.style.display="inline"},a.socket=io.connect("http://ec2-54-254-210-45.ap-southeast-1.compute.amazonaws.com:8000",{query:"session_id="+localStorage.sid}),a.socket.on("addcommentResponse",function(c,d){c?(b.debug(c.error.message),a.showErrorIfCommentNotAdded(),a.showRetryIconIfCommentNotAdded()):d&&(a.ifErrorAddingComment=!1,b.debug("addcommentResponse success"+d.success.product_comment))}),a.socket.on("productcommentResponse",function(c,d){if(c)b.debug(c.error.message);else if(d){b.debug("productcomment  Response success"+d.success.product_comment),a.productCommentResponsearray.push(d.success.product_comment);var e=a.productCommentResponsearray.length;b.debug(e);var f=document.getElementById("responseComment");f.style.display="inline",f.innerHTML=e+" new comments"}}),a.handleSaveWarrantyResponse=function(a){a.success?alert(a.success.message):"AV001"==a.error.code?(b.debug(a.error.code+" "+a.error.message),alert(a.error.message)):"AP001"==a.error.code?(b.debug(a.error.code+" "+a.error.message),alert(a.error.message)):(b.debug(a.error.message),alert(a.error.message))},a.productWarranty={warranty:[{warrantyno:"1",modelno:"1123",serialno:"123123",dateofpurchase:"12 Nov 13",invoiceno:"2"},{warrantyno:"2",modelno:"2343",serialno:"12345345323",dateofpurchase:"11 Nov 13",invoiceno:"4"},{warrantyno:"3",modelno:"654645",serialno:"7676767",dateofpurchase:"12 Oct 13",invoiceno:"5"}]},b.debug("data= "+a.productWarranty.warranty),a.getWarrantyFunction=function(){c.getWarranty({prodle:"xk7i99lj8"},function(c){b.debug(c.success.warranty.warranty_comments),a.warranty=c.success.warranty,a.warrantyComments=c.success.warranty.warranty_comments},function(a){b.debug(a)})},a.getLatestComments=function(){a.getWarrantyFunction();var b=document.getElementById("responseComment");b.style.display="none",b.innerHTML=""},a.warrantyComments={comments:[{commenttext:"good warranty service",status:"active",datecreated:"2013-12-16T07:53:52.725Z",tags:[],user:{userid:"uxkfzVj7or",fullname:"Bhagyashri"}},{commenttext:"hiii",status:"active",datecreated:"2013-12-16T07:50:47.763Z",tags:[],user:{userid:"uxkfzVj7or",fullname:"Bhagyashri"}}]},a.deleteWarranty=function(b){var c=a.productWarranty.warranty.indexOf(b);-1!=c&&a.productWarranty.warranty.splice(c,1)},a.hideIfNotUser=function(b){return b&&b!==a.userFullnameFromSession?{display:"none"}:void 0},a.addWarranty=function(){a.newWarranty={warranty:{warrantyno:"4",modelno:a.warranty.modelno,serialno:a.warranty.serialno,dateofpurchase:a.warranty.dateofpurchase,invoiceno:a.warranty.invoiceno}},a.productWarranty.warranty.push(a.newWarranty.warranty),a.warranty.modelno="",a.warranty.serialno="",a.warranty.dateofpurchase="",a.warranty.invoiceno=""}}]),angular.module("prodo.ProductApp").factory("WarrantyService",["$resource",function(a){return a("/api/warranty/:prodle",{},{getProduct:{method:"GET",params:{prodle:"id"}}})}]).factory("WarrantySaveService",["$resource",function(a){return a("/api/warranty/:orgid",{},{saveProduct:{method:"POST",params:{orgid:"orge1LSosNiS"}}})}]),angular.module("prodo.UploadApp").controller("UploadController",["$scope","$log","$rootScope","fileReader","ENV","growl",function(a,b,c,d,e,f){a.socket=io.connect(e.apiEndpoint+e.port+"/api/prodoupload",{query:"session_id="+c.usersession.currentUser.sessionid}),a.fileLength,a.uploadSrc,a.progressbar=0,a.counter=0,a.getFile=function(e){a.progressbar=0,b.debug("source: "+a.uploadSrc),b.debug("getFile called ... "+e),d.readAsBinaryString(e,a).then(function(d){b.debug("reader called ... "+e);var g;a.imageBfr=d,a.file=e;var h={filetype:a.file.type,filename:a.file.name,filebuffer:a.imageBfr};"image/jpg"==a.file.type||"image/png"==a.file.type||"image/gif"==a.file.type||"image/jpeg"==a.file.type?"user"==a.uploadSrc?a.file.size/1024<500?g={user:{userid:c.usersession.currentUser.userid}}:(f.addErrorMessage("Image size must ne less than 500KB"),$("#bar").hide()):"product"==a.uploadSrc?a.file.size/1024<2048?g={product:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid,prodle:a.product_prodle}}:(f.addErrorMessage("Image size must ne less than 2MB"),$("#bar").hide()):"org"==a.uploadSrc?a.file.size/1024<2048?g={org:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid}}:(f.addErrorMessage("Image size must ne less than 2MB"),$("#bar").hide()):"productlogo"==a.uploadSrc?a.file.size/1024<1024?g={productlogo:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid,prodle:a.product_prodle}}:(f.addErrorMessage("Image size must ne less than 1MB"),$("#bar").hide()):"orglogo"==a.uploadSrc&&(a.file.size/1024<1024?g={orglogo:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid}}:(f.addErrorMessage("Image size must ne less than 1MB"),$("#bar").hide())):"product"==a.uploadSrc?a.file.size/1024<10240?g={product:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid,prodle:a.product_prodle}}:(f.addErrorMessage("Image size must ne less than 10MB"),$("#bar").hide()):"org"==a.uploadSrc?a.file.size/1024<10240?g={org:{userid:c.usersession.currentUser.userid,orgid:c.usersession.currentUser.org.orgid}}:(f.addErrorMessage("Image size must ne less than 10MB"),$("#bar").hide()):(f.addErrorMessage("Please upload file of images type..."),$("#bar").hide()),a.socket.emit("uploadFiles",h,g),b.debug("pic emitted")})},a.socket.removeAllListeners("productUploadResponse"),a.socket.on("productUploadResponse",function(c,d){c?($("#bar").hide(),"AP003"==c.error.code?(b.debug(c.error.code+" "+c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message)):"AV001"==c.error.code?(b.debug(c.error.code+" "+c.error.message),f.addErrorMessage(" Error while uploading "+a.file.name+" "+c.error.message)):(b.debug(c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message))):(a.imageSrc=JSON.stringify(d),b.debug("getting response for product upload  "+a.imageSrc),f.addSuccessMessage("File uploaded"),a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0)}),a.socket.removeAllListeners("productUploadLogoResponse"),a.socket.on("productUploadLogoResponse",function(c,d){c?($("#bar").hide(),"AP003"==c.error.code?(b.debug(c.error.code+" "+c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message)):"AV001"==c.error.code?(b.debug(c.error.code+" "+c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message)):(b.debug(c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message))):(a.imageSrc=JSON.stringify(d),b.debug("getting response for logo upload  "+a.imageSrc),a.imageSrc=d,a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0)}),a.socket.removeAllListeners("orgUploadsResponse"),a.socket.on("orgUploadResponse",function(c,d){c?($("#bar").hide(),"AP003"==c.error.code?(b.debug(c.error.code+" "+c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message)):"AV001"==c.error.code?(b.debug(c.error.code+" "+c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message)):(b.debug(c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message))):(b.debug("getting response for org upload  "+d),a.imageSrc=d,a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0)}),a.socket.removeAllListeners("orgUploadLogoResponse"),a.socket.on("orgUploadLogoResponse",function(c,d){c?($("#bar").hide(),"AP003"==c.error.code?(b.debug(c.error.code+" "+c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message)):"AV001"==c.error.code?(b.debug(c.error.code+" "+c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message)):(b.debug(c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message))):(b.debug("getting response for org upload logo "+d),a.imageSrc=d,a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0)}),a.socket.removeAllListeners("userUploadResponse"),a.socket.on("userUploadResponse",function(c,d){c?($("#bar").hide(),"AP003"==c.error.code?(b.debug(c.error.code+" "+c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message)):"AV001"==c.error.code?(b.debug(c.error.code+" "+c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message)):(b.debug(c.error.message),f.addErrorMessage("Error while uploading "+a.file.name+" "+c.error.message))):(b.debug("getting response for user upload  "+d),a.imageSrc=d,a.counter++,b.debug(a.counter),a.counter<a.fileLength?b.debug("emitting image "+a.counter):a.counter=0)})}]),angular.module("prodo.UploadApp").directive("ngFileSelect",["fileReader",function(){return{link:function(a,b){b.bind("change",function(b){a.file=(b.srcElement||b.target).files,a.fileLength=(b.srcElement||b.target).files,a.file=(b.srcElement||b.target).files,"user"==a.uploadSrc&&a.getFile(a.file[0]);for(var c=function(a){var b=document.createElement("label");b.type="label";var c=document.createTextNode("File "+a.name);b.appendChild(c),b.name="label",b.setAttribute("style","text-align:left");var d=document.getElementById("FileName");d.appendChild(b),d.style.width="400px";var e=document.createElement("div");e.className=" progress progress-info progress-striped active",e.id="a2"+a.name,e.style.textAlign="left",d.appendChild(e);var f=document.createElement("div");f.className="bar",f.id="bar";var g=document.getElementById("a2"+a.name);f.style.width="300px",g.appendChild(f);var h=setInterval(function(){var a=$(".bar");400==a.width()?(clearInterval(h),$(".progress").removeClass("active")):a.width(a.width()+40)},800);b="",c="",d="",e="",f="",h="",g=""},d=0;d<=a.file.length;d++)c(a.file[d]),a.getFile(a.file[d])})}}}]),function(a){var b=function(a){var b=function(a,b,c){return function(){c.$apply(function(){b.resolve(a.result)})}},c=function(a,b,c){return function(){c.$apply(function(){b.reject(a.result)})}},d=function(a,b){return function(a){b.$broadcast("fileProgress",{total:a.total,loaded:a.loaded})}},e=function(a,e){var f=new FileReader;
return f.onload=b(f,a,e),f.onerror=c(f,a,e),f.onprogress=d(f,e),f},f=function(b,c){var d=a.defer(),f=e(d,c);return f.readAsBinaryString(b),d.promise};return{readAsBinaryString:f}};a.factory("fileReader",["$q","$log",b])}(angular.module("prodo.UploadApp")),angular.module("prodo.ProdoCommentApp").directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}),angular.module("prodo.ProdoCommentApp").directive("commentLimit",function(){return{require:"ngModel",link:function(a,b,c,d){function e(a){if(a){if(a.length>f){var b=a.substring(0,f);return d.$setViewValue(b),d.$render(),b}return a}}var f=Number(c.commentLimit);d.$parsers.push(e)}}}),angular.module("prodo.CommonApp").controller("prodoUserProfileDataController",["$scope","$log","$rootScope","UserSessionService",function(a,b,c,d){a.modaluser={products_followed:""},a.ProductsFollowedMessage="",a.ProductsRecommendedMessage="",a.userProfileModal=function(a){d.getUserProfileData(a)};var e=a.$on("getUserDataNotDone",function(){}),f=a.$on("getUserDataDone",function(b,c){a.modaluser=c.success.user,a.ProductsFollowedMessage=0===a.modaluser.products_followed.length?"NO PRODUCTS FOLLOWED":1===a.modaluser.products_followed.length&&"Prodonus Software"===a.modaluser.products_followed[0].name?"NO PRODUCTS FOLLOWED":"PRODUCTS FOLLOWED",a.ProductsRecommendedMessage=0===a.modaluser.products_recommends.length?"":"RECOMMENDED PRODUCTS"});a.emitProductData=function(a,b){c.product_prodle=a,c.orgid=b,$("#profileInfoModal").modal("hide"),$(".modal-backdrop").remove()},a.$on("$destroy",function(){e(),f()})}]),angular.module("prodo.ProdoWallApp").controller("prodoSearchController",["$scope","$log","$rootScope","prodoSearchService","UserSessionService","searchProductService","$http","$resource","trendingProductService",function(a,b,c,d,e,f,g,h,i){a.productNames=[],a.selected=void 0,a.search={},a.result=[],a.productSearch={product:""},a.enhancement={},a.searchCriterion={},a.countForEmptyTextbox=0,a.names=[],a.message="",i.getTrendingProducts(),a.trendingProducts={},a.errors="",a.title="Trending Products",a.limit=5;var j=a.$on("gotTrendingProducts",function(b,c){a.trendingProducts=c.success.ProductTrends}),k=a.$on("notGotTrendingProducts",function(){a.errors="Server Error"});a.searchProductData=function(){if(a.message="",a.result=[],a.countForEmptyTextbox=0,a.search.productsearchdata={},""!==a.product_name){var b=a.product_name.replace(/\s/g,"");a.search.productsearchdata.Product_Name=b,b=""}else a.search.productsearchdata.Product_Name="",a.countForEmptyTextbox++;if(""!==a.model_number){var b=a.model_number.replace(/\s/g,"");a.search.productsearchdata.Model_Number=b,b=""}else a.search.productsearchdata.Model_Number="",a.countForEmptyTextbox++;if(""!==a.category){var b=a.category.replace(/\s/g,"");a.search.productsearchdata.Category=b,b=""}else a.search.productsearchdata.Category="",a.countForEmptyTextbox++;if(""!==a.feature){var b=a.feature.replace(/\s/g,"");a.search.productsearchdata.Feature=b,b=""}else a.search.productsearchdata.Feature="",a.countForEmptyTextbox++;if(""!==a.org){var b=a.org.replace(/\s/g,"");a.search.productsearchdata.Organization_Name=b,b=""}else a.search.productsearchdata.Organization_Name="",a.countForEmptyTextbox++;5==a.countForEmptyTextbox||d.searchProduct(a.search)};var l=a.$on("getSearchProductDone",function(b,c){a.result=c.success.doc,a.message="",a.message=c.success.message}),m=a.$on("getSearchProductNotDone",function(){a.errors="It looks as though we have broken something on our server system. Our support team is notified and will take immediate action to fix it."});a.orgProdleEmitter=function(a,b){c.product_prodle=a,c.orgid=b,$("#advancedSearchModal").modal("hide"),$(".modal-backdrop").remove()},a.modalReset=function(){document.getElementById("textBoxCategoryName").value="",document.getElementById("textBoxModelNumber").value="",document.getElementById("textBoxFeatureName").value="",document.getElementById("textBoxProductName").value="",document.getElementById("textBoxOrgName").value="",a.product_name="",a.model_number="",a.category="",a.feature="",a.search.productsearchdata={},a.result=[],a.org="",a.message=""},a.quickSearchEmit=function(){angular.forEach(a.productNames,function(b){a.productSearch.product===b.name&&(c.product_prodle=b.prodle,c.orgid=b.orgid)}),a.title="Trending Products",a.productSearch.product=""},a.toggleTitleForDiv=function(){a.title="Search",a.errors=""},a.unfollowProduct=function(a){e.unfollowProduct(a.prodle)};var n=a.$on("unfollowProductDone",function(a,b,d,e){c.usersession.productfollowlist.splice(e,1)});a.loadMoreFollowedProduct=function(){100===a.limit?(document.getElementById("tabMore").innerHTML="More",a.limit=5):5===a.limit&&(document.getElementById("tabMore").innerHTML="Less",a.limit=100)},a.$on("$destroy",function(){j(),k(),l(),m(),n()})}]),angular.module("prodo.ProdoWallApp").factory("prodoSearchService",["$rootScope","$resource","$log",function(a,b,c){var d={Product:b("/api/searchproduct",{},{searchProductByKey:{method:"POST"}})},e={};return e.searchProduct=function(b){d.Product.searchProductByKey(b,function(b){c.debug(b),a.$broadcast("getSearchProductDone",b)}),function(b){c.debug(b),a.$broadcast("getSearchProductNotDone",b)}},e}]).factory("searchProductService",["$rootScope","$resource","$log",function(a,b,c){var d={Product:b("/api/allproduct",{},{searchProductByKey:{method:"POST"}})},e={};return e.searchProduct=function(b){d.Product.searchProductByKey(b,function(b){c.debug(b),a.$broadcast("gotAllProducts",b)}),function(b){c.debug(b),a.$broadcast("notGotAllProducts",b)}},e}]).factory("trendingProductService",["$rootScope","$resource","$log",function(a,b,c){var d={Product:b("/api/trendingproducts",{},{searchProductByKey:{method:"GET"}})},e={};return e.getTrendingProducts=function(){d.Product.searchProductByKey(function(b){c.debug(b),a.$broadcast("gotTrendingProducts",b)}),function(b){c.debug(b),a.$broadcast("notGotTrendingProducts",b)}},e}]);